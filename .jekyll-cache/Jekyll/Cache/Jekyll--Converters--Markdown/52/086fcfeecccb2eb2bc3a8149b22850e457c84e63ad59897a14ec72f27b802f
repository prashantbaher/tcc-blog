I"N;<h2 id="objective">OBJECTIVE</h2>

<p>How to Open SOLIDWORKS using <strong>SOLIDWORKS C# API</strong> from <strong>WPF Prism Desktop Application</strong>.</p>

<p>I hope you have installed <em>Visual Studio Community Edition</em> on your machine.</p>

<p>If not then please go to <strong><a href="/solidworks-csharp/Prerequisite">SOLIDWORKS C# API - Prerequisite</a></strong> post and watch the suggested videos before proceeding further.</p>

<hr />

<h2 id="demo-video">DEMO VIDEO</h2>

<p>Please see below video on how to Open SOLIDWORKS using <strong>SOLIDWORKS C# API</strong> from <strong>WPF Prism Desktop Application</strong>.</p>

<iframe src="https://www.youtube.com/embed/fgXLJIa2510" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explanation</strong> in the video.</p>

<p><strong>Explanation</strong> of each step/line and why we write code this way is given in this post.</p>

<hr />

<h2 id="create-a-new-prism-project">CREATE A NEW PRISM PROJECT</h2>

<p>In the below image I have shown you how to create a new Prism Template project.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/create-prism-project.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/create-prism-project.gif" alt="create-prism-project" /></a></p>

<p>For creating a new Prism Project follow these steps:</p>

<ul>
  <li>
    <p><em>Open <strong>Visual Studio 2019 (or 2017)</strong>. This bring us a new window as shown in below image</em>.</p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/1.open-visual-studio-2019.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/1.open-visual-studio-2019.svg" alt="open-visual-studio-2019" /></a></p>
  </li>
  <li>
    <p><em>In this window, we need to select “<strong>Create a new project</strong>” option as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/2.select-create-a-new-project-option.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/2.select-create-a-new-project-option.svg" alt="select-create-a-new-project-option" /></a></p>
  </li>
  <li>
    <p><em>This will open a new window of “Create a new project” as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/3.create-a-new-project-window.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/3.create-a-new-project-window.svg" alt="create-a-new-project-window" /></a></p>
  </li>
  <li>
    <p><em>In this window, we need to apply filter for “<strong>Prism</strong>” project by type “<strong>Prism</strong>” in filter section as shown in below images.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/4.filter-prism-project.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/4.filter-prism-project.svg" alt="filter-prism-project" /></a></p>
  </li>
  <li>
    <p><em>After applying this filter ‘select’ “<strong>Prism Blank App (WPF)</strong>” option from list and press “<strong>Next</strong>” as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/5.select-prism-blank-app-option.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/5.select-prism-blank-app-option.svg" alt="select-prism-blank-app-option" /></a></p>
  </li>
  <li>
    <p><em>This will open a new window of “Configure your new project” as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/6.configure-your-project-window.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/6.configure-your-project-window.svg" alt="configure-your-project-window" /></a></p>
  </li>
  <li>
    <p><em>In this new window, we define “<strong>Project Name</strong>”. For project name we used “OpenSolidworks” value and press “<strong>Create</strong>” as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/7.update-project-name-and-create-project.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/7.update-project-name-and-create-project.svg" alt="update-project-name-and-create-project" /></a></p>
  </li>
  <li>
    <p><em>Pressing “<strong>Create</strong>” button open a new window of “PRISM PROJECT WIZARD”. In this window select “<strong>CREATE PROJECT</strong>” button as shown in below image.</em></p>

    <p><a href="/assets/solidworks-csharp-images/open-solidworks/8.prism-project-wizard.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/8.prism-project-wizard.svg" alt="prism-project-wizard" /></a></p>
  </li>
</ul>

<p>This will open a new window as shown in below image.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/9.openSolidworks-window.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/9.openSolidworks-window.svg" alt="openSolidworks-window" /></a></p>

<h2 id="build-solution">BUILD SOLUTION</h2>

<p>After we create our “OpenSolidworks” project, we need to select “Build Solution” option.</p>

<p>We build our solution because we want to make sure everything is working and there are no broken references.</p>

<p>Please see below image for reference.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/10.build-solution.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/10.build-solution.svg" alt="build-solution" /></a></p>

<p>Below image show <code class="language-plaintext highlighter-rouge">MainWindow.xaml</code> file before <em>building solution</em>.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/11.before-build-solution.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/11.before-build-solution.svg" alt="before-build-solution" /></a></p>

<p>Below image show <code class="language-plaintext highlighter-rouge">MainWindow.xaml</code> file after <em>building solution</em>.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/12.after-build-solution.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/12.after-build-solution.svg" alt="after-build-solution" /></a></p>

<h2 id="add-button-to-window">ADD BUTTON TO WINDOW</h2>

<p>To add button in window, we need to update <code class="language-plaintext highlighter-rouge">MainWindow.xaml</code> file as shown in below image.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/create-button-xaml.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/create-button-xaml.gif" alt="create-button-xaml" /></a></p>

<p>Understand what we have changed.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WindowStartupLocation="CenterScreen"
</code></pre></div></div>

<p>Above code help us show window at center of screen.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Open Solidworks"</span>
        <span class="na">Width=</span><span class="s">"250"</span>
        <span class="na">Height=</span><span class="s">"100"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>Above code add button to our window.</p>

<p>In above code we set 3 properties as follows:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Content="Open Solidworks"</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Width="250"</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Height="100"</code></p>
  </li>
</ol>

<p>Below image shows above parameters.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/13.button-parameters.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/13.button-parameters.svg" alt="button-parameters" /></a></p>

<h2 id="add-command-to-viewmodel">ADD COMMAND TO VIEWMODEL</h2>

<p>Now we need to add <em>Prism Command</em> to our <code class="language-plaintext highlighter-rouge">MainWindowViewModel.cs</code> file as shown in below image.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/create-button-xaml.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/create-button-xaml.gif" alt="create-button-xaml" /></a></p>

<p>In <code class="language-plaintext highlighter-rouge">MainWindowViewModel.cs</code> file, we add <em>Prism Command</em> by <code class="language-plaintext highlighter-rouge">cmd</code> code snippet.</p>

<p>Using this code snippet, we add following code.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="n">DelegateCommand</span> <span class="n">_OpenSolidworksCommand</span><span class="p">;</span>
<span class="k">public</span> <span class="n">DelegateCommand</span> <span class="n">OpenSolidworksCommand</span> <span class="p">=&gt;</span>
    <span class="n">_OpenSolidworksCommand</span> <span class="p">??</span> <span class="p">(</span><span class="n">_OpenSolidworksCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DelegateCommand</span><span class="p">(</span><span class="n">ExecuteOpenSolidworksCommand</span><span class="p">));</span>

<span class="k">void</span> <span class="nf">ExecuteOpenSolidworksCommand</span><span class="p">()</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div></div>

<p>In above code, we use <code class="language-plaintext highlighter-rouge">DelegateCommand</code> <em>Prism Command</em> from <code class="language-plaintext highlighter-rouge">Prism.Command</code> namespace.</p>

<p class="notice--warning">Please forgive me, I am not able to explained <strong>Prism Command</strong> correctly.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="n">DelegateCommand</span> <span class="n">_OpenSolidworksCommand</span><span class="p">;</span>
<span class="k">public</span> <span class="n">DelegateCommand</span> <span class="n">OpenSolidworksCommand</span> <span class="p">=&gt;</span>
    <span class="n">_OpenSolidworksCommand</span> <span class="p">??</span> <span class="p">(</span><span class="n">_OpenSolidworksCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DelegateCommand</span><span class="p">(</span><span class="n">ExecuteOpenSolidworksCommand</span><span class="p">));</span>
</code></pre></div></div>

<p>Above line of code shows <em>Prism Commands</em>.</p>

<p>For more detail about <em>Prism Commands</em> please visit below video.</p>

<iframe src="https://www.youtube.com/embed/tYItSPv58Bo" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">ExecuteOpenSolidworksCommand</span><span class="p">()</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Above code shows function we execute when command is run.</p>

<h2 id="add-solidworks-references">ADD SOLIDWORKS REFERENCES</h2>

<p>For opening <strong>SOLIDWORKS</strong> we need to add some <em>references</em> into our project.</p>

<p>Please see below image for how to add SOLIDWORKS reference.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/add-solidworks-references.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/add-solidworks-references.gif" alt="add-solidworks-references" /></a></p>

<h2 id="open-solidworks">OPEN SOLIDWORKS</h2>

<p>Now for opening SOLIDWORKS we need to add following code as shown in below image.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">ExecuteOpenSolidworksCommand</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Create a new SOLIDWORKS instance</span>
    <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span> <span class="n">swApp</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SldWorks</span><span class="p">.</span><span class="nf">SldWorks</span><span class="p">();</span>

    <span class="c1">// Make solidworks visible</span>
    <span class="n">swApp</span><span class="p">.</span><span class="n">Visible</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/open-solidworks-code.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/open-solidworks-code.gif" alt="open-solidworks-code" /></a></p>

<h2 id="add-command-to-button">ADD COMMAND TO BUTTON</h2>

<p>Now we need to <strong>Bind</strong> our <code class="language-plaintext highlighter-rouge">OpenSolidworksCommand</code> command to button as shown in below image.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/add-command-to-button.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/add-command-to-button.gif" alt="add-command-to-button" /></a></p>

<h2 id="final-result">FINAL RESULT</h2>

<p>Now, we have done everything needed to Open SOLIDWORKS through our application.</p>

<p>Please see below image for final result of our work.</p>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/final-result.gif"><img src="/assets/solidworks-csharp-images/open-solidworks/final-result.gif" alt="final-result" /></a></p>

<p>As you can see from above image, we have done followings:</p>

<ul>
  <li>Build Solution as shown in below image.</li>
</ul>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/10.build-solution.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/10.build-solution.svg" alt="build-solution" /></a></p>

<ul>
  <li>Start app as shown in below image.</li>
</ul>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/14.run-application-by-start-button.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/14.run-application-by-start-button.svg" alt="run-application-by-start-button" /></a></p>

<ul>
  <li>By Start app we have a window, in this window we need to press “Open Solidworks” button as shown in below image.</li>
</ul>

<p><a href="/assets/solidworks-csharp-images/open-solidworks/15.Open-Solidworks.svg"><img src="/assets/solidworks-csharp-images/open-solidworks/15.Open-Solidworks.svg" alt="Open-Solidworks" /></a></p>

<hr />

<p><strong>This is it !!!</strong></p>

<p><em>I hope my efforts will helpful to someone!</em></p>

<p>If you found anything to <strong>add or update</strong>, please let me know on my <em>e-mail</em>.</p>

<p>Hope this post helps you to <strong>Open SOLIDWORKS</strong> from WPF PRISM Application.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not!</em></p>

<p><em>Till then, Happy learning!!!</em></p>
:ET
I"5*<p>In this post, I tell you about <strong>how to Open Solidworks using Solidworks C++ API</strong> from Visual Studio.</p>

<p>I hope you have setup Visual Studio community version.</p>

<p>If not then please go to <strong><a href="/solidworks-cpp/Prerequisite">Solidworks C++ API - Prerequisite</a></strong> post and watch the suggested videos before proceeding further.</p>

<hr />

<h2 id="video-of-code-on-youtube">Video of Code on YouTube</h2>

<p>Please see below video on <strong>how to Open Solidworks using Solidworks C++ API</strong> from Visual Studio.</p>

<iframe src="https://www.youtube.com/embed/oL9kJoRoYcQ" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explaination</strong> in the video.</p>

<p><strong>Explaination</strong> of each line and why we write code this way is given in this post.</p>

<hr />

<h2 id="create-a-new-project">Create a New project</h2>

<p>Fist, we will create a new project in Visual Studio.</p>

<p>There are 3 different ways for creating a new project.</p>

<ol>
  <li>
    <p>From <strong>File</strong> -&gt; <strong>New</strong> -&gt; <strong>Project</strong></p>
  </li>
  <li>
    <p>From <strong>New Prject</strong> icon.</p>
  </li>
  <li>
    <p>Keyboard Short-cut i.e. <code class="language-plaintext highlighter-rouge">Ctrl+Shift+N</code>.</p>
  </li>
</ol>

<p>Below image show how to create a <em>New Project</em> from <strong>File</strong> option:</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/new-project-1.png" alt="new-project-file-option" /></p>

<p>In above image, see Red color box.</p>

<p>Below image show how to create a <em>New Project</em> from <strong>New Project Icon</strong> option:</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/new-project-2.png" alt="new-project-from-icon" /></p>

<p>In above image, see Red color box.</p>

<p>When we select one of the above option we get a new window which is shown in below.</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/create-project.png" alt="create-project" /></p>

<p>In above image I have numbered the Red colored box.</p>

<p>These numbers are explained below:</p>

<ol>
  <li>
    <p><em>The programming language</em> you want to use for <strong>New Project</strong>. For our purpose, we use “<em>Visual C++</em>”.</p>
  </li>
  <li>
    <p>It is, <strong>which type</strong> of project you want to create. There are <em>3 different type</em> of projects we can create. In above image, we will create <em>an empty project</em>.</p>
  </li>
  <li>
    <p>It is <em>the name of project</em> we want to create. We named our project as <strong>OpenSolidworkTest</strong>.</p>
  </li>
  <li>
    <p>The location of project we want. We use default location provided in above image.</p>
  </li>
  <li>
    <p>It is option <em>if we want to create a Solution file for this project or not</em>. In our case, we want to create a <em>Solution file</em>.</p>
  </li>
  <li>
    <p>Hit <strong>Ok</strong> button after completing all fields.</p>
  </li>
</ol>

<hr />

<h2 id="add-source-file">Add Source file</h2>

<p>After creating a new project, we get a screen as shown in below image.</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/after-new-project.png" alt="after-new-project" /></p>

<p>This project has no file to write.</p>

<p>Now we add a cpp file into <em>Source Files filter folder</em>.</p>

<p>For this please follow given steps:</p>

<ol>
  <li>
    <p>For this select <em>Source Files filter folder</em> and <em>Click Right Mouse Button (RMB)</em>.</p>
  </li>
  <li>
    <p>By doing this <em>a context menu</em> is appear as shown in below image.</p>
  </li>
  <li>
    <p>From this <em>context menu</em>, select <strong>“Add”</strong> –&gt; <strong>“New Item”</strong>, as shown in below image.</p>
  </li>
</ol>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/add-new-cpp-file.png" alt="add-new-cpp-file" /></p>

<p>This will open a new window as shown in below image.</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/add-new-cpp-file-window.png" alt="add-new-cpp-file-window" /></p>

<p>Just select “<strong>Add</strong>” option as shown in above image.</p>

<p>This will add “<strong>Source.cpp</strong>” file into our project.</p>

<hr />

<h2 id="add-references-to-solidworks-type-library-files">Add References to Solidworks Type Library files</h2>

<p>Now we need to <em>add References to Solidworks Type Library files.</em></p>

<p>For this please follow below steps.</p>

<ol>
  <li>
    <p>Select the <strong>OpenSolidworkTest</strong> project and and <em>Click Right Mouse Button (RMB)</em>.</p>
  </li>
  <li>
    <p>By doing this <em>a context menu</em> is appear as shown in below image.</p>
  </li>
  <li>
    <p>From this <em>context menu</em>, select <strong>“Properties”</strong> option, which is the last one, as shown in below image.</p>
  </li>
</ol>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/open-property-window.png" alt="open-property-window" /></p>

<p>This will open a new window as shown in below image.</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/project-property-window.png" alt="project-property-window" /></p>

<p>Now following below steps:</p>

<ol>
  <li>
    <p>Select C/C++ option</p>
  </li>
  <li>
    <p>Add SOLIDWORKS folders path to 2nd Red colored box as shown in below image. Usually this path is “<code class="language-plaintext highlighter-rouge">C:\Program Files\ Solidworks Corp\SOLIDWORKS</code>” if installed in default location.</p>
  </li>
</ol>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/add-solidowrks-reference.png" alt="add-solidowrks-reference" /></p>

<p>After adding the folder path, select “<strong>Apply</strong>” button.</p>

<p>This complete the process of <em>adding References to Solidworks Type Library files.</em></p>

<hr />

<h2 id="add-code-to-sourcecpp-file">Add Code to Source.cpp file</h2>

<p>Now we need to add to <em>Source.cpp</em> file.</p>

<p>Please copy the below code sample to your <em>Source.cpp</em> file.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;atlbase.h&gt;</span><span class="cp">
</span>
<span class="cp">#import "sldworks.tlb" raw_interfaces_only, raw_native_types, no_namespace, named_guids  // SOLIDWORKS type library
</span>
<span class="cp">#import "swconst.tlb" raw_interfaces_only, raw_native_types, no_namespace, named_guids   // SOLIDWORKS constants type library
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// Initialize COM</span>
	<span class="c1">// Do this before using ATL smart pointers so COM is available.</span>
	<span class="n">CoInitialize</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>

	<span class="c1">// Use a block, so the smart pointers are destructed when the scope of this block is left</span>
	<span class="p">{</span>
		<span class="c1">// COM Pointer of Soldiworks object</span>
		<span class="n">CComPtr</span><span class="o">&lt;</span><span class="n">ISldWorks</span><span class="o">&gt;</span> <span class="n">swApp</span><span class="p">;</span>

		<span class="c1">// Create an instance of Solidworks application</span>
		<span class="c1">// If it fails then return 0 and close program</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">swApp</span><span class="p">.</span><span class="n">CoCreateInstance</span><span class="p">(</span><span class="kr">__uuidof</span><span class="p">(</span><span class="n">SldWorks</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">CLSCTX_LOCAL_SERVER</span><span class="p">)</span> <span class="o">!=</span> <span class="n">S_OK</span><span class="p">)</span> 
		<span class="p">{</span>
			<span class="c1">// Stop COM </span>
			<span class="n">CoUninitialize</span><span class="p">();</span>
			<span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="c1">// If created successfully, then visible the Solidworks</span>
		<span class="n">swApp</span><span class="o">-&gt;</span><span class="n">put_Visible</span><span class="p">(</span><span class="n">VARIANT_TRUE</span><span class="p">);</span>

		<span class="c1">// COM Style String for message to user</span>
		<span class="n">CComBSTR</span> <span class="n">_messageToUser</span><span class="p">(</span><span class="s">L"Hello World!!! I am from Solidworks C++ API."</span><span class="p">);</span>

		<span class="c1">// long type variable to store the result value by user</span>
		<span class="kt">long</span> <span class="n">_lMessageResult</span><span class="p">;</span>

		<span class="c1">// Send a message to user and store the return value in _lMessageResult by referencing it</span>
		<span class="n">swApp</span><span class="o">-&gt;</span><span class="n">SendMsgToUser2</span><span class="p">(</span><span class="n">_messageToUser</span><span class="p">,</span> <span class="n">swMessageBoxIcon_e</span><span class="o">::</span><span class="n">swMbInformation</span><span class="p">,</span> <span class="n">swMessageBoxBtn_e</span><span class="o">::</span><span class="n">swMbOk</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">_lMessageResult</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// Stop COM </span>
	<span class="n">CoUninitialize</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now Build the Solution as shown in below image.</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/build-solution.png" alt="build-solution" /></p>

<p>After Building Solution run the program by pressing <strong>F5</strong>.</p>

<hr />

<h2 id="final-result">Final Result</h2>

<p>After running the program wait for few minute.</p>

<p>You will get result as shown in below image!!!</p>

<p><img src="/assets/solidworks-cpp-images/open-solidworks/hello-world-message.png" alt="hello-world-message.png" /></p>

<hr />

<p><strong>This is it !!!</strong></p>

<p>We have completed our <em>Hello World</em> program in <em>Solidworks</em> using <strong>Solidworks C++ APIs</strong>.</p>

<p>Hope this post helps you to start with <em>Solidworks C++ API</em>.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not! I will continue creating Solidworks C++ posts.</em></p>

<p><em>Till then, Happy learning!!!</em></p>
:ET
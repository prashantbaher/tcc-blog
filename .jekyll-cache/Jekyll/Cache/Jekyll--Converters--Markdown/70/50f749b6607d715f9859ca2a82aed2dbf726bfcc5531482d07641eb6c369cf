I"iô<p class="notice--warning">This post is an intermediate post and required you to have some knowledge of <strong>VBA</strong>.<br />
If you are following my articles you will notice that till now we were <strong>hardcoding</strong> the selections for input parameters.<br />
But from this post onward we will take user-inputs.<br />
Please note that we will not use ðŸ‘‰ <strong><a href="/vba/userform/">UserForm</a></strong> for taking inputs, but use ðŸ‘‰ <strong><a href="/vba/inputbox-function/">Input Box</a></strong>  and ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Box</a></strong> for <em>value input</em> and will ask user to <strong>select SOLIDWORKS Entities</strong> from SOLIDWORKS.<br />
I hope you will also like this type of tutorials.<br />Thank you for reading till now.</p>

<h2 id="objective">Objective</h2>

<p>Objective of this article is to learn <em>how to create <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> through SOLIDWORKS VBA Macros</em> in SOLIDWORKS.</p>

<p>We create <strong>Thread Feature</strong> in 3 steps in general.</p>

<ol>
  <li><em>Traversing</em> through <strong>Feature Tree</strong>.</li>
  <li>Programmatically select <strong>a ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> from <strong>Feature Tree</strong> named <strong>Cylinder</strong>.</li>
  <li>Get Cylinder surface of  <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</li>
  <li>Create ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a>.</li>
  <li>Create ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> using ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a> from method <code class="language-plaintext highlighter-rouge">CreateFeature</code>.</li>
</ol>

<p>This method is <strong><em>most updated</em></strong> method, so <strong><em>use this method</em></strong> if you want to create a new <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>.</p>

<h2 id="steps-to-create-thread">Steps To Create Thread</h2>

<p>We use following steps to create ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> while writing macro</p>

<ol>
  <li><em>Traversing</em> through <strong>Feature Tree</strong>.</li>
  <li>Programmatically select <strong>a ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> from <strong>Feature Tree</strong> named <strong>Cylinder</strong>.</li>
  <li>Get all Faces of <strong>Cylinder</strong>.</li>
  <li>Get Cylinder ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html">Surface</a></strong> of selected <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</li>
  <li>Select the top ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">Edge</a></strong> of Cylinder ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html">Surface</a></strong>.</li>
  <li>Create ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a>.</li>
  <li>Create ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> using ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a> from method <code class="language-plaintext highlighter-rouge">CreateFeature</code>.</li>
</ol>

<h2 id="results-we-can-get">Results We Can Get</h2>

<p>After running our we successfully create <strong>Hole feature</strong> as a result.</p>

<p>Below image shows the result we get.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/threads-final-result.png"><img src="/assets/Solidworks_Images/feature-threads/threads-final-result.png" alt="threads-final-result" /></a></p>

<blockquote>
  <p>To get the correct result please follow the steps correctly.</p>
</blockquote>

<h2 id="video-of-code-on-youtube">Video of Code on YouTube</h2>

<p>Please see below ðŸŽ¬ video on <strong>how to create Thread feature</strong> from SOLIDWORKS VBA Macros.</p>

<iframe src="https://www.youtube.com/embed/T5OgoBBULDU" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explanation</strong> in the video.</p>

<p><strong>Explanation</strong> of each line and why we write code this way is given in this post.</p>

<p class="notice--warning">It is advisable to watch video, since it help you to better understand the process.</p>

<h2 id="code-sample">Code Sample</h2>

<p>Below is the <code class="language-plaintext highlighter-rouge">code</code> for creating <em>Thread Feature</em> feature in <strong>VBA</strong> is given.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>

<span class="c1">' Solidworks application variable</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>

<span class="c1">' Solidworks document variable</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>

<span class="c1">' Solidworks Thread feature data variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeatData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ThreadFeatureData</span>

<span class="c1">' Solidworks Thread Feature variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Solidworks Feature variable</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Solidworks Face variable</span>
<span class="k">Dim</span> <span class="nv">swFace</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Face2</span>

<span class="c1">' Solidworks Surface variable</span>
<span class="k">Dim</span> <span class="nv">swSurface</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Surface</span>

<span class="c1">' Solidworks Entity variable</span>
<span class="k">Dim</span> <span class="nv">swEnt</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>

<span class="c1">' Variable for Solidworks Edges</span>
<span class="k">Dim</span> <span class="nv">swEdges</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Solidworks Edge variable</span>
<span class="k">Dim</span> <span class="nv">swEdge</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Edge</span>

<span class="c1">' Array for Solidworks Faces</span>
<span class="k">Dim</span> <span class="nv">faceArray</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Variable for Solidworks Face</span>
<span class="k">Dim</span> <span class="nv">eachFace</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Boolean variable</span>
<span class="k">Dim</span> <span class="nv">boolStatus</span> <span class="ow">As</span> <span class="kt">Boolean</span>

<span class="c1">' Main program for Thread</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

  <span class="c1">' Set Solidworks application variable to current application</span>
  <span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
  
  <span class="c1">' Check if Solidworks is opened or not</span>
  <span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks is not opened"</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Set Solidworks document variable to open document</span>
  <span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
  
  <span class="c1">' Check if Solidworks document is opened or not</span>
  <span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks document is not opened. Please open a document."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Get First feature in Feature tree</span>
  <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FirstFeature</span>
  
  <span class="c1">' Check if Solidworks document is selected or not</span>
  <span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to selected First feature in Feature Tree."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Traversing through the Feature Tree,</span>
  <span class="c1">' until Feature name is "Cylinder"</span>
  <span class="k">While</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span> <span class="o">&lt;&gt;</span> <span class="s">"Cylinder"</span>
    
    <span class="c1">' Print current Feature name is Immediate window</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
    
    <span class="c1">' Get the next feature</span>
    <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetNextFeature</span>
  <span class="k">Wend</span>
  
  <span class="c1">' Print current Feature name is Immediate window</span>
  <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
  
  <span class="c1">' Get the faces of selected feature</span>
  <span class="n">faceArray</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetFaces</span>

  <span class="c1">' Loop through all Face array</span>
  <span class="k">For</span> <span class="k">Each</span> <span class="n">eachFace</span> <span class="ow">In</span> <span class="n">faceArray</span>
  
    <span class="c1">' Set Solidworks Face variable to current current</span>
    <span class="k">Set</span> <span class="n">swFace</span> <span class="o">=</span> <span class="n">eachFace</span>
    
    <span class="c1">' Get the Surface of from the Solidworks Face variable</span>
    <span class="k">Set</span> <span class="n">swSurface</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetSurface</span>
    
    <span class="c1">' If we have cylinder surface</span>
    <span class="k">If</span> <span class="n">swSurface</span><span class="p">.</span><span class="n">IsCylinder</span><span class="p">()</span> <span class="k">Then</span>
    
      <span class="c1">' Get all edges of this face</span>
      <span class="n">swEdges</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetEdges</span>
      
      <span class="c1">' Set Solidworks edge variable to 1st edge</span>
      <span class="k">Set</span> <span class="n">swEdge</span> <span class="o">=</span> <span class="n">swEdges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      
      <span class="c1">' Set Solidworks Entity variable to Solidworks Edge variable</span>
      <span class="k">Set</span> <span class="n">swEnt</span> <span class="o">=</span> <span class="n">swEdge</span>
      
      <span class="c1">' Select the current entity</span>
      <span class="n">boolStatus</span> <span class="o">=</span> <span class="n">swEnt</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="k">True</span><span class="p">)</span>
      
      <span class="c1">' If fail to select the edge then inform user</span>
      <span class="k">If</span> <span class="n">boolStatus</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Failed to select Edge of Cylinder."</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
      <span class="nf">End</span> <span class="k">If</span>
      
    <span class="k">End</span> <span class="k">If</span>
  <span class="k">Next</span>
  
  <span class="c1">' Create Thread feature data</span>
  <span class="k">Set</span> <span class="n">swThreadFeatData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFeatureNameID_e</span><span class="p">.</span><span class="n">swFmSweepThread</span><span class="p">)</span>
  
  <span class="c1">' Create Thread Feature</span>
  <span class="k">Set</span> <span class="n">swThreadFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swThreadFeatData</span><span class="p">)</span>
  
  <span class="c1">' Check if Thread Feature created or not</span>
  <span class="k">If</span> <span class="n">swThreadFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Thread Feature."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' View zoom to fit</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
  
  <span class="c1">' Clear all selection</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
    
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h2 id="prerequisite">Prerequisite</h2>

<p>There are some <em>prerequisite</em> for this article.</p>

<p>We are <strong>not</strong> creating feature from code but we use <strong>existing feature</strong> to create <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> as shown in below picture.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/prerequisite.png"><img src="/assets/Solidworks_Images/feature-threads/prerequisite.png" alt="prerequisite" /></a></p>

<p>As shown in above image, there only <em>1 Extrude feature</em> in our part.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Extrude Feature</code> : This is our <strong>Extrude part</strong> for <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>.</li>
</ul>

<p>If you want to create <strong>Extrude</strong> feature programmatically then please refer to below article.</p>

<ul>
  <li>ðŸ‘‰ <strong><a href="/solidworks-macros/create-extrude-feature">SOLIDWORKS Macros - Create Extrude/Boss</a></strong></li>
</ul>

<p>Also, we will apply checks in this article, so the code we write should be error free most of the time.</p>

<h2 id="steps-to-follow">Steps To Follow</h2>

<p>To create <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>, there are following steps:</p>

<ol>
  <li><em>Creating Global Variables</em></li>
  <li><em>Initializing required variables</em></li>
  <li><em>Get Cylinder Feature by Traversing Feature Tree</em></li>
  <li><em>Select top edge of Cylinder Feature</em></li>
  <li><em>Create Thread feature using Thread Feature Data</em></li>
  <li><em>Final work</em></li>
</ol>

<p>Now let us walk through <strong>each step</strong> as given above, and <strong>understand</strong> every line.</p>

<p>I also give some <strong><em>links</em></strong> (see icon ðŸ‘‰ ) so that you can go through them if there are anything I explained in previous articles.</p>

<h3 id="creating-global-variables">Creating Global Variables</h3>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>
</code></pre></div></div>

<p>This line forces us to define every variable we are going to use.</p>

<p>For more information please visit ðŸ‘‰ <strong><a href="/solidworks-macros/open-new-document">SOLIDWORKS Macros - Open new Part document</a></strong> post.</p>

<p>We create following variables.</p>

<ul>
  <li><strong>Variable for Solidworks application</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swApp</code> and the type of this <code class="language-plaintext highlighter-rouge">swApp</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks document</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swDoc</code> and the type of this <code class="language-plaintext highlighter-rouge">swDoc</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Thread feature data</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Thread feature data variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeatData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ThreadFeatureData</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> and the type of this <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks feature</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Thread Feature variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swThreadFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swThreadFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swThreadFeature</code> for <strong>SOLIDWORKS Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Feature variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Feature variable</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFeature</code> for <strong>SOLIDWORKS Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Face variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Face variable</span>
<span class="k">Dim</span> <span class="nv">swFace</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Face2</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swFace</code> and the type of this <code class="language-plaintext highlighter-rouge">swFace</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Face2</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFace</code> for <strong>SOLIDWORKS Face</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Face2</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Surface</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Surface variable</span>
<span class="k">Dim</span> <span class="nv">swSurface</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Surface</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swSurface</code> and the type of this <code class="language-plaintext highlighter-rouge">swSurface</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Surface</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swSurface</code> for <strong>SOLIDWORKS Surface</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Surface</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Entity</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Entity variable</span>
<span class="k">Dim</span> <span class="nv">swEnt</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swEnt</code> and the type of this <code class="language-plaintext highlighter-rouge">swEnt</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEnt</code> for <strong>SOLIDWORKS Entity</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Entity</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Edges</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Edges</span>
<span class="k">Dim</span> <span class="nv">swEdges</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">swEdges</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEdges</code> for to get all edges of a surface.</p>

<ul>
  <li><strong>Variable for Solidworks Edge</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Edge variable</span>
<span class="k">Dim</span> <span class="nv">swEdge</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Edge</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swEdge</code> and the type of this <code class="language-plaintext highlighter-rouge">swEdge</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Edge</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEnt</code> for <strong>SOLIDWORKS Edge</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Edge</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEdge_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Array for Solidworks Faces</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Array for Solidworks Faces</span>
<span class="k">Dim</span> <span class="nv">faceArray</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">faceArray</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">faceArray</code> for to get all face of Cylinder feature.</p>

<ul>
  <li><strong>Variable for Solidworks Face</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Face</span>
<span class="k">Dim</span> <span class="nv">eachFace</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">eachFace</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">eachFace</code> for to get each face inside <code class="language-plaintext highlighter-rouge">faceArray</code> array.</p>

<ul>
  <li><strong>Boolean variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Boolean variable</span>
<span class="k">Dim</span> <span class="nv">boolStatus</span> <span class="ow">As</span> <span class="kt">Boolean</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">boolStatus</code> as <code class="language-plaintext highlighter-rouge">Boolean</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">boolStatus</code> to confirm method result.</p>

<p><strong><em>These all are our global variables.</em></strong></p>

<p>They are <strong>SOLIDWORKS API Objects</strong>.</p>

<p>So basically I group all the <strong>SOLIDWORKS API Objects</strong> in one place.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Main program for Thread</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<p>Next is our <code class="language-plaintext highlighter-rouge">Sub</code> procedure which has name of <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p>This procedure hold all the <em>statements (instructions)</em> we give to computer.</p>

<p>To know more about <strong>Sub Procedure</strong> you can check ðŸ‘‰ <strong><a href="/vba/sub-and-function-procedure/">VBA Sub and Function Procedures</a></strong> article of this website.</p>

<h3 id="initializing-required-variables">Initializing Required Variables</h3>

<p>Inside this procedure we first initialize required variables as given below.</p>

<ul>
  <li><em>Set SOLIDWORKS variable to SOLIDWORKS application</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS variable to SOLIDWORKS application</span>
<span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we set the value of our SOLIDWORKS variable <code class="language-plaintext highlighter-rouge">swApp</code>; which we define earlier; to SOLIDWORKS application.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS is opened or not</span>
<span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS is not opened"</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS application variable is <em>successfully assigned</em> to current SOLIDWORKS application.</p>

<ul>
  <li><em>Set SOLIDWORKS document variable to opened part document</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS document variable to opened part document</span>
<span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> variable to currently open part document.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS document is opened or not</span>
<span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS document is not opened. Please open a document."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> is opened.</p>

<p>If SOLIDWORKS document is not opened then code execute inside the code and inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<h3 id="get-cylinder-feature-by-traversing-feature-tree">Get Cylinder Feature by Traversing Feature Tree</h3>

<p>Now we will get <strong>Cylinder</strong> feature by <em>Traversing Feature Tree</em>.</p>

<p>Please follow steps given below.</p>

<ul>
  <li><em>Get First feature in Feature tree</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get First feature in Feature tree</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FirstFeature</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS Feature <code class="language-plaintext highlighter-rouge">swFeature</code> variable to <strong>first</strong> feature in <em>Feature Tree</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Solidworks document is selected or not</span>
<span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to selected First feature in Feature Tree."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we get SOLIDWORKS Feature <code class="language-plaintext highlighter-rouge">swFeature</code>.</p>

<p>If we failed to get SOLIDWORKS Feature then code execute inside the code and inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Traversing through the Feature Tree,</span>
<span class="c1">' until Feature name is "Cylinder"</span>
<span class="k">While</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span> <span class="o">&lt;&gt;</span> <span class="s">"Cylinder"</span>

<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code, we create another <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>This loop will continue until we select the our <strong>Cylinder</strong> <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<p>For more details about <code class="language-plaintext highlighter-rouge">While</code> loop, please see ðŸ‘‰ <strong><a href="/vba/looping/">VBA Looping</a></strong> article from this website.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Print current Feature name is Immediate window</span>
<span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div></div>

<p>In above line of code, we print <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> name into <em>Immediate window</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the next feature</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetNextFeature</span>
</code></pre></div></div>

<p>In above line of code, we set <code class="language-plaintext highlighter-rouge">swFeature</code> variable to next <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Print current Feature name is Immediate window</span>
<span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div></div>

<p>In above line of code, we print <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> name into <em>Immediate window</em>.</p>

<p>Since this line is outside of <code class="language-plaintext highlighter-rouge">While</code> loop, it means selected feature is <strong>Cylinder</strong> <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<h3 id="select-top-edge-of-cylinder-feature">Select top edge of Cylinder Feature</h3>

<p>Now we need to select top edge of previously selected <strong>Cylinder</strong> <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<p>Please follow steps given below.</p>

<ul>
  <li><em>Get the faces of selected feature</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the faces of selected feature</span>
<span class="n">faceArray</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetFaces</span>
</code></pre></div></div>

<p>In above line of code we get all faces of selected <strong>Cylinder</strong> <strong>ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<ul>
  <li><em>Loop through all face array</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop through all Face array</span>
<span class="k">For</span> <span class="k">Each</span> <span class="n">eachFace</span> <span class="ow">In</span> <span class="n">faceArray</span>

<span class="k">Next</span>
</code></pre></div></div>

<p>In above line of code we create a ðŸ‘‰ <strong><a href="/vba/looping/">For Each</a></strong> loop.</p>

<ul>
  <li><em>Get surface of current Face</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks Face variable to current face</span>
<span class="k">Set</span> <span class="n">swFace</span> <span class="o">=</span> <span class="n">eachFace</span>
</code></pre></div></div>

<p>In above line of code, we Set ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">SOLIDWORKS Face</a></strong> variable <code class="language-plaintext highlighter-rouge">swFace</code> to current face.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the Surface of from the Solidworks Face variable</span>
<span class="k">Set</span> <span class="n">swSurface</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetSurface</span>
</code></pre></div></div>

<p>In above line of code we get the ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">Surface</a></strong> of from the ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">SOLIDWORKS Face</a></strong> variable using <code class="language-plaintext highlighter-rouge">GetSurface</code> ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2~GetSurface.html">method</a></strong>.</p>

<ul>
  <li><em>If Statement for Cylindrical Surface</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' If we have cylinder surface</span>
<span class="k">If</span> <span class="n">swSurface</span><span class="p">.</span><span class="n">IsCylinder</span><span class="p">()</span> <span class="k">Then</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">SOLIDWORKS Surface</a></strong> <code class="language-plaintext highlighter-rouge">swSurface</code> is Cylindrical Surface or not.</p>

<ul>
  <li><em>Select first edge of Cylindrical Surface</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get all edges of this face</span>
<span class="n">swEdges</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetEdges</span>
</code></pre></div></div>

<p>In above line of code we get all edges of current face.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks edge variable to 1st edge</span>
<span class="k">Set</span> <span class="n">swEdge</span> <span class="o">=</span> <span class="n">swEdges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">SOLIDWORKS edge</a></strong> variable <code class="language-plaintext highlighter-rouge">swEdge</code> to 1st edge.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks Entity variable to Solidworks Edge variable</span>
<span class="k">Set</span> <span class="n">swEnt</span> <span class="o">=</span> <span class="n">swEdge</span>
</code></pre></div></div>

<p>In above line of code we set ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">SOLIDWORKS Entity</a></strong> variable to ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">SOLIDWORKS edge</a></strong> variable.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Select the current entity</span>
<span class="n">boolStatus</span> <span class="o">=</span> <span class="n">swEnt</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="k">True</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we select the current entity.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' If fail to select the edge then inform user</span>
<span class="k">If</span> <span class="n">boolStatus</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="s">"Failed to select Edge of Cylinder."</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if <strong><code class="language-plaintext highlighter-rouge">Boolean</code></strong> variable <code class="language-plaintext highlighter-rouge">boolStatus</code> is <code class="language-plaintext highlighter-rouge">False</code>.</p>

<p>If <strong><code class="language-plaintext highlighter-rouge">Boolean</code></strong> variable <code class="language-plaintext highlighter-rouge">boolStatus</code> is <code class="language-plaintext highlighter-rouge">False</code>. then code execute inside the code and inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<h3 id="create-thread-feature-using-thread-feature-data">Create Thread feature using Thread Feature Data</h3>

<p>We have completed our <em>selection</em> of ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">SOLIDWORKS Entity</a></strong>.</p>

<p>Now we create Thread Feature.</p>

<p>For this we use 2 steps as follows:</p>

<ol>
  <li><em>Create Thread Feature definition</em></li>
  <li><em>Create Thread Feature using the definition</em></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Thread feature data</span>
<span class="k">Set</span> <span class="n">swThreadFeatData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFeatureNameID_e</span><span class="p">.</span><span class="n">swFmSweepThread</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> by <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method.</p>

<p><code class="language-plaintext highlighter-rouge">CreateDefinition</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method takes following parameters as explained:</p>

<ul>
  <li>
    <p><strong>Type</strong> - <em><code class="language-plaintext highlighter-rouge">Feature name ID</code> as defined in <code class="language-plaintext highlighter-rouge">swFeatureNameID_e</code></em>.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">swFmBoundingBox</code> <em>(bounding box)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCirPattern</code> <em>(circular pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCurvePattern</code> <em>(curve-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDerivedLPattern</code> <em>(derived-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDimPattern</code> <em>(variable/dimension pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmFillPattern</code> <em>(fill pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmGroundPlane</code> <em>(ground plane)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLibraryFeature</code> <em>(library)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalChainPattern</code> <em>(chain component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCirPattern</code> <em>(circular component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCurvePattern</code> <em>(curve-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalLPattern</code> <em>(linear component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalSketchPattern</code> <em>(sketch-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLPattern</code> <em>(linear pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmNormalCut</code> <em>(sheet metal normal cut)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefCurve</code> <em>(projection curve)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefSurface</code> <em>(surface sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSketchPattern</code> <em>(sketch-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweep</code> <em>(boss sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepCut</code> <em>(cut sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepThread</code> <em>(Thread)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTabAndSlot</code> <em>(tab and slot)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTablePattern</code> <em>(table pattern)</em></li>
    </ul>
  </li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method retun <strong>feature or pattern-specific</strong> feature data object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>Type</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swFmSweepThread</code> as <code class="language-plaintext highlighter-rouge">Feature name ID</code></em>.</li>
</ul>

<p>If you want to know more information about Sweep Feature data then please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>This page will give you information about various properties and methods of <code class="language-plaintext highlighter-rouge">IThreadFeatureData</code> Interface.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Thread Feature</span>
<span class="k">Set</span> <span class="n">swThreadFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swThreadFeatData</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swThreadFeature</code> by <code class="language-plaintext highlighter-rouge">CreateFeature</code> method.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method takes following parameters as explained:</p>

<ul>
  <li><strong>FeatureData</strong> - <em><code class="language-plaintext highlighter-rouge">Feature or pattern-specific</code> feature data object</em>.</li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method return <strong>feature</strong> data object.</p>

<p><code class="language-plaintext highlighter-rouge">CreateFeature</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>FeatureData</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> as feature data object which we defined previously</em>.</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Thread Feature created or not</span>
<span class="k">If</span> <span class="n">swThreadFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Thread Feature."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we able to create ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> or not.</p>

<p>If we failed to select then inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<p>After showing error message our program <strong>exit</strong> from here itself.</p>

<p>Now we run the macro and after running macro we get Revolve as shown in below image.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/threads-final-result.png"><img src="/assets/Solidworks_Images/feature-threads/threads-final-result.png" alt="threads-final-result" /></a></p>

<h3 id="final-work">Final work</h3>

<p>After creating ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> , we have to do some cleaning work so that we can use this macro frequently.</p>

<ul>
  <li>Make part Zoom to fit</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' View zoom to fit</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
</code></pre></div></div>

<p>In above line, we make our view zoom to fit the model.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ViewZoomtofit2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<ul>
  <li>Clear selection</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Clear all selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<p>In above line, we clear all previous selection.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ClearSelection2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<p><strong>This is it !!!</strong></p>

<p><em>I hope my efforts will helpful to someone!</em></p>

<p>If you found anything to <strong>add or update</strong>, please let me know on my <em>e-mail</em>.</p>

<p>Hope this post helps you to <strong>create Threads</strong> with SOLIDWORKS VBA Macros.</p>

<p>For more such tutorials on <strong>SOLIDWORKS VBA Macro</strong>, do come to this blog after sometime.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not!</em></p>

<p><em>Till then, Happy learning!!!</em></p>
:ET
I"÷<p class="notice--warning">This post is an intermediate post and required you to have some knowledge of <strong>VBA</strong>.<br />
If you are following my articles you will notice that till now we were <strong>hardcoding</strong> the selections for input parameters.<br />
But from this post onward we will take user-inputs.<br />
Please note that we will not use ðŸ‘‰ <strong><a href="/vba/userform/">UserForm</a></strong> for taking inputs, but use ðŸ‘‰ <strong><a href="/vba/inputbox-function/">Input Box</a></strong>  and ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Box</a></strong> for <em>value input</em> and will ask user to <strong>select SOLIDWORKS Entities</strong> from SOLIDWORKS.<br />
I hope you will also like this type of tutorials.<br />Thank you for reading till now.</p>

<h2 id="objective">Objective</h2>

<p>Objective of this article is to learn <em>how to create <strong>Fillet</strong> feature through SOLIDWORKS VBA Macros</em> in SOLIDWORKS.</p>

<p>We create <strong>Fillet Feature</strong> in following steps in general.</p>

<ol>
  <li>Ask user to select <strong>an edge</strong>.</li>
  <li>Ask user to input <strong>the Radius</strong> of <em>fillet feature</em>.</li>
  <li>Create <strong>Fillet feature</strong> from method <code class="language-plaintext highlighter-rouge">FeatureFillet3</code>.</li>
</ol>

<p>This method is <strong><em>most updated</em></strong> method, so <strong><em>use this method</em></strong> if you want to create a new <strong>Fillet Feature</strong>.</p>

<h2 id="steps-to-create-fillet">Steps To Create Fillet</h2>

<p>We use following steps to create <strong>Fillet Feature</strong> while writing macro.</p>

<ol>
  <li>Ask user to select <strong>an edge</strong>.</li>
  <li>Update code for <strong>Unit Conversion</strong>.</li>
  <li>Ask user to input <strong>the Radius</strong> of <em>fillet feature</em>.</li>
  <li>Create parameters variables for <code class="language-plaintext highlighter-rouge">FeatureFillet3</code> method.</li>
  <li>Create <strong>Fillet feature</strong> from method <code class="language-plaintext highlighter-rouge">FeatureFillet3</code>.</li>
</ol>

<h2 id="results-we-can-get">Results We Can Get</h2>

<p>After running our macro we successfully create <strong>Fillet feature</strong> as a result.</p>

<p>Below image shows the result we get.</p>

<p><a href="/assets/Solidworks_Images/feature-fillet/fillet-final-result.png"><img src="/assets/Solidworks_Images/feature-fillet/fillet-final-result.png" alt="fillet-final-result" /></a></p>

<blockquote>
  <p>To get the correct result please follow the steps correctly.</p>
</blockquote>

<h2 id="video-of-code-on-youtube">Video of Code on YouTube</h2>

<p>Please see below ðŸŽ¬ video on <strong>how to create Fillet feature</strong> from SOLIDWORKS VBA Macros.</p>

<iframe src="https://www.youtube.com/embed/InKlWYX2LSU" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explanation</strong> in the video.</p>

<p><strong>Explanation</strong> of each line and why we write code this way is given in <strong><em>this article</em></strong>.</p>

<p class="notice--warning">It is advisable to watch video, since it help you to better understand the process.</p>

<h2 id="code-sample">Code Sample</h2>

<p>Below is the <code class="language-plaintext highlighter-rouge">code</code> for creating <em>Fillet Feature</em> feature in <strong>VBA</strong> is given.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>

<span class="c1">' Variable for Solidworks Application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>

<span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>

<span class="c1">' Variable for Solidworks Fillet Feature</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Variable for Solidworks Selection Manager</span>
<span class="k">Dim</span> <span class="nv">swSelMgr</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectionMgr</span>

<span class="c1">' Variable for Solidworks Entity</span>
<span class="k">Dim</span> <span class="nv">swObject</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>

<span class="c1">' Program to create Fillet feature</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

  <span class="c1">' Set Solidworks Application variable to current application</span>
  <span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>

  <span class="c1">' Check if SOLIDWORKS is opened or not</span>
  <span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS is not opened"</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Set Solidworks document variable to currently opened document</span>
  <span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>

  <span class="c1">' Check if SOLIDWORKS document is opened or not</span>
  <span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS document is not opened. Please open a document."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>

  <span class="c1">' Set Solidworks Selection Manager variablt to opened document's selection manager</span>
  <span class="k">Set</span> <span class="n">swSelMgr</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">SelectionManager</span>
  
  <span class="c1">' Inform user to select an edge for Fillet feature.</span>
  <span class="n">MsgBox</span> <span class="s">"Please select an Edge for Fillet feature."</span>
      
  <span class="c1">' Loop until Solidworks Entity variable is equal to selected edge</span>
  <span class="k">While</span> <span class="n">swObject</span> <span class="ow">Is</span> <span class="k">Nothing</span>
      
    <span class="c1">' Local integer for loop</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="c1">' Looping until we select an edge</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectCount2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
      <span class="c1">' If the selection type edge</span>
      <span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelEDGES</span> <span class="k">Then</span>
          
        <span class="c1">' Set the Solidworks Entity object to selected edge</span>
        <span class="k">Set</span> <span class="n">swObject</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span>
    
    <span class="n">DoEvents</span>
  <span class="k">Wend</span>
  
  <span class="c1">'-----------------------BELOW IS THE SOLUTION----------------------------------------</span>

  <span class="c1">' Local variables used as Conversion Factors</span>
  <span class="k">Dim</span> <span class="nv">LengthConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
  <span class="k">Dim</span> <span class="nv">AngleConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Use a Select Case, to get the length of active Unit and set the different factors</span>
  <span class="k">Select</span> <span class="k">Case</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">GetUnits</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1">' GetUnits function gives us, active unit</span>
    
    <span class="k">Case</span> <span class="n">swMETER</span>    <span class="c1">' If length is in Meter</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">Case</span> <span class="n">swMM</span>       <span class="c1">' If length is in MM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swCM</span>       <span class="c1">' If length is in CM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">100</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swINCHES</span>   <span class="c1">' If length is in INCHES</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swFEET</span>     <span class="c1">' If length is in FEET</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.0254</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swFEETINCHES</span>     <span class="c1">' If length is in FEET &amp; INCHES</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>  <span class="c1">' For length we use sama as Inch</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swANGSTROM</span>        <span class="c1">' If length is in ANGSTROM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10000000000</span><span class="p">#</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swNANOMETER</span>       <span class="c1">' If length is in NANOMETER</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swMICRON</span>       <span class="c1">' If length is in MICRON</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
  <span class="k">End</span> <span class="k">Select</span>
  
  <span class="c1">'----------------------------------------------------------------</span>
  
  <span class="c1">' Variable to store fillet radius</span>
  <span class="k">Dim</span> <span class="nv">filletRadius</span> <span class="ow">As</span> <span class="kt">Double</span>
  <span class="n">filletRadius</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please enter radius of Fillet."</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
  
  <span class="c1">' Radius array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">radiiArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Radius variable</span>
  <span class="k">Dim</span> <span class="nv">radiis0</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Distance array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">dist2Array0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Distance variable</span>
  <span class="k">Dim</span> <span class="nv">dists20</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Conic Rhombus array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">conicRhosArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Conic Rhombus variable</span>
  <span class="k">Dim</span> <span class="nv">coniRhos0</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Set back array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">setBackArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Set back variable</span>
  <span class="k">Dim</span> <span class="nv">setBacks0</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Point array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">pointArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Point variable</span>
  <span class="k">Dim</span> <span class="nv">points0</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Point Distance array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">pointDist2Array0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Point distance variable</span>
  <span class="k">Dim</span> <span class="nv">pointsDist20</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Point Rhombus array for Fillet feature</span>
  <span class="k">Dim</span> <span class="nv">pointRhoArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
  <span class="c1">' Point Rhombus variable</span>
  <span class="k">Dim</span> <span class="nv">pointsRhos0</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Set 1st instance to respective variable</span>
  <span class="n">radiiArray0</span> <span class="o">=</span> <span class="n">radiis0</span>
  <span class="n">dist2Array0</span> <span class="o">=</span> <span class="n">dists20</span>
  <span class="n">conicRhosArray0</span> <span class="o">=</span> <span class="n">coniRhos0</span>
  <span class="n">setBackArray0</span> <span class="o">=</span> <span class="n">setBacks0</span>
  <span class="n">pointArray0</span> <span class="o">=</span> <span class="n">points0</span>
  <span class="n">pointDist2Array0</span> <span class="o">=</span> <span class="n">pointsDist20</span>
  <span class="n">pointRhoArray0</span> <span class="o">=</span> <span class="n">pointsRhos0</span>
  
  <span class="c1">' Create Fillet feature</span>
  <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">FeatureFillet3</span><span class="p">(</span><span class="mi">195</span><span class="p">,</span> <span class="n">filletRadius</span><span class="p">,</span> <span class="n">filletRadius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">radiiArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">dist2Array0</span><span class="p">),</span> <span class="p">(</span><span class="n">conicRhosArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">setBackArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointDist2Array0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointRhoArray0</span><span class="p">))</span>

  <span class="c1">' Check if Fillet Feature created or not</span>
  <span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Fillet Feature."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>

  <span class="c1">' Clear all selection</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
    
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h2 id="prerequisite">Prerequisite</h2>

<p>There are some <em>prerequisite</em> for this article.</p>

<p>We are <strong>not</strong> creating feature from code but we use existing ðŸ‘‰ <strong><a href="/solidworks-macros/create-extrude-feature">Extrude</a> feature</strong> to create <strong>Fillet feature</strong> as shown in below picture.</p>

<p><a href="/assets/Solidworks_Images/feature-fillet/prerequisite.png"><img src="/assets/Solidworks_Images/feature-fillet/prerequisite.png" alt="prerequisite" /></a></p>

<p>As shown in above image, there is only <em>1 Extrude feature</em> in our part.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Extrude Feature</code> : This is our <strong>Extruded part</strong> for <strong>Fillet Feature</strong>.</li>
</ul>

<p>If you want to create <strong>Extrude</strong> feature <em>programmatically</em> then please refer to below article.</p>

<ul>
  <li>ðŸ‘‰ <strong><a href="/solidworks-macros/create-extrude-feature">SOLIDWORKS Macros - Create Extrude/Boss</a></strong></li>
</ul>

<blockquote>
  <p>Also, we will apply checks in this article, so the code we write should be error free most of the time.</p>
</blockquote>

<h2 id="steps-to-follow">Steps To Follow</h2>

<p>To create <strong>Fillet Feature</strong>, there are following steps:</p>

<ol>
  <li><em>Creating Global Variables</em></li>
  <li><em>Initializing required variables</em></li>
  <li><em>Ask user to select an edge</em></li>
  <li><em>Get unit Conversion factors</em></li>
  <li><em>User input for Fillet radius</em></li>
  <li><em>Preparing parameters</em></li>
  <li><em>Create Fillet feature using parameters</em></li>
</ol>

<p>Now let us walk through <strong>each step</strong> as given <strong>above</strong>, and <strong>understand</strong> every line.</p>

<blockquote>
  <p>I also give some <strong><em>links (see icon ðŸ‘‰)</em></strong> so that you can go through them if there are anything I explained in previous articles.</p>
</blockquote>

<h3 id="creating-global-variables">Creating Global Variables</h3>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>
</code></pre></div></div>

<p>This line forces us to define every variable we are going to use.</p>

<p>For more information please visit ðŸ‘‰ <strong><a href="/solidworks-macros/open-new-document">SOLIDWORKS Macros - Open new Part document</a></strong> post.</p>

<p>We create following variables.</p>

<ul>
  <li><strong>Variable for Solidworks application</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swApp</code> and the type of this <code class="language-plaintext highlighter-rouge">swApp</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks document</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swDoc</code> and the type of this <code class="language-plaintext highlighter-rouge">swDoc</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Fillet Feature</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Fillet Feature</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFeature</code> for <strong>SOLIDWORKS Fillet Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Selection Manager</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Selection Manager</span>
<span class="k">Dim</span> <span class="nv">swSelMgr</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectionMgr</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swSelMgr</code> and the type of this <code class="language-plaintext highlighter-rouge">swSelMgr</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SelectionMgr</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SelectionMgr</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISelectionMgr_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Entity</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Entity</span>
<span class="k">Dim</span> <span class="nv">swObject</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swObject</code> and the type of this <code class="language-plaintext highlighter-rouge">swObject</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Entity</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<p><strong><em>These all are our global variables.</em></strong></p>

<p>They are <strong>SOLIDWORKS API Objects</strong>.</p>

<p>So basically I group all the <strong>SOLIDWORKS API Objects</strong> in one place.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Program to create Fillet feature</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<p>Next is our <code class="language-plaintext highlighter-rouge">Sub</code> procedure which has name of <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p>This procedure hold all the <strong><em>statements (instructions)</em></strong> we give to computer.</p>

<p>To know more about <strong>Sub Procedure</strong> you can check ðŸ‘‰ <strong><a href="/vba/sub-and-function-procedure/">VBA Sub and Function Procedures</a></strong> article of this website.</p>

<h3 id="initializing-required-variables">Initializing Required Variables</h3>

<p>Inside this procedure we first initialize required variables as given below.</p>

<ul>
  <li><em>Set SOLIDWORKS variable to SOLIDWORKS application</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS variable to SOLIDWORKS application</span>
<span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we set the value of our SOLIDWORKS variable <code class="language-plaintext highlighter-rouge">swApp</code>; which we define earlier; to SOLIDWORKS application.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS is opened or not</span>
<span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS is not opened"</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS application variable is <em>successfully assigned</em> to current SOLIDWORKS application.</p>

<ul>
  <li><em>Set SOLIDWORKS document variable to opened part document</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS document variable to opened part document</span>
<span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> variable to currently open part document.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS document is opened or not</span>
<span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS document is not opened. Please open a document."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> is opened.</p>

<p>If SOLIDWORKS document is not opened then code execute inside the code and inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<ul>
  <li><em>Set SOLIDWORKS Selection Manager variable</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS Selection Manager variable</span>
<span class="k">Set</span> <span class="n">swSelMgr</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">SelectionManager</span>
</code></pre></div></div>

<p>In above line, we set SOLIDWORKS Selection Manager<code class="language-plaintext highlighter-rouge">swSelMgr</code> variable to current documentâ€™s Selection Manager.</p>

<h3 id="ask-user-to-select-an-edge">Ask user to select an edge</h3>

<p>Now we will ask use to <em>select an edge</em> for <strong>Fillet</strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Inform user to select an edge for Fillet feature.</span>
<span class="n">MsgBox</span> <span class="s">"Please select an Edge for Fillet feature."</span>
</code></pre></div></div>

<p>Image of above message is shown in below image.</p>

<p><a href="/assets/Solidworks_Images/feature-fillet/select-edge-message.png"><img src="/assets/Solidworks_Images/feature-fillet/select-edge-message.png" alt="message to use for edge selection" /></a></p>

<p>In about line of code we show a <code class="language-plaintext highlighter-rouge">Msgbox</code> to use displaying message to select an Edge of extrude.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop until Solidworks Entity variable is equal to selected edge</span>
<span class="k">While</span> <span class="n">swObject</span> <span class="ow">Is</span> <span class="k">Nothing</span>

<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code, we create a <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>This loops until we select the our <strong>Edge</strong> for <strong>Fillet feature</strong>.</p>

<p>For more details about <code class="language-plaintext highlighter-rouge">While</code> loop, please see ðŸ‘‰ <strong><a href="/vba/looping/">VBA Looping</a></strong> article from this website.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Local integer for loop</span>
<span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
</code></pre></div></div>

<p>In above line of code, we create a local integer name <code class="language-plaintext highlighter-rouge">i</code> as a counter.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop until we select an edge</span>
<span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectCount2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">Next</span>
</code></pre></div></div>

<p>In above line of code, we create a <code class="language-plaintext highlighter-rouge">For</code> loop.</p>

<p>This code loops from <code class="language-plaintext highlighter-rouge">i = 1</code> to number of <code class="language-plaintext highlighter-rouge">objects</code> we select.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' If the selection type edge</span>
<span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelEDGES</span> <span class="k">Then</span>

  <span class="c1">' Set the Solidworks Entity object to selected edge</span>
  <span class="k">Set</span> <span class="n">swObject</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong>  with a condition.</p>

<p>The  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong>  is <code class="language-plaintext highlighter-rouge">True</code> when selected <code class="language-plaintext highlighter-rouge">object</code> is type of <em>SOLIDWORKS Edge</em>.</p>

<p>When  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> is True we execute code given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set the Solidworks Entity object to selected edge</span>
<span class="k">Set</span> <span class="n">swObject</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line, we set the <em>SOLIDWORKS Entity</em> object to <strong>selected edge</strong>.</p>

<p>After <code class="language-plaintext highlighter-rouge">For</code> loop, we have a call for <strong><code class="language-plaintext highlighter-rouge">DoEvents</code></strong> function.</p>

<h3 id="get-unit-conversion-factors">Get unit Conversion factors</h3>

<p>Now we need to get unit Conversion factors as shown in below code.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">'-----------------------Unit Conversion Factors----------------------------------------</span>
  
<span class="c1">' Local variables used as Conversion Factors</span>
<span class="k">Dim</span> <span class="nv">LengthConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
<span class="k">Dim</span> <span class="nv">AngleConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>

<span class="c1">' Use a Select Case, to get the length of active Unit and set the different factors</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">GetUnits</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1">' GetUnits function gives us, active unit</span>

<span class="k">Case</span> <span class="n">swMETER</span>    <span class="c1">' If length is in Meter</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">Case</span> <span class="n">swMM</span>       <span class="c1">' If length is in MM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swCM</span>       <span class="c1">' If length is in CM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">100</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swINCHES</span>   <span class="c1">' If length is in INCHES</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swFEET</span>     <span class="c1">' If length is in FEET</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.0254</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swFEETINCHES</span>     <span class="c1">' If length is in FEET &amp; INCHES</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>  <span class="c1">' For length we use sama as Inch</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swANGSTROM</span>        <span class="c1">' If length is in ANGSTROM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10000000000</span><span class="p">#</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swNANOMETER</span>       <span class="c1">' If length is in NANOMETER</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swMICRON</span>       <span class="c1">' If length is in MICRON</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
<span class="k">End</span> <span class="k">Select</span>

<span class="c1">'----------------------------------------------------------------</span>
</code></pre></div></div>

<p>I have already explained about this in previous ðŸ‘‰ <strong><a href="/solidworks-macros/unit-correction/">Solidworks Macro - Fix Unit Issue</a></strong> article in this website.</p>

<p>Please visit ðŸ‘‰ <strong><a href="/solidworks-macros/unit-correction/">Solidworks Macro - Fix Unit Issue</a></strong> article for more details.</p>

<h3 id="user-input-for-fillet-radius">User input for Fillet radius</h3>

<p>Now we ask user to <strong>input</strong> Fillet Radius as shown in below code.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable to store fillet radius</span>
<span class="k">Dim</span> <span class="nv">filletRadius</span> <span class="ow">As</span> <span class="kt">Double</span>
<span class="n">filletRadius</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please enter radius of Fillet."</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
</code></pre></div></div>

<p>In above code sample, we first create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">filletRadius</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<p>After that we show a input box to get the Fillet radius from user.</p>

<p>Image of input box is shown below.</p>

<p><a href="/assets/Solidworks_Images/feature-fillet/fillet-radius-input-box.png"><img src="/assets/Solidworks_Images/feature-fillet/fillet-radius-input-box.png" alt="message to use for fillet radius input" /></a></p>

<p>After getting input value from <code class="language-plaintext highlighter-rouge">InputBox</code>, we first multiply it with <code class="language-plaintext highlighter-rouge">LengthConversionFactor</code>.</p>

<blockquote>
  <p>By doing this we set the input value to at fix with same unit system of part.</p>
</blockquote>

<p>After conversion we assign the final value to <code class="language-plaintext highlighter-rouge">filletRadius</code> variable.</p>

<p>This <code class="language-plaintext highlighter-rouge">filletRadius</code> variable is our 1st parameter value.</p>

<h3 id="preparing-parameters">Preparing parameters</h3>

<p>Now we need to prepare parameters for <strong><code class="language-plaintext highlighter-rouge">FeatureFillet3</code></strong> method.</p>

<p class="notice--warning">Please note that I found these parameter to use the way it shown here.<br />
If you have another way to for <strong><code class="language-plaintext highlighter-rouge">FeatureFillet3</code></strong> method please let me know.<br /></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Radius array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">radiiArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">radiiArray0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Radius variable</span>
<span class="k">Dim</span> <span class="nv">radiis0</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">radiis0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Distance array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">dist2Array0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">dist2Array0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Distance variable</span>
<span class="k">Dim</span> <span class="nv">dists20</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">dists20</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Conic Rhombus array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">conicRhosArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">conicRhosArray0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Conic Rhombus variable</span>
<span class="k">Dim</span> <span class="nv">coniRhos0</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">coniRhos0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set back array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">setBackArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">setBackArray0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set back variable</span>
<span class="k">Dim</span> <span class="nv">setBacks0</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">setBacks0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">pointArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">pointArray0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point variable</span>
<span class="k">Dim</span> <span class="nv">points0</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">points0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point Distance array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">pointDist2Array0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">pointDist2Array0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point distance variable</span>
<span class="k">Dim</span> <span class="nv">pointsDist20</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">pointsDist20</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point Rhombus array for Fillet feature</span>
<span class="k">Dim</span> <span class="nv">pointRhoArray0</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">pointRhoArray0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Variant</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Point Rhombus variable</span>
<span class="k">Dim</span> <span class="nv">pointsRhos0</span> <span class="ow">As</span> <span class="kt">Double</span>
</code></pre></div></div>

<p>In above code sample, we create a variable.</p>

<ol>
  <li>Name of variable = <code class="language-plaintext highlighter-rouge">pointsRhos0</code></li>
  <li>Type of variable = <code class="language-plaintext highlighter-rouge">Double</code></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set 1st instance to respective variable</span>
<span class="n">radiiArray0</span> <span class="o">=</span> <span class="n">radiis0</span>
<span class="n">dist2Array0</span> <span class="o">=</span> <span class="n">dists20</span>
<span class="n">conicRhosArray0</span> <span class="o">=</span> <span class="n">coniRhos0</span>
<span class="n">setBackArray0</span> <span class="o">=</span> <span class="n">setBacks0</span>
<span class="n">pointArray0</span> <span class="o">=</span> <span class="n">points0</span>
<span class="n">pointDist2Array0</span> <span class="o">=</span> <span class="n">pointsDist20</span>
<span class="n">pointRhoArray0</span> <span class="o">=</span> <span class="n">pointsRhos0</span>
</code></pre></div></div>

<p>In above line of code, we set <em>1st instance</em> to respective variable.</p>

<h3 id="create-fillet-feature-using-parameters">Create Fillet feature using parameters</h3>

<p>Now we create Fillet feature using parameters we define previously.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Fillet feature</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">FeatureFillet3</span><span class="p">(</span><span class="mi">195</span><span class="p">,</span> <span class="n">filletRadius</span><span class="p">,</span> <span class="n">filletRadius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">radiiArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">dist2Array0</span><span class="p">),</span> <span class="p">(</span><span class="n">conicRhosArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">setBackArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointArray0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointDist2Array0</span><span class="p">),</span> <span class="p">(</span><span class="n">pointRhoArray0</span><span class="p">))</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swFeature</code> by <code class="language-plaintext highlighter-rouge">FeatureFillet3</code> method.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureFillet3</code> method takes following parameters as explained:</p>

<ul>
  <li>
    <p><strong>Options</strong> - <em>Feature fillet options as defined in <code class="language-plaintext highlighter-rouge">swFeatureFilletOptions_e</code> and are as follows.</em></p>

    <table>
      <thead>
        <tr>
          <th>Member</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletAsymmetric</code></strong></td>
          <td>16384 or 0x4000</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletAttachEdges</code></strong></td>
          <td>64 or 0x40</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletConstantWidth</code></strong></td>
          <td>512 or 0x200</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletCornerType</code></strong></td>
          <td>32 or 0x20</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletCurvatureContinuous</code></strong></td>
          <td>256 or 0x100; applies to face fillets only</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletKeepFeatures</code></strong></td>
          <td>128 or 0x80</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletNoTrimNoAttached</code></strong></td>
          <td>1024 or 0x400; set to trim and attach fillet; do not  set otherwise</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletPropagate</code></strong></td>
          <td>1 or 0x1</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletPropagateFeatToParts</code></strong></td>
          <td>8192 or 0x2000</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletReverseFace1Dir</code></strong></td>
          <td>2048 or 0x800</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletReverseFace2Dir</code></strong></td>
          <td>4096 or 0x1000</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletUniformRadius</code></strong></td>
          <td>2 or 0x2; set for a uniform radius; do not set for  multiple radii</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletUseHelpPoint</code></strong></td>
          <td>8 or 0x8</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletUseTangentHoldLine</code></strong></td>
          <td>16 or 0x10</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletVarRadiusType</code></strong></td>
          <td>4 or 0x4; set for a straight transition; do not set  for a smooth transition</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>R1</strong> - <em>Uniform radius of the symmetric fillet.</em></p>
  </li>
  <li>
    <p><strong>R2</strong> - <em>Distance 2 radius of the asymmetric fillet.</em></p>
  </li>
  <li>
    <p><strong>Rho</strong> - <em>Value that determines the conic shape of the fillet.</em></p>

    <ul>
      <li>Conic rho value [0.05, 0.95], if <code class="language-plaintext highlighter-rouge">ConicRhoType</code> = <code class="language-plaintext highlighter-rouge">swFeatureFilletProfileType_e.swFeatureFilletConicRho</code></li>
      <li>Conic radius value, if <code class="language-plaintext highlighter-rouge">ConicRhoType</code> = <code class="language-plaintext highlighter-rouge">swFeatureFilletProfileType_e.swFeatureFilletConicRadius</code></li>
    </ul>
  </li>
  <li>
    <p><strong>Ftyp</strong> - <em>Type of fillet as defined in <code class="language-plaintext highlighter-rouge">swFeatureFilletType_e</code> as follows:</em></p>

    <table>
      <thead>
        <tr>
          <th>Member</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletType_Face</code></strong></td>
          <td>2</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletType_FullRound</code></strong></td>
          <td>3</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletType_Simple</code></strong></td>
          <td>0</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletType_VariableRadius</code></strong></td>
          <td>1</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>OverflowType</strong> - <em>Control of fillet overflowing onto adjacent surfaces as defined in <code class="language-plaintext highlighter-rouge">swFilletOverFlowType_e</code> as follows:</em></p>

    <table>
      <thead>
        <tr>
          <th>Member</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFilletOverFlowType_Default</code></strong></td>
          <td>0 = Default;</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFilletOverFlowType_KeepEdge</code></strong></td>
          <td>1 =  Edges that are overflowed by the fillet are not modified; the fillet surface is  trimmed by all the adjacent edges; as a result, an additional transition fillet  surface might be needed to complete the fillet</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFilletOverFlowType_KeepSurface</code></strong></td>
          <td>2 =  Fillet surface is either merged with the adjacent surfaces smoothly or trimmed  by the adjacent surfaces; as a result, it is unlikely that an additional  transition fillet surface is created</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>ConicRhoType</strong> - <em>Fillet profile type as defined in <code class="language-plaintext highlighter-rouge">swFeatureFilletProfileType_e</code> as follows:</em></p>

    <table>
      <thead>
        <tr>
          <th>Member</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletCircular</code></strong></td>
          <td>0 = Circular for symmetric fillets; elliptical for  asymmetric fillets</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletConicRadius</code></strong></td>
          <td>2</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletConicRho</code></strong></td>
          <td>1</td>
        </tr>
        <tr>
          <td><strong><code class="language-plaintext highlighter-rouge">swFeatureFilletConicRhoZeroChamfer</code></strong></td>
          <td>3 = Chamfer cross section</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>Radii</strong> - <em>Array containing the radii for the symmetric fillet.</em></li>
  <li><strong>Dist2Arr</strong> - <em>Array containing the Distance 2 radii for the asymmetric fillet.</em></li>
  <li><strong>RhoArr</strong> - <em>Array of Rho values for the specified <code class="language-plaintext highlighter-rouge">ConicRhoType</code> for the variable radius fillet.</em></li>
  <li><strong>SetBackDistances</strong> - <em>Array containing setback distances along the fillet edge.</em></li>
  <li><strong>PointRadiusArray</strong> - <em>Array containing radius control points along the length of the edge for symmetric fillets.</em></li>
  <li><strong>PointDist2Array</strong> - <em>Array containing Distance 2 radius control points along the length of the edge for asymmetric fillets.</em></li>
  <li><strong>PointRhoArray</strong> - <em>Array of Rho values for the specified <code class="language-plaintext highlighter-rouge">ConicRhoType</code> at various control points along the length of the edge.</em></li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">FeatureFillet3</code> method return <strong>feature</strong> data object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<table>
  <thead>
    <tr>
      <th>Parameter Name</th>
      <th>Value Used</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Options</strong></td>
      <td><code class="language-plaintext highlighter-rouge">195</code> (now this what I get from recording and this works for me.)</td>
    </tr>
    <tr>
      <td><strong>R1</strong></td>
      <td><code class="language-plaintext highlighter-rouge">filletRadius</code></td>
    </tr>
    <tr>
      <td><strong>R2</strong></td>
      <td><code class="language-plaintext highlighter-rouge">filletRadius</code></td>
    </tr>
    <tr>
      <td><strong>Rho</strong></td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
    </tr>
    <tr>
      <td><strong>Ftyp</strong></td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
    </tr>
    <tr>
      <td><strong>OverflowType</strong></td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
    </tr>
    <tr>
      <td><strong>ConicRhoType</strong></td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
    </tr>
    <tr>
      <td><strong>Radii</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(radiiArray0)</code></td>
    </tr>
    <tr>
      <td><strong>Dist2Arr</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(dist2Array0)</code></td>
    </tr>
    <tr>
      <td><strong>RhoArr</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(conicRhosArray0)</code></td>
    </tr>
    <tr>
      <td><strong>SetBackDistances</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(setBackArray0)</code></td>
    </tr>
    <tr>
      <td><strong>PointRadiusArray</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(pointArray0)</code></td>
    </tr>
    <tr>
      <td><strong>PointDist2Array</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(pointDist2Array0)</code></td>
    </tr>
    <tr>
      <td><strong>PointRhoArray</strong></td>
      <td><code class="language-plaintext highlighter-rouge">(pointRhoArray0)</code></td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">FeatureFillet3</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Fillet Feature created or not</span>
<span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Fillet Feature."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we able to create **Fillet Feature ** or not.</p>

<p>If we failed to select then inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<p>After showing error message our program <strong>exit</strong> from here itself.</p>

<p>Now we run the macro and after running macro we get <strong>Fillet</strong> as shown in below image.</p>

<p><a href="/assets/Solidworks_Images/feature-fillet/fillet-final-result.png"><img src="/assets/Solidworks_Images/feature-fillet/fillet-final-result.png" alt="fillet-final-result" /></a></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Clear all selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<p>In above line, we clear all previous selection.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ClearSelection2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<p><strong>This is it !!!</strong></p>

<p><em>I hope my efforts will helpful to someone!</em></p>

<p>If you found anything to <strong>add or update</strong>, please let me know on my <em>e-mail</em>.</p>

<p>Hope this post helps you to <strong>create Fillet Feature</strong> with SOLIDWORKS VBA Macros.</p>

<p>For more such tutorials on <strong>SOLIDWORKS VBA Macro</strong>, do come to this blog after sometime.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not!</em></p>

<p><em>Till then, Happy learning!!!</em></p>
:ET
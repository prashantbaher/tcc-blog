<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-117501871-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<script data-ad-client="ca-pub-8158659264340002" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title data-react-helmet="true">Open Solidworks Part Document | The Cad Coder</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Open Solidworks Part Document | The Cad Coder"><meta data-react-helmet="true" name="description" content="In this post, I tell you about how to Open Solidworks Part Document using Solidworks C++ API from Visual Studio."><meta data-react-helmet="true" property="og:description" content="In this post, I tell you about how to Open Solidworks Part Document using Solidworks C++ API from Visual Studio."><meta data-react-helmet="true" property="og:url" content="https://prashantbaher.github.io//docs/solidworks-Cpp-tutorials/sw-cpp-part-doc"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo_icon.ico"><link data-react-helmet="true" rel="canonical" href="https://prashantbaher.github.io//docs/solidworks-Cpp-tutorials/sw-cpp-part-doc"><link rel="stylesheet" href="/styles.1f42e2d6.css">
<link rel="preload" href="/styles.8dac73e6.js" as="script">
<link rel="preload" href="/runtime~main.c20766ae.js" as="script">
<link rel="preload" href="/main.c76857e4.js" as="script">
<link rel="preload" href="/1.edd1b653.js" as="script">
<link rel="preload" href="/2.266b950c.js" as="script">
<link rel="preload" href="/94.4c75db3c.js" as="script">
<link rel="preload" href="/95.3eb551e8.js" as="script">
<link rel="preload" href="/f976f453.ebf1a006.js" as="script">
<link rel="preload" href="/17896441.bf30d83f.js" as="script">
<link rel="preload" href="/3ef8e435.d5ae188f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"><strong class="navbar__title">The Cad Coder</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">VBA</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/vba-Intro">VBA Tutorials</a></li><li><a class="dropdown__link" href="/docs/vba-userforms">VBA UserForms</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/vba-in-sw">SOLIDWORKS VBA</a><a class="navbar__item navbar__link" href="/docs/sw-cpp">SOLIDWORKS C++</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">About</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="right" href="/docs/about">About Me</a></li><li><a class="dropdown__link" position="right" href="/docs/resources">Resources</a></li><li><a class="dropdown__link" position="right" href="/docs/privacy">Privacy Policy</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"><strong class="navbar__title">The Cad Coder</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">VBA</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/vba-Intro">VBA Tutorials</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/vba-userforms">VBA UserForms</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/vba-in-sw">SOLIDWORKS VBA</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/sw-cpp">SOLIDWORKS C++</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="right" href="/docs/about">About Me</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/docs/resources">Resources</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/docs/privacy">Privacy Policy</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sw-cpp">Solidworks C++ API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/solidworks-Cpp-tutorials/sw-cpp-pre">Prerequisite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/solidworks-Cpp-tutorials/sw-cpp-open">Open Solidworks &amp; Hello World</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/solidworks-Cpp-tutorials/sw-cpp-part-doc">Open Solidworks Part Document</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Open Solidworks Part Document</h1></header><div class="markdown"><p>In this post, I tell you about <strong>how to Open Solidworks Part Document using Solidworks C++ API</strong> from Visual Studio.</p><p>I hope you have setup Visual Studio community version.</p><p>If not then please go to <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-pre">Solidworks C++ API - Prerequisite</a></strong> post and watch the suggested videos before proceeding further.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="video-of-code-on-youtube"></a>Video of Code on YouTube<a aria-hidden="true" tabindex="-1" class="hash-link" href="#video-of-code-on-youtube" title="Direct link to heading">#</a></h2><p>Please see below video on <strong>how to Open Solidworks Part Document using Solidworks C++ API</strong> from Visual Studio.</p><div class="youtube-responsive-container"><iframe src="https://www.youtube.com/embed/DBESb0ZGnGc" frameborder="0"></iframe></div><p>Please note that there are <strong>no explaination</strong> in the video. </p><p><strong>Explaination</strong> of each line and why we write code this way is given in this post.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="create-a-new-project"></a>Create a New project<a aria-hidden="true" tabindex="-1" class="hash-link" href="#create-a-new-project" title="Direct link to heading">#</a></h2><p>Fist, we will create a new project in Visual Studio.</p><p>As shown in below image I have created a new project named <code>OpenPartDocument</code> in Visual Studio.</p><p><img alt="new-project-window" src="/assets/images/new-project-window-de59822283fe5ca841a16722957d5604.png"></p><p>If you want to know more detail for Creating a New Project in Visual Studio, please visit <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-open#create-a-new-project">Create a New project</a></strong> section of <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-open">Solidworks C++ API - Open Solidworks &amp; Hello World</a></strong> post.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="add-source-file"></a>Add Source file<a aria-hidden="true" tabindex="-1" class="hash-link" href="#add-source-file" title="Direct link to heading">#</a></h2><p>After creating a new project, we need to Add Source file to our project.</p><p>I have already explain each steps taken to create/add a &quot;<strong>Source.cpp</strong>&quot; into our project in <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-open#add-source-file">Add Source file</a></strong> section of <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-open">Solidworks C++ API - Open Solidworks &amp; Hello World</a></strong> post.</p><p>This will add &quot;<strong>Source.cpp</strong>&quot; file into our project.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="add-references-to-solidworks-type-library-files"></a>Add References to Solidworks Type Library files<a aria-hidden="true" tabindex="-1" class="hash-link" href="#add-references-to-solidworks-type-library-files" title="Direct link to heading">#</a></h2><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>This section is copy/paste from <strong><a href="/docs/solidworks-Cpp-tutorials/sw-cpp-open">Solidworks C++ API - Open Solidworks &amp; Hello World</a></strong> post.</p></div></div><p>Now we need to <em>add References to Solidworks Type Library files.</em></p><p>For this please follow below steps.</p><ol><li><p>Select the <strong>OpenSolidworkTest</strong> project and and <em>Click Right Mouse Button (RMB)</em>.</p></li><li><p>By doing this <em>a context menu</em> is appear as shown in below image.</p></li><li><p>From this <em>context menu</em>, select <strong>&quot;Properties&quot;</strong> option, which is the last one, as shown in below image.</p></li></ol><p><img alt="open-property-window" src="/assets/images/open-property-window-fbed5c07225a50d940c99768ebb68f86.png"></p><p>This will open a new window as shown in below image.</p><p><img alt="project-property-window" src="/assets/images/project-property-window-71bcffa26b32a7297231b56e5ae5d052.png"></p><p>Now following below steps:</p><ol><li><p>Select C/C++ option</p></li><li><p>Add SOLIDWORKS folders path to 2nd Red colored box as shown in below image. Usually this path is &quot;<code>C:\Program Files\ Solidworks Corp\SOLIDWORKS</code>&quot; if installed in default location.</p></li></ol><p><img alt="add-solidowrks-reference" src="/assets/images/add-solidowrks-reference-1a1ca5269a89c20dcf68687bed4f57f1.png"></p><p>After adding the folder path, select &quot;<strong>Apply</strong>&quot; button.</p><p>This complete the process of <em>adding References to Solidworks Type Library files.</em></p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="add-code-to-source-file"></a>Add Code to Source file<a aria-hidden="true" tabindex="-1" class="hash-link" href="#add-code-to-source-file" title="Direct link to heading">#</a></h2><p>Now we need to add to <em>Source.cpp</em> file.</p><p>Please copy the below code sample to your <em>Source.cpp</em> file.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-cpp codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&lt;atlbase.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">import</span><span class="token macro property"> &quot;sldworks.tlb&quot; raw_interfaces_only, raw_native_types, no_namespace, named_guids  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// SOLIDWORKS type library</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="font-style:italic">import</span><span class="token macro property"> &quot;swconst.tlb&quot; raw_interfaces_only, raw_native_types, no_namespace, named_guids   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// SOLIDWORKS constants type library</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Initialize COM</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Do this before using ATL smart pointers so COM is available.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">CoInitialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Use a block, so the smart pointers are destructed when the scope of this block is left</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// COM Pointer of Soldiworks object</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        CComPtr</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ISldWorks</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> swApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// COM Pointer of Soldiworks Model Document</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        CComPtr</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">IModelDoc2</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> swDoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Variable to check if function is </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        HRESULT result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> NOERROR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// COM Style String for message to user</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        CComBSTR _messageToUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// long type variable to store the result value by user</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">long</span><span class="token plain"> _lMessageResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Create an instance of Solidworks application</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// If it fails then return 0 and close program</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">swApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">CoCreateInstance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">__uuidof</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SldWorks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> CLSCTX_LOCAL_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> S_OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Stop COM </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">CoUninitialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">return</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// COM Style String to store document type</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        CComBSTR _documentType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Get the Default Part document</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        swApp</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">GetUserPreferenceStringValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">swUserPreferenceStringValue_e</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">swDefaultTemplatePart</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">_documentType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Create a new Part Document </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> swApp</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">INewDocument2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_documentType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">swDoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// If there are no Default Part document assign then show a message to user</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// and Stop COM, Visible the Solidworks and return the function</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">result </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> S_OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// COM Style String for message to user</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _messageToUser </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">L</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Failed to open document.\nPlease try again.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Send a message to user and store the return value in _lMessageResult by referencing it</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            swApp</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">SendMsgToUser2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_messageToUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> swMessageBoxIcon_e</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">swMbInformation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> swMessageBoxBtn_e</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">swMbOk</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">_lMessageResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Visible the Solidworks</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            swApp</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">put_Visible</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">VARIANT_TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Stop COM </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">CoUninitialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">return</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// If created successfully, then visible the Solidworks</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        swApp</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">put_Visible</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">VARIANT_TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Stop COM </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">CoUninitialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Now Build the Solution as shown in below image.</p><p><img alt="build-solution" src="/assets/images/build-solution-588c7601214b803be92cd586a148bb2e.png"></p><p>After Building Solution run the program by pressing <strong>F5</strong>.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="final-result"></a>Final Result<a aria-hidden="true" tabindex="-1" class="hash-link" href="#final-result" title="Direct link to heading">#</a></h2><p>After running the program wait for few minute.</p><p>You will get result as shown in below image!!!</p><p><img alt="open-part-window" src="/assets/images/open-part-window-c644dafb267abcd0b776b8c1946e290c.png"></p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issues-and-solutions"></a>Issues and Solutions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issues-and-solutions" title="Direct link to heading">#</a></h2><p>There are some issues I can think of which might be come to some people.</p><p>Those are as follows:</p><p><strong>Issue 1:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Program closed without open Solidworks!</span></div></div></div></div></div><p><strong>Solution:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">I you face this issue, then open Solidworks Manually one time, close it and then run the program.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">It will solve this issue.</span></div></div></div></div></div><p><strong>Issue 2:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Program unable to create Part Document</span></div></div></div></div></div><p><strong>Solution:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">This is a tricky one!!!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">If you face this issue, then you need to confirm in Solidworks that you have assigned the &quot;default Part template&quot;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Please refer to below image for proper setting to fix this issue.</span></div></div></div></div></div><p><img alt="default-template-locations" src="/assets/images/default-template-locations-abf74a769182507e4b234c14c5bc8c75.png"></p><p><strong><em>I hope this will helpful!!!</em></strong></p><hr><p><strong><em>This is it !!!</em></strong></p><p>We have completed our <em>Open Part Document</em> program in <em>Solidworks</em> using <strong>Solidworks C++ APIs</strong>.</p><p>Hope this post helps you to start with <em>Solidworks C++ API</em>.</p><p><em>If you like the post then please share it with your friends also.</em></p><p>Do let me know by you like this post or not! I will continue creating Solidworks C++ posts.</p><p>Till then, Happy learning!!!</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/solidworks-Cpp-tutorials/sw-cpp-open"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Open Solidworks &amp; Hello World</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#video-of-code-on-youtube" class="table-of-contents__link">Video of Code on YouTube</a></li><li><a href="#create-a-new-project" class="table-of-contents__link">Create a New project</a></li><li><a href="#add-source-file" class="table-of-contents__link">Add Source file</a></li><li><a href="#add-references-to-solidworks-type-library-files" class="table-of-contents__link">Add References to Solidworks Type Library files</a></li><li><a href="#add-code-to-source-file" class="table-of-contents__link">Add Code to Source file</a></li><li><a href="#final-result" class="table-of-contents__link">Final Result</a></li><li><a href="#issues-and-solutions" class="table-of-contents__link">Issues and Solutions</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Tutorials</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/vba-Intro">VBA Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/vba-in-sw">VBA in Solidworks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/thecadcoder" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCm_VglqA2S4WUXM55vyqAFg" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="mailto:thecadcoder@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">E-Mail</a></li><li class="footer__item"><a href="https://www.buymeacoffee.com/thecadcoder" target="_blank" rel="noopener noreferrer" class="footer__link-item">Buy Me a Coffee</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 The Cad Coder, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.8dac73e6.js"></script>
<script src="/runtime~main.c20766ae.js"></script>
<script src="/main.c76857e4.js"></script>
<script src="/1.edd1b653.js"></script>
<script src="/2.266b950c.js"></script>
<script src="/94.4c75db3c.js"></script>
<script src="/95.3eb551e8.js"></script>
<script src="/f976f453.ebf1a006.js"></script>
<script src="/17896441.bf30d83f.js"></script>
<script src="/3ef8e435.d5ae188f.js"></script>
</body>
</html>
<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- begin _includes/seo.html --><title>SOLIDWORKS Macro - Create Linear Pattern - The CAD Coder</title>
<meta name="description" content="This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.   If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.   But from this post onward we will take user-inputs.   In this article we did not use ðŸš€ UserForm for taking inputs, instead we use ðŸš€ Input Box for value input and ðŸš€ Message Box to notify user.   I hope you will also like this type of tutorials.   Thank you for reading.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="The CAD Coder">
<meta property="og:title" content="SOLIDWORKS Macro - Create Linear Pattern">
<meta property="og:url" content="http://localhost:4000/solidworks-macros/create-linear-patterns/">


  <meta property="og:description" content="This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.   If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.   But from this post onward we will take user-inputs.   In this article we did not use ðŸš€ UserForm for taking inputs, instead we use ðŸš€ Input Box for value input and ðŸš€ Message Box to notify user.   I hope you will also like this type of tutorials.   Thank you for reading.">







  <meta property="article:published_time" content="2022-04-10T14:47:25-04:00">






<link rel="canonical" href="http://localhost:4000/solidworks-macros/create-linear-patterns/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117501871-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117501871-2', { 'anonymize_ip': true});
</script>

<!-- end _includes/seo.html -->

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
    integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo.png">
  <link
    href="/feed.xml"
    type="application/atom+xml" rel="alternate" title="The CAD Coder Feed">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">

  <meta name="google-site-verification" content="OeSBbUv_kXDkDxaeoLixjE1BYxlbQRINt58H1UGbSMY" />

  
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="/">
        <img src="/assets/logo.png" width="30" height="30" class="img-fluid" alt="">
        <span>The CAD Coder</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a  class="nav-link"   href="/vba/vba-Introduction/"><span>VBA</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="active nav-link" style="border-bottom: 1px solid #fff;"   href="/Solidworks-macro-guide/"><span>Solidworks VBA Macro</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/Solidworks-csharp-api-tutorials/"><span>Solidworks C# API</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/Solidworks-cpp-api-tutorials/"><span>Solidworks C++ API</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/resources/"><span>Resources</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/aboutMe/"><span>About</span></a>
            </li>
            
            <!-- <li class="nav-item">
                <a class="nav-link disabled">Disabled</a>
            </li> -->
        </ul>
        <!-- <a class="btn btn-outline-success my-2 my-sm-0" href="/seach-document/" role="button">
            <i class="fas fa-search"></i>
        </a> -->
    </div>
</nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3 col-sm-4">
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">General - Solidworks Functions</span>
        

        
        <ul>
          
            <li><a href="/Solidworks-macro-guide/">Introduction</a></li>
          
            <li><a href="/solidworks-macros/open-new-document/">Open new Part document</a></li>
          
            <li><a href="/solidworks-macros/open-assembly-and-drawing/">Open Assembly and Drawing document</a></li>
          
            <li><a href="/solidworks-macros/select-plane-from-tree/">Selection Methods</a></li>
          
            <li><a href="/solidworks-macros/open-saved-document/">Open Saved Documents</a></li>
          
            <li><a href="/solidworks-macros/unit-correction/">Fix Unit Issue</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Lines</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/sketch-create-line/">Create Line</a></li>
          
            <li><a href="/solidworks-macros/sketch-create-centerline/">Create CenterLine</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Rectangles</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-corner-rectangle/">Create Corner Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-center-rectangle/">Create Center Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-3point-corner-rectangle/">Create 3-Point Corner Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-3point-center-rectangle/">Create 3-Point Center Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-parallelogram/">Create A Parallelogram</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Circles</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-circle/">Create Circle</a></li>
          
            <li><a href="/solidworks-macros/create-circle-by-radius/">Create Circle By Radius</a></li>
          
            <li><a href="/solidworks-macros/create-perimeter-circle/">Create Perimeter Circle</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Arcs</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-centerpoint-arc/">Create Centerpoint Arc</a></li>
          
            <li><a href="/solidworks-macros/create-tangent-arc/">Create Tangent Arc</a></li>
          
            <li><a href="/solidworks-macros/create-3point-arc/">Create 3-Point Arc</a></li>
          
            <li><a href="/solidworks-macros/polygon/">Create Polygon</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Slots</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-straight-slot/">Create a Straight Slot</a></li>
          
            <li><a href="/solidworks-macros/create-centerpoint-straight-slot/">Create a Centerpoint Straight Slot</a></li>
          
            <li><a href="/solidworks-macros/create-3point-arc-slot/">Create a 3-Point Arc Slot</a></li>
          
            <li><a href="/solidworks-macros/create-centerpoint-arc-slot/">Create a Centerpoint Arc Slot</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Point and Spline</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-point/">Create a Point</a></li>
          
            <li><a href="/solidworks-macros/create-spline/">Create a Spline</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Fillet and Chamfer</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-sketch-fillet/">Create a Fillet</a></li>
          
            <li><a href="/solidworks-macros/create-sketch-chamfer/">Create a Chamfer</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Trim and Extend</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/trim-entities/">Trim Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/extend-entities/">Extend Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Offset and Mirror</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/offset-entities/">Offset Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/mirror-entities/">Mirror Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Offset and Mirror</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/offset-entities/">Offset Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/mirror-entities/">Mirror Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Patterns</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/linear-skech-pattern/">Linear Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/edit-linear-skech-pattern/">Edit Linear Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/circular-skech-pattern/">Circular Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/edit-circular-skech-pattern/">Edit Circular Sketch Pattern</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Move and Rotate</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/move-copy-sketch-entities/">Move/Copy Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/rotate-copy-sketch-entities/">Rotate/Copy Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Relations</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/toggle-display-sketch-relation/">Toggle (Hide/Show) Sketch Relations</a></li>
          
            <li><a href="/solidworks-macros/add-sketch-relations/">Add Sketch Relations (Constraints)</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Dimensions</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/add-dimension-methods/">Add dimension to Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Extrudes</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-extrude-feature/">Extrude Feature</a></li>
          
            <li><a href="/solidworks-macros/create-revolved-feature/">Revolved Boss/Base Feature</a></li>
          
            <li><a href="/solidworks-macros/create-sweep-feature/">Sweep Boss/Base Feature</a></li>
          
            <li><a href="/solidworks-macros/create-lofted-boss-feature/">Lofted Boss/Base Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Cuts</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-extrude-cut-feature/">Extrude Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-revolve-cut-feature/">Revolve Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-sweep-cut-feature/">Sweep Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-loft-cut-feature/">Lofted Cut Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Holes and Threads</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-hole-from-hole-wizard/">Holes from Hole Wizard</a></li>
          
            <li><a href="/solidworks-macros/create-threads/">Threads</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Fillet & Chamfer</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-fillet/">Fillet Feature</a></li>
          
            <li><a href="/solidworks-macros/create-chamfer/">Chamfer Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Mirror & Patterns</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-mirror/">Mirror Feature</a></li>
          
            <li><a href="/solidworks-macros/create-linear-patterns/" class="active">Linear Pattern Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-circular-patterns/">Circular Pattern Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-sketch-driven-pattern/">Sketch Driven Pattern Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Transformation</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/create-rib/">Rib Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-draft/">Draft Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-shell/">Shell Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-wrap/">Wrap Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-scale/">Scale Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Reference Geometry</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/create-reference-plane/">Reference Plane</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-axis/">Reference Axis</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-coordinate/">Reference Co-Ordinate</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-point/">Reference Point</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - General</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-insert-component/">Insert Component</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-unfix-component/">Unfix Component</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - Standard Mates</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-conicident-mate/">Add Coincident Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-parallel-mate/">Add Parallel Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-perpendicular-mate/">Add Perpendicular Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-tangent-mate/">Add Tangent Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-concentric-mate/">Add Concentric Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-distance-mate/">Add Distance Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-angle-mate/">Add Angle Mate</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Others</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/convert-to-construction-sketch-segment/">Convert to Construction Sketch</a></li>
          
            <li><a href="/solidworks-macros/split-sketch-segments/">Split Open/Closed Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>

</div>
      <div class="col-md-9 col-sm-8">
        <div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    
    <meta itemprop="headline" content="SOLIDWORKS Macro - Create Linear Pattern">
    
    <meta itemprop="description" content="  This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.  If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.  But from this post onward we will take user-inputs.  In this article we did not use ðŸš€ UserForm for taking inputs, instead we use ðŸš€ Input Box for value input and ðŸš€ Message Box to notify user.  I hope you will also like this type of tutorials.  Thank you for reading.">
    
    
    <meta itemprop="datePublished" content="2022-04-10T14:47:25-04:00">
    

    <div class="page__inner-wrap">
      
      <header>
        <h1 id="page-title" class="page__title" itemprop="headline">SOLIDWORKS Macro - Create Linear Pattern
</h1>
        

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          26 minute read
        
      </span>
    
  </p>


      </header>
      

      <section class="page__content" itemprop="text">
        
        <aside class="sidebar__right sticky">
          <nav class="toc">
            <header>
              <h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4>
            </header>
            <ul class="toc__menu"><li><a href="#objective">Objective</a></li><li><a href="#results-we-can-get">Results We Can Get</a></li><li><a href="#video-of-code-on-youtube">Video of Code on YouTube</a></li><li><a href="#code-sample">Code Sample</a></li><li><a href="#prerequisite">Prerequisite</a></li><li><a href="#steps-to-follow">Steps To Follow</a><ul><li><a href="#creating-global-variables">Creating Global Variables</a></li><li><a href="#initializing-required-variables">Initializing Required Variables</a></li><li><a href="#ask-user-to-select-feature-and-directions">Ask user to select feature and directions</a></li><li><a href="#mark-selected-entities">Mark selected Entities</a></li><li><a href="#get-unit-conversion-factors">Get unit Conversion factors</a></li><li><a href="#create-linear-pattern-feature-definition">Create Linear Pattern Feature Definition</a></li><li><a href="#create-linear-pattern">Create Linear Pattern</a></li><li><a href="#final-work">Final work</a></li></ul></li></ul>

            <br/>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8158659264340002"
     crossorigin="anonymous"></script>
<!-- Vertical Ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8158659264340002"
     data-ad-slot="4311368222"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
          </nav>
        </aside>
        
        <div>
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8158659264340002"
     crossorigin="anonymous"></script>
<!-- Horizontal Ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8158659264340002"
     data-ad-slot="6007593278"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
          <div class="notice--warning">
  This article is an <strong>"Intermediate"</strong> post and required you to have some knowledge of <strong>VBA</strong>.<br />
  If you are following my articles you will notice that till now we were <strong>hardcoding</strong> the selections for input parameters.<br />
  But from this post onward we will take user-inputs.<br />
  In this article we did not use ðŸš€ <strong><a href="/vba/userform/">UserForm</a></strong> for taking inputs, instead we use ðŸš€ <strong><a href="/vba/inputbox-function/">Input Box</a></strong> for <em>value input</em> and ðŸš€ <strong><a href="/vba/msgBox-function/">Message Box</a></strong> to notify user.<br />
  I hope you will also like this type of tutorials.<br />
  Thank you for reading.<br />
</div>

<h2 id="objective">Objective</h2>

<p>Objective of this article is to learn <em>how to create <strong>Linear pattern</strong> feature through SOLIDWORKS VBA Macros</em> in SOLIDWORKS.</p>

<p>We create <strong>Linear pattern Feature</strong> in following steps in general.</p>

<ol>
  <li>Ask user to select <strong>a Feature to Linear pattern</strong>.</li>
  <li>Ask user to select <strong>an edge for Linear pattern</strong> in direction 1.</li>
  <li>Ask user to select <strong>an edge for Linear pattern</strong> in direction 2.</li>
  <li>Create <strong>Linear pattern feature data</strong>.</li>
  <li>Create <strong>Linear pattern feature</strong>.</li>
</ol>

<p>This method is <strong><em>most updated</em></strong> method, so <strong><em>use this method</em></strong> if you want to create a new <strong>Linear pattern Feature</strong> quickly.</p>

<h2 id="results-we-can-get">Results We Can Get</h2>

<p>After running our macro we successfully create <strong>Linear pattern feature</strong> as a result.</p>

<p>Below image shows the result we get.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/linear-pattern-final-result.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/linear-pattern-final-result.png" alt="linear-pattern-final-result" /></a></p>

<blockquote>
  <p>To get the correct result please follow the steps correctly.</p>
</blockquote>

<h2 id="video-of-code-on-youtube">Video of Code on YouTube</h2>

<p>Please see below ðŸŽ¬ video on <strong>how to create Linear pattern feature</strong> from SOLIDWORKS VBA Macros.</p>

<iframe src="https://www.youtube.com/embed/EphLMasYfSU" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explanation</strong> in the video.</p>

<p><strong>Explanation</strong> of each line and why we write code this way is given in <strong><em>this article</em></strong>.</p>

<p class="notice--warning">It is advisable to watch video, since it help you to better understand the process.</p>

<h2 id="code-sample">Code Sample</h2>

<p>Below is the <code class="language-plaintext highlighter-rouge">code</code> for creating <em>Linear pattern Feature</em> feature in <strong>VBA</strong> is given.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>

<span class="c1">' Variable for Solidworks Application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>

<span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>

<span class="c1">' Variable for Solidworks Linear pattern Feature</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Variable for Solidworks Selection Manager</span>
<span class="k">Dim</span> <span class="nv">swSelMgr</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectionMgr</span>

<span class="c1">' Variable for Solidworks Entity</span>
<span class="k">Dim</span> <span class="nv">swObject</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>

<span class="c1">' Variable for Solidworks Select Data</span>
<span class="k">Dim</span> <span class="nv">swSelData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectData</span>

<span class="c1">' Variable for Linear pattern feature data</span>
<span class="k">Dim</span> <span class="nv">swLinearPatternFeatureData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">LinearPatternFeatureData</span>

<span class="c1">' Main program for Linear pattern</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

  <span class="c1">' Set Solidworks Application variable to current application</span>
  <span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
  
  <span class="c1">' Check if Solidworks is opened or not</span>
  <span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks is not opened"</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Set Solidworks document variable to currently opened document</span>
  <span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
  
  <span class="c1">' Check if Solidworks document is opened or not</span>
  <span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks document is not opened. Please open a document."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Set Solidworks Selection Manager variable</span>
  <span class="k">Set</span> <span class="n">swSelMgr</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">SelectionManager</span>
  
  <span class="c1">' Array of Solidworks Entities</span>
  <span class="k">Dim</span> <span class="nv">swObjects</span><span class="p">(</span><span class="mi">1</span> <span class="k">To</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
  
  <span class="c1">' Local variable for selection</span>
  <span class="k">Dim</span> <span class="nv">selectItems</span> <span class="ow">As</span> <span class="kt">Integer</span>
  <span class="n">selectItems</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="c1">' Loop till we select all entities</span>
  <span class="k">While</span> <span class="n">selectItems</span> <span class="o">&lt;=</span> <span class="mi">3</span>
  
    <span class="c1">' Message to show user</span>
    <span class="k">Dim</span> <span class="nv">messageToUser</span> <span class="ow">As</span> <span class="kt">String</span>

    <span class="c1">' Update Messages</span>
    <span class="k">Select</span> <span class="k">Case</span> <span class="n">selectItems</span>
      <span class="k">Case</span> <span class="mi">1</span>
         <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select a Feature for Linear Pattern."</span>
      <span class="k">Case</span> <span class="mi">2</span>
         <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select first Edge for Direction 1."</span>
      <span class="k">Case</span> <span class="mi">3</span>
         <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select second Edge for Direction 2."</span>
      <span class="k">Case</span> <span class="k">Else</span>
         <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">End</span> <span class="k">Select</span>
  
    <span class="c1">' Show message to user</span>
    <span class="n">MsgBox</span> <span class="n">messageToUser</span>
    
    <span class="c1">' Loop until Solidworks Entity variable is equal to selected edge</span>
    <span class="k">While</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="ow">Is</span> <span class="k">Nothing</span>
        
      <span class="c1">' Local integer for loop</span>
      <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
      
      <span class="c1">' Looping until we select</span>
      <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectCount2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          
          <span class="c1">' Update Selection</span>
          <span class="k">Select</span> <span class="k">Case</span> <span class="n">selectItems</span>
            <span class="k">Case</span> <span class="mi">1</span>
              <span class="c1">' If the selection type body feature</span>
              <span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelBODYFEATURES</span> <span class="k">Then</span>
                  
                <span class="c1">' Set the Solidworks Entity object to feature for Linear pattern</span>
                <span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                
              <span class="c1">' If the face is selected</span>
              <span class="k">ElseIf</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelFACES</span> <span class="k">Then</span>
   
                <span class="c1">' Inform user to select feature from Feature Tree</span>
                <span class="n">MsgBox</span> <span class="s">"Please select Feature from Feature Tree."</span>
  
                <span class="c1">' Clear selection</span>
                <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
              <span class="k">End</span> <span class="k">If</span>
            <span class="k">Case</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
              <span class="c1">' If the edge is selected</span>
              <span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelEDGES</span> <span class="k">Then</span>
                  
                <span class="c1">' Set the Solidworks Entity object to selected edge</span>
                <span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">Else</span>
                <span class="c1">' Inform user to select edge</span>
                <span class="n">MsgBox</span> <span class="s">"Please select an Edge."</span>

                <span class="c1">' Clear selection</span>
                <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>                          
              <span class="k">End</span> <span class="k">If</span>
          <span class="k">End</span> <span class="k">Select</span>
      <span class="k">Next</span>
      
      <span class="n">DoEvents</span>
    <span class="k">Wend</span>
      
    <span class="c1">' Clear previous selection</span>
    <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
    
    <span class="c1">' Increase the selection count</span>
    <span class="n">selectItems</span> <span class="o">=</span> <span class="n">selectItems</span> <span class="o">+</span> <span class="mi">1</span>

  <span class="k">Wend</span>
  
  <span class="c1">' Clear previous selection</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
   
  <span class="c1">' Local variable for counter</span>
  <span class="k">Dim</span> <span class="nv">j</span> <span class="ow">As</span> <span class="kt">Integer</span>
  <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
  
  <span class="c1">' Loop till counter is 3, since we have 3 selection</span>
  <span class="k">While</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span>
  
    <span class="c1">' Set the current instance to Solidworks Entity variable</span>
    <span class="k">Set</span> <span class="n">swObject</span> <span class="o">=</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    
    <span class="c1">' Create Select data for this entity</span>
    <span class="k">Set</span> <span class="n">swSelData</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">CreateSelectData</span>
    
    <span class="c1">' Update Marking as per selected entity</span>
    <span class="k">Select</span> <span class="k">Case</span> <span class="n">j</span>
      <span class="k">Case</span> <span class="mi">1</span>
        <span class="c1">' For feature to pattern, set mark to 4</span>
        <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">Case</span> <span class="mi">2</span>
        <span class="c1">' For direction 1, set mark to 1</span>
        <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">Case</span> <span class="mi">3</span>
        <span class="c1">' For direction 1, set mark to 2</span>
        <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">End</span> <span class="k">Select</span>
    
    <span class="c1">' Select the current entity</span>
    <span class="n">swObject</span><span class="p">.</span><span class="n">Select4</span> <span class="k">True</span><span class="p">,</span> <span class="n">swSelData</span>
    
    <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
      
  <span class="k">Wend</span>
  
  <span class="c1">'-----------------------BELOW IS THE SOLUTION----------------------------------------</span>

  <span class="c1">' Local variables used as Conversion Factors</span>
  <span class="k">Dim</span> <span class="nv">LengthConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
  <span class="k">Dim</span> <span class="nv">AngleConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
  
  <span class="c1">' Use a Select Case, to get the length of active Unit and set the different factors</span>
  <span class="k">Select</span> <span class="k">Case</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">GetUnits</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1">' GetUnits function gives us, active unit</span>
    
    <span class="k">Case</span> <span class="n">swMETER</span>    <span class="c1">' If length is in Meter</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">Case</span> <span class="n">swMM</span>       <span class="c1">' If length is in MM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swCM</span>       <span class="c1">' If length is in CM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">100</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swINCHES</span>   <span class="c1">' If length is in INCHES</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swFEET</span>     <span class="c1">' If length is in FEET</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.0254</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swFEETINCHES</span>     <span class="c1">' If length is in FEET &amp; INCHES</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>  <span class="c1">' For length we use sama as Inch</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swANGSTROM</span>        <span class="c1">' If length is in ANGSTROM</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10000000000</span><span class="p">#</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swNANOMETER</span>       <span class="c1">' If length is in NANOMETER</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
    
    <span class="k">Case</span> <span class="n">swMICRON</span>       <span class="c1">' If length is in MICRON</span>
      <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000</span>
      <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
  <span class="k">End</span> <span class="k">Select</span>

  <span class="c1">'----------------------------------------------------------------</span>

  <span class="c1">'Create linear pattern feature data</span>
  <span class="k">Set</span> <span class="n">swLinearPatternFeatureData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFmLPattern</span><span class="p">)</span>
  
  <span class="c1">' Set Linear pattern feature data values</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 1"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 1"</span><span class="p">)</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2PatternSeedOnly</span> <span class="o">=</span> <span class="k">False</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 2"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 2"</span><span class="p">)</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">GeometryPattern</span> <span class="o">=</span> <span class="k">False</span>
  <span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">VarySketch</span> <span class="o">=</span> <span class="k">False</span>
  
  <span class="c1">' Create Linear pattern</span>
  <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swLinearPatternFeatureData</span><span class="p">)</span>
  
  <span class="c1">' Check if Linear Pattern creates or not</span>
  <span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Linear Pattern."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Erase array data</span>
  <span class="k">Erase</span> <span class="n">swObjects</span>
  
  <span class="c1">' View zoom to fit</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
  
  <span class="c1">' Clear all selection</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>

<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h2 id="prerequisite">Prerequisite</h2>

<p>There are some <em>prerequisite</em> for this article.</p>

<p>We are <strong>not</strong> creating feature from code but we use existing ðŸ‘‰ <strong><a href="/solidworks-macros/create-extrude-feature">Extrude</a> feature</strong> and ðŸ‘‰ <strong><a href="solidworks-macros/create-hole-from-hole-wizard/">Hole feature</a></strong> to create <strong>Linear pattern feature</strong> as shown in below picture.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/prerequisite.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/prerequisite.png" alt="prerequisite" /></a></p>

<p>As shown in above image, there are <em>1 Extrude and 1 Hole feature</em> in our part.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Extrude Feature</code> : This is our <strong>Extruded feature</strong>.</li>
  <li><code class="language-plaintext highlighter-rouge">Hole Feature</code> : This is our <strong>Hole feature</strong> for Linear pattern.</li>
</ul>

<p>If you want to create <strong>Extrude</strong> feature <em>programmatically</em> then please refer to below article.</p>

<ul>
  <li>ðŸ‘‰ <strong><a href="/solidworks-macros/create-extrude-feature">SOLIDWORKS Macros - Create Extrude/Boss</a></strong></li>
</ul>

<p>If you want to create <strong>Hole</strong> feature <em>programmatically</em> then please refer to below article.</p>

<ul>
  <li>ðŸ‘‰ <strong><a href="/solidworks-macros/create-hole-from-hole-wizard">SOLIDWORKS Macros - Create Holes from Hole Wizard</a></strong></li>
</ul>

<blockquote>
  <p>We will apply checks in this article, so the code we write should be error free most of the time.</p>
</blockquote>

<h2 id="steps-to-follow">Steps To Follow</h2>

<p>To create <strong>Linear pattern Feature</strong> there are following steps:</p>

<ol>
  <li><em>Creating Global Variables</em></li>
  <li><em>Initializing required variables</em></li>
  <li><em>Ask user to select feature and directions</em></li>
  <li><em>Mark selected entities</em></li>
  <li><em>Get unit Conversion factors</em></li>
  <li><em>Create ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern feature Definition</a></em></li>
  <li><em>Create Linear Pattern feature using ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern feature definition</a></em>.</li>
  <li><em>Final work</em></li>
</ol>

<p>Now let us walk through <strong>each step</strong> as given above, and <strong>understand</strong> every line.</p>

<blockquote>
  <p>I also give some <strong><em>links (see icon ðŸ‘‰)</em></strong> so that you can go through them if there are anything I explained in previous articles.</p>
</blockquote>

<h3 id="creating-global-variables">Creating Global Variables</h3>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>
</code></pre></div></div>

<p>This line forces us to define every variable we are going to use.</p>

<p>For more information please visit ðŸ‘‰ <strong><a href="/solidworks-macros/open-new-document">SOLIDWORKS Macros - Open new Part document</a></strong> post.</p>

<p>We create following variables.</p>

<ul>
  <li><strong>Variable for Solidworks application</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swApp</code> and the type of this <code class="language-plaintext highlighter-rouge">swApp</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks document</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swDoc</code> and the type of this <code class="language-plaintext highlighter-rouge">swDoc</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Linear pattern Feature</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Linear pattern Feature</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFeature</code> for <strong>SOLIDWORKS Linear pattern Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Selection Manager</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Selection Manager</span>
<span class="k">Dim</span> <span class="nv">swSelMgr</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectionMgr</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swSelMgr</code> and the type of this <code class="language-plaintext highlighter-rouge">swSelMgr</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SelectionMgr</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SelectionMgr</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISelectionMgr_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Entity</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Entity</span>
<span class="k">Dim</span> <span class="nv">swObject</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swObject</code> and the type of this <code class="language-plaintext highlighter-rouge">swObject</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swObject</code> for <strong>SOLIDWORKS Entities</strong> (<em>Profile and Path</em>) we ask use to select.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Select Data</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Select Data</span>
<span class="k">Dim</span> <span class="nv">swSelData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SelectData</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">swSelData</code> as <code class="language-plaintext highlighter-rouge">SldWorks.SelectData</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swSelData</code> for <strong>SOLIDWORKS Select Data</strong>, which we use for <strong>Marking</strong> selected object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SelectData</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISelectData_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Thread feature data</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Linear pattern feature data</span>
<span class="k">Dim</span> <span class="nv">swLinearPatternFeatureData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">LinearPatternFeatureData</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> and the type of this <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code> object, please visit ðŸ‘‰ <strong><a href="[ILinearPatternFeatureData Interface - 2019 - SOLIDWORKS API Help](https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html)">this page of SOLIDWORKS API Help</a></strong>.</p>

<p><strong><em>These all are our global variables.</em></strong></p>

<p>They are <strong>SOLIDWORKS API Objects</strong>.</p>

<p>So basically I group all the <strong>SOLIDWORKS API Objects</strong> in one place.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Main program for Linear pattern</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<p>Next is our <code class="language-plaintext highlighter-rouge">Sub</code> procedure which has name of <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p>This procedure hold all the <em>statements (instructions)</em> we give to computer.</p>

<p>To know more about <strong>Sub Procedure</strong> you can check ðŸ‘‰ <strong><a href="/vba/sub-and-function-procedure/">VBA Sub and Function Procedures</a></strong> article of this website.</p>

<h3 id="initializing-required-variables">Initializing Required Variables</h3>

<p>Inside this procedure we first initialize required variables as given below.</p>

<ul>
  <li><em>Set SOLIDWORKS variable to SOLIDWORKS application</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS variable to SOLIDWORKS application</span>
<span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we set the value of our SOLIDWORKS variable <code class="language-plaintext highlighter-rouge">swApp</code>; which we define earlier; to SOLIDWORKS application.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS is opened or not</span>
<span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS is not opened"</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS application variable is <em>successfully assigned</em> to current SOLIDWORKS application.</p>

<ul>
  <li><em>Set SOLIDWORKS document variable to opened part document</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS document variable to opened part document</span>
<span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> variable to currently open part document.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS document is opened or not</span>
<span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS document is not opened. Please open a document."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> is opened.</p>

<p>If SOLIDWORKS document is not opened then code execute inside the code and inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<ul>
  <li><em>Set SOLIDWORKS Selection Manager variable</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS Selection Manager variable</span>
<span class="k">Set</span> <span class="n">swSelMgr</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">SelectionManager</span>
</code></pre></div></div>

<p>In above line, we set SOLIDWORKS Selection Manager<code class="language-plaintext highlighter-rouge">swSelMgr</code> variable to current documentâ€™s Selection Manager.</p>

<ul>
  <li>Array of SOLIDWORKS Entities</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Array of Solidworks Entities</span>
<span class="k">Dim</span> <span class="nv">swObjects</span><span class="p">(</span><span class="mi">1</span> <span class="k">To</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
</code></pre></div></div>

<p>In this line, we create an Array of SOLIDWORKS Entities which we named as <code class="language-plaintext highlighter-rouge">swObjects</code> and the type of this <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code>.</p>

<p>This array consist <em>two</em> <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code> variables.</p>

<p>We define the number of variable this array holds inside <strong>(1 To 3)</strong>.</p>

<p>For more information about the <strong>Arrays</strong> in VBA please ðŸ‘‰ <strong><a href="/vba/arrays/">Array on this website</a></strong>.</p>

<ul>
  <li><em>Local variable for User selection</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Local variable for selection</span>
<span class="k">Dim</span> <span class="nv">selectItems</span> <span class="ow">As</span> <span class="kt">Integer</span>
<span class="n">selectItems</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>In above line of code, we define a Local variable name <code class="language-plaintext highlighter-rouge">selectItems</code>as <strong>Integer</strong> type.</p>

<p>In next line we assign a value of <strong>1</strong>.</p>

<h3 id="ask-user-to-select-feature-and-directions">Ask user to select feature and directions</h3>

<p>Now we will ask user to select <strong>feature and directions</strong> for <em>Linear Pattern feature</em>.</p>

<p>Please follow steps given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop till we select all entities</span>
<span class="k">While</span> <span class="n">selectItems</span> <span class="o">&lt;=</span> <span class="mi">3</span>

<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code we start a <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>For more details about <code class="language-plaintext highlighter-rouge">While</code> loop, please see ðŸ‘‰ <strong><a href="/vba/looping/">VBA Looping</a></strong> article from this website.</p>

<p>We want to loop until <code class="language-plaintext highlighter-rouge">selectItems</code> variableâ€™s value is equal to <strong>3</strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Message to show user</span>
<span class="k">Dim</span> <span class="nv">messageToUser</span> <span class="ow">As</span> <span class="kt">String</span>
</code></pre></div></div>

<p>In above line of code we create a variable named <code class="language-plaintext highlighter-rouge">messageToUser</code> of <code class="language-plaintext highlighter-rouge">String</code> type.</p>

<p>This variable holds the message we want to show before selection.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Update Messages</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">selectItems</span>
  <span class="k">Case</span> <span class="mi">1</span>
    <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select a Feature for Linear Pattern."</span>
  <span class="k">Case</span> <span class="mi">2</span>
    <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select first Edge for Direction 1."</span>
  <span class="k">Case</span> <span class="mi">3</span>
    <span class="n">messageToUser</span> <span class="o">=</span> <span class="s">"Please select second Edge for Direction 2."</span>
  <span class="k">Case</span> <span class="k">Else</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Select</span>
</code></pre></div></div>

<p>In above line of code, we use a <code class="language-plaintext highlighter-rouge">Select</code> statement to update message.</p>

<p>We use the <code class="language-plaintext highlighter-rouge">case</code> on <code class="language-plaintext highlighter-rouge">selectItems</code>.</p>

<p>When <code class="language-plaintext highlighter-rouge">selectItems = 1</code> then value of <code class="language-plaintext highlighter-rouge">messageToUser</code> update to <code class="language-plaintext highlighter-rouge">"Please select a Feature for Linear Pattern."</code></p>

<p>When <code class="language-plaintext highlighter-rouge">selectItems = 2</code> then value of <code class="language-plaintext highlighter-rouge">messageToUser</code> update to <code class="language-plaintext highlighter-rouge">"Please select first Edge for Direction 1."</code></p>

<p>Similarly, when <code class="language-plaintext highlighter-rouge">selectItems = 3</code> then value of <code class="language-plaintext highlighter-rouge">messageToUser</code> upda te to <code class="language-plaintext highlighter-rouge">"Please select second Edge for Direction 2."</code></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Show message to user</span>
<span class="n">MsgBox</span> <span class="n">messageToUser</span>
</code></pre></div></div>

<p>In above line of code, we show the message to user.</p>

<p>Below image shows the message for <strong>Feature selection</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-feature-for-linear-pattern.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-feature-for-linear-pattern.png" alt="message-to-select-feature-for-linear-pattern" /></a></p>

<p>Below image shows the message for <strong>first Edge for Direction 1</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-edge-for-direction-1.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-edge-for-direction-1.png" alt="message-to-select-edge-for-direction-1" /></a></p>

<p>Below image shows the message for <strong>second Edge for Direction 2</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-edge-for-direction-2.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-edge-for-direction-2.png" alt="message-to-select-edge-for-direction-2" /></a></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop until we complete our selection</span>
<span class="k">While</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="ow">Is</span> <span class="k">Nothing</span>
    
<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code, we create another <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>This loops until we select the our <strong>Profile</strong> and <strong>Path</strong>.</p>

<p>For more details about <code class="language-plaintext highlighter-rouge">While</code> loop, please see ðŸ‘‰ <strong><a href="/vba/looping/">VBA Looping</a></strong> article from this website.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Local integer for loop</span>
<span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
</code></pre></div></div>

<p>In above line of code, we create a local integer name <code class="language-plaintext highlighter-rouge">i</code> as a counter.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop until we select</span>
<span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectCount2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">Next</span>
</code></pre></div></div>

<p>In above line of code, we create a <code class="language-plaintext highlighter-rouge">For</code> loop.</p>

<p>This code loops from <code class="language-plaintext highlighter-rouge">i = 1</code> to number of <code class="language-plaintext highlighter-rouge">objects</code> we select.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Update Messages</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">selectItems</span>

<span class="k">End</span> <span class="k">Select</span>
</code></pre></div></div>

<p>In above line of code, we use a <code class="language-plaintext highlighter-rouge">Select</code> statement for selection entities.</p>

<p>We use the <code class="language-plaintext highlighter-rouge">case</code> on <code class="language-plaintext highlighter-rouge">selectItems</code>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Case</span> <span class="mi">1</span>
	<span class="c1">' If the profile sketch is selected</span>
  <span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelBODYFEATURES</span> <span class="k">Then</span>

    <span class="c1">' Set the Solidworks Entity object to feature for Linear pattern</span>
    <span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">' If the face is selected</span>
  <span class="k">ElseIf</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelFACES</span> <span class="k">Then</span>

    <span class="c1">' Inform user to select feature from Feature Tree</span>
    <span class="n">MsgBox</span> <span class="s">"Please select Feature from Feature Tree."</span>

    <span class="c1">' Clear selection</span>
    <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
  <span class="k">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>Above code sample we use for <strong><code class="language-plaintext highlighter-rouge">Case 1</code></strong>.</p>

<p>In above line of code, we use  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF/Else statement</a></strong>  with conditions.</p>

<p>The  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong>  is <code class="language-plaintext highlighter-rouge">True</code> when selected <code class="language-plaintext highlighter-rouge">object</code> is type of <em>SOLIDWORKS Body Feature</em>.</p>

<p>Similarly,  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">Else statement</a></strong>  is True when select <code class="language-plaintext highlighter-rouge">object</code> is type of <em>SOLIDWORKS Face</em>.</p>

<p class="notice">When we select the sketch from Model view, then selected object is <em>SOLIDWORKS Face</em>.
<br />
When we select the sketch from Feature Tree, then select object is <em>SOLIDWORKS Body Feature</em>.</p>

<p>When  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> is True we execute code given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set the Solidworks Entity object to feature for Linear pattern</span>
<span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line, we set the indexed object inside array.</p>

<ul>
  <li><em>Array of SOLIDWORKS Entities</em> = <code class="language-plaintext highlighter-rouge">swObjects</code></li>
  <li><em>Indexed Entity Object</em> = <code class="language-plaintext highlighter-rouge">swObjects[selectItems]</code></li>
</ul>

<p>We set the value of this <strong>Indexed Entity Object</strong> by <code class="language-plaintext highlighter-rouge">GetSelectedObject6()</code> method of SOLIDWORKS Selection Manager.</p>

<p>When we set the <strong>Indexed Entity Object</strong> value as <strong>feature to mirror</strong>, we exit the 2nd <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>Similarly, when  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">Else statement</a></strong> is True we execute code given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Inform user to select feature from Feature Tree</span>
<span class="n">MsgBox</span> <span class="s">"Please select feature from Feature Tree."</span>

<span class="c1">' Clear selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<ol>
  <li>We show message to user to select <strong>Feature</strong> from <em>Feature Tree</em>.</li>
  <li>After that we clear our selection.</li>
</ol>

<blockquote>
  <p>We do this because if selected object type is <em>SOLIDWORKS Face</em> then we can not assign this object as SOLIDWORKS Entity inside array.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Case</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
  <span class="c1">' If the edge is selected</span>
  <span class="k">If</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObjectType3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelectType_e</span><span class="p">.</span><span class="n">swSelEDGES</span> <span class="k">Then</span>
  
    <span class="c1">' Set the Solidworks Entity object to selected edge</span>
    <span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">Else</span>
    <span class="c1">' Inform user to select edge</span>
    <span class="n">MsgBox</span> <span class="s">"Please select a Edge."</span>

    <span class="c1">' Clear selection</span>
    <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
  <span class="k">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>Above code sample we use for <strong><code class="language-plaintext highlighter-rouge">Case 2</code></strong> and <strong><code class="language-plaintext highlighter-rouge">Case 3</code></strong>.</p>

<p>In above line of code, we use  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF/Else statement</a></strong>  with conditions.</p>

<p>The  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong>  is <code class="language-plaintext highlighter-rouge">True</code> when selected <code class="language-plaintext highlighter-rouge">object</code> is type of <em>SOLIDWORKS Edge</em>.</p>

<p>If we the selected <code class="language-plaintext highlighter-rouge">object</code> is <strong>not</strong> type of <em>SOLIDWORKS Edge</em> then ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">Else statement</a></strong> code runs.</p>

<p>When  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> is True we execute code given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set the Solidworks Entity object to selected Edge</span>
<span class="k">Set</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">selectItems</span><span class="p">)</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">GetSelectedObject6</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line, we set the indexed object inside array.</p>

<ul>
  <li><em>Array of SOLIDWORKS Entities</em> = <code class="language-plaintext highlighter-rouge">swObjects</code></li>
  <li><em>Indexed Entity Object</em> = <code class="language-plaintext highlighter-rouge">swObjects[selectItems]</code></li>
</ul>

<p>We set the value of this <strong>Indexed Entity Object</strong> by <code class="language-plaintext highlighter-rouge">GetSelectedObject6()</code> method of SOLIDWORKS Selection Manager.</p>

<p>When we set the <strong>Indexed Entity Object</strong> value as <strong>feature to mirror</strong>, we exit the 2nd <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>Similarly, when  ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">Else statement</a></strong> is True we execute code given below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Inform user to select edge</span>
<span class="n">MsgBox</span> <span class="s">"Please select a Edge."</span>

<span class="c1">' Clear selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<ol>
  <li>We show message to user to select <strong>Edge</strong>.</li>
  <li>After that we clear our selection.</li>
</ol>

<p>After <code class="language-plaintext highlighter-rouge">For</code> loop, we have a call for <strong><code class="language-plaintext highlighter-rouge">DoEvents</code></strong> function.</p>

<p>This function repeats the <code class="language-plaintext highlighter-rouge">While</code> loop until we select the <strong>Feature or Edge</strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Clear previous selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>

<span class="c1">' Increase the selection count</span>
<span class="n">selectItems</span> <span class="o">=</span> <span class="n">selectItems</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></div>

<p>In above line, when we finished with the <strong>Profile or Path</strong> selection, we clear previous selection and increment the selected count by 1.</p>

<p>After increment the selected count we continue our <code class="language-plaintext highlighter-rouge">while</code> loop.</p>

<h3 id="mark-selected-entities">Mark selected Entities</h3>

<p>Till now we have completed our selection.</p>

<p>Now we need to do <strong>Select and Mark entities</strong> correctly from our Array.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Local variable for counter</span>
<span class="k">Dim</span> <span class="nv">j</span> <span class="ow">As</span> <span class="kt">Integer</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>In above line of code we create <code class="language-plaintext highlighter-rouge">integer</code> variable for counter.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop till counter is 3, since we have 3 selection</span>
<span class="k">While</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span>

<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code we create a <code class="language-plaintext highlighter-rouge">while</code> loop with condition that <em>counter value</em> of <strong><code class="language-plaintext highlighter-rouge">j</code></strong> should be <em>less than 4.</em></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set the current instance to Solidworks Entity variable</span>
<span class="k">Set</span> <span class="n">swObject</span> <span class="o">=</span> <span class="n">swObjects</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code, we set the SOLIDWORKS Entity variable to current object from array.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Select data for this entity</span>
<span class="k">Set</span> <span class="n">swSelData</span> <span class="o">=</span> <span class="n">swSelMgr</span><span class="p">.</span><span class="n">CreateSelectData</span>
</code></pre></div></div>

<p>In above line of code, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Update Messages</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">j</span>

<span class="k">End</span> <span class="k">Select</span>
</code></pre></div></div>

<p>In above line of code, we use a <code class="language-plaintext highlighter-rouge">Select</code> statement for selection entities.</p>

<p>We use the <code class="language-plaintext highlighter-rouge">case</code> on <code class="language-plaintext highlighter-rouge">j</code>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Case</span> <span class="mi">1</span>
  <span class="c1">' For feature to pattern, set mark to 4</span>
  <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div></div>

<p>Above code sample we use for <strong><code class="language-plaintext highlighter-rouge">Case 1</code></strong>.</p>

<p>In above lines, we update the <strong>Mark</strong> to <strong><code class="language-plaintext highlighter-rouge">4</code></strong> for our <em>SOLIDWORKS Select Data</em> variable.</p>

<p>For <strong><em>Linear Pattern</em></strong> feature, <strong><code class="language-plaintext highlighter-rouge">Mark</code></strong> values can be follows:</p>

<table>
  <thead>
    <tr>
      <th>Anyâ€¦</th>
      <th>Must be preselected and marked with a value ofâ€¦</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Direction 1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Direction 2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Feature to pattern</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<p>For more details about <strong>Mark</strong> please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern Feature</a></strong> in <em>SOLIDWORS API Help</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Case</span> <span class="mi">2</span>
  <span class="c1">' For direction 1, set mark to 1</span>
  <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>Above code sample we use for <strong><code class="language-plaintext highlighter-rouge">Case 2</code></strong>.</p>

<p>In above lines, we update the <strong>Mark</strong> to <strong><code class="language-plaintext highlighter-rouge">1</code></strong> for our <em>SOLIDWORKS Select Data</em> variable.</p>

<p>For <strong><em>Linear Pattern</em></strong> feature, <strong><code class="language-plaintext highlighter-rouge">Mark</code></strong> values can be follows:</p>

<table>
  <thead>
    <tr>
      <th>Anyâ€¦</th>
      <th>Must be preselected and marked with a value ofâ€¦</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Direction 1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Direction 2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Feature to pattern</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<p>For more details about <strong>Mark</strong> please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern Feature</a></strong> in <em>SOLIDWORS API Help</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Case</span> <span class="mi">3</span>
  <span class="c1">' For plane, set mark to 2</span>
  <span class="n">swSelData</span><span class="p">.</span><span class="n">Mark</span> <span class="o">=</span> <span class="mi">2</span>	
</code></pre></div></div>

<p>Above code sample we use for <strong><code class="language-plaintext highlighter-rouge">Case 3</code></strong>.</p>

<p>In above lines, we update the <strong>Mark</strong> to <strong><code class="language-plaintext highlighter-rouge">3</code></strong> for our <em>SOLIDWORKS Select Data</em> variable.</p>

<p>For <strong><em>Linear Pattern</em></strong> feature, <strong><code class="language-plaintext highlighter-rouge">Mark</code></strong> values can be follows:</p>

<table>
  <thead>
    <tr>
      <th>Anyâ€¦</th>
      <th>Must be preselected and marked with a value ofâ€¦</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Direction 1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Direction 2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Feature to pattern</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<p>For more details about <strong>Mark</strong> please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern Feature</a></strong> in <em>SOLIDWORS API Help</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Select the current entity</span>
<span class="n">swObject</span><span class="p">.</span><span class="n">Select4</span> <span class="k">True</span><span class="p">,</span> <span class="n">swSelData</span>
</code></pre></div></div>

<p>In above line of code, we select the Feature object.</p>

<p>We select it by using <code class="language-plaintext highlighter-rouge">Select4</code> method of <em>SOLIDWORKS Entity object</em>.</p>

<p>This method takes 2 arguments.</p>

<ol>
  <li><strong>Append</strong> - <em><code class="language-plaintext highlighter-rouge">True</code> appends the entity to the selection list, <code class="language-plaintext highlighter-rouge">False</code> replaces the selection list with this entity.</em></li>
  <li><strong>Data</strong> - <em>Pointer to the <strong><code class="language-plaintext highlighter-rouge">ISelectData</code></strong> object.</em></li>
</ol>

<p>We use following values as parameter.</p>

<ol>
  <li><strong>Append</strong> - <strong><code class="language-plaintext highlighter-rouge">True</code></strong></li>
  <li><strong>Data</strong> - <strong><code class="language-plaintext highlighter-rouge">swSelData</code></strong></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></div>

<p>After <strong><code class="language-plaintext highlighter-rouge">Select</code></strong> statement, we increment the counter variable <strong><code class="language-plaintext highlighter-rouge">j</code></strong> by <strong>1</strong>.</p>

<h3 id="get-unit-conversion-factors">Get unit Conversion factors</h3>

<p>Now we need to get unit Conversion factors as shown in below code.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">'-----------------------Unit Conversion Factors----------------------------------------</span>
  
<span class="c1">' Local variables used as Conversion Factors</span>
<span class="k">Dim</span> <span class="nv">LengthConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>
<span class="k">Dim</span> <span class="nv">AngleConversionFactor</span> <span class="ow">As</span> <span class="kt">Double</span>

<span class="c1">' Use a Select Case, to get the length of active Unit and set the different factors</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">GetUnits</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1">' GetUnits function gives us, active unit</span>

<span class="k">Case</span> <span class="n">swMETER</span>    <span class="c1">' If length is in Meter</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">Case</span> <span class="n">swMM</span>       <span class="c1">' If length is in MM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swCM</span>       <span class="c1">' If length is in CM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">100</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swINCHES</span>   <span class="c1">' If length is in INCHES</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swFEET</span>     <span class="c1">' If length is in FEET</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.0254</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swFEETINCHES</span>     <span class="c1">' If length is in FEET &amp; INCHES</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.0254</span>  <span class="c1">' For length we use sama as Inch</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swANGSTROM</span>        <span class="c1">' If length is in ANGSTROM</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10000000000</span><span class="p">#</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swNANOMETER</span>       <span class="c1">' If length is in NANOMETER</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>

<span class="k">Case</span> <span class="n">swMICRON</span>       <span class="c1">' If length is in MICRON</span>
  <span class="n">LengthConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000000</span>
  <span class="n">AngleConversionFactor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">0.01745329</span>
<span class="k">End</span> <span class="k">Select</span>

<span class="c1">'----------------------------------------------------------------</span>
</code></pre></div></div>

<p>I have already explained about this in previous ðŸ‘‰ <strong><a href="/solidworks-macros/unit-correction/">Solidworks Macro - Fix Unit Issue</a></strong> article in this website.</p>

<p>Please visit ðŸ‘‰ <strong><a href="/solidworks-macros/unit-correction/">Solidworks Macro - Fix Unit Issue</a></strong> article for more details.</p>

<h3 id="create-linear-pattern-feature-definition">Create Linear Pattern Feature Definition</h3>

<p>We have completed our <em>selection</em> of ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">SOLIDWORKS Entity</a></strong>.</p>

<p>Now we create  ðŸ‘‰ <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData.html">Linear Pattern feature Definition</a> and set its properties for <strong>Linear Pattern</strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">'Create linear pattern feature data</span>
<span class="k">Set</span> <span class="n">swLinearPatternFeatureData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFmLPattern</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData</code> by <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method.</p>

<p><code class="language-plaintext highlighter-rouge">CreateDefinition</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method takes following parameters as explained:</p>

<ul>
  <li>
    <p><strong>Type</strong> - <em><code class="language-plaintext highlighter-rouge">Feature name ID</code> as defined in <code class="language-plaintext highlighter-rouge">swFeatureNameID_e</code></em>.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">swFmBoundingBox</code> <em>(bounding box)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCirPattern</code> <em>(circular pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCurvePattern</code> <em>(curve-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDerivedLPattern</code> <em>(derived-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDimPattern</code> <em>(variable/dimension pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmFillPattern</code> <em>(fill pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmGroundPlane</code> <em>(ground plane)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLibraryFeature</code> <em>(library)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalChainPattern</code> <em>(chain component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCirPattern</code> <em>(circular component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCurvePattern</code> <em>(curve-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalLPattern</code> <em>(linear component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalSketchPattern</code> <em>(sketch-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLPattern</code> <em>(linear pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmNormalCut</code> <em>(sheet metal normal cut)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefCurve</code> <em>(projection curve)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefSurface</code> <em>(surface sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSketchPattern</code> <em>(sketch-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweep</code> <em>(boss sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepCut</code> <em>(cut sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepThread</code> <em>(Thread)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTabAndSlot</code> <em>(tab and slot)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTablePattern</code> <em>(table pattern)</em></li>
    </ul>
  </li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method return <strong>feature or pattern-specific</strong> feature data object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>Type</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swFmLPattern</code> as <code class="language-plaintext highlighter-rouge">Feature name ID</code></em>.</li>
</ul>

<p>If you want to know more information about <strong>Linear Pattern Feature data</strong> then please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>This page will give you information about various properties and methods of <code class="language-plaintext highlighter-rouge">ILinearPatternFeatureData</code> Interface.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Linear pattern feature data values</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 1"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 1"</span><span class="p">)</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2PatternSeedOnly</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 2"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 2"</span><span class="p">)</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">GeometryPattern</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">VarySketch</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above lines, we set various properties of Linear Pattern feature definition.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
</code></pre></div></div>

<p>In above line of code we set how to specify the spacing of pattern instances for <strong>Direction 1</strong> as defined in below table.</p>

<table>
  <thead>
    <tr>
      <th>Member</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">swPatternEndCondition_SpacingAndInstances</code></strong></td>
      <td><strong><code class="language-plaintext highlighter-rouge">0</code></strong> = Independently set the pattern instance number and spacing</td>
    </tr>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">swPatternEndCondition_UpToReference</code></strong></td>
      <td><strong><code class="language-plaintext highlighter-rouge">1</code></strong> = Pattern instance number and spacing is based on a selected up-to-reference geometry and an offset</td>
    </tr>
  </tbody>
</table>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above line code code, we set value of <code class="language-plaintext highlighter-rouge">D1ReverseDirection</code> to <code class="language-plaintext highlighter-rouge">False</code>.</p>

<p>This means we did not want to reverse direction 1.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 1"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
</code></pre></div></div>

<p>In above line of code we are doing <strong>3 steps</strong> in one line.</p>

<p>Those 3 steps are explained below.</p>

<ul>
  <li><strong>Step 1</strong> - Getting direction 1 spacing from user.</li>
</ul>

<p>Below image shows the message for <strong>direction 1 spacing</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-spacing-for-direction-1.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-spacing-for-direction-1.png" alt="message-to-select-spacing-for-direction-1" /></a></p>

<ul>
  <li><strong>Step 2</strong> - Convert input spacing as per document unit system.</li>
  <li><strong>Step 3</strong> - Assigned converted value to <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D1Spacing</code></strong> property.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D1Spacing</code></strong> property gets or sets the spacing between pattern instances in Direction 1 of this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D1TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 1"</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we are doing <strong>2 steps</strong> in one line.</p>

<p>Those 2 steps are explained below.</p>

<ul>
  <li><strong>Step 1</strong> - Getting number of instances in direction 1 from user.</li>
</ul>

<p>Below image shows the message for <strong>number of instances 1 spacing</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-number-of-instance-for-direction-1.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-number-of-instance-for-direction-1.png" alt="message-to-select-number-of-instance-for-direction-1" /></a></p>

<ul>
  <li><strong>Step 2</strong> - Assigned input value to <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D1TotalInstances</code></strong> property.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D1TotalInstances</code></strong> property gets or sets the total number of pattern instances in Direction 1 for this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
</code></pre></div></div>

<p>In above line of code we set how to specify the spacing of pattern instances for <strong>Direction 2</strong> as defined in below table.</p>

<table>
  <thead>
    <tr>
      <th>Member</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">swPatternEndCondition_SpacingAndInstances</code></strong></td>
      <td><strong><code class="language-plaintext highlighter-rouge">0</code></strong> = Independently set the pattern instance number and spacing</td>
    </tr>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">swPatternEndCondition_UpToReference</code></strong></td>
      <td><strong><code class="language-plaintext highlighter-rouge">1</code></strong> = Pattern instance number and spacing is based on a selected up-to-reference geometry and an offset</td>
    </tr>
  </tbody>
</table>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2PatternSeedOnly</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above line code code, we set value of <strong><code class="language-plaintext highlighter-rouge">D2PatternSeedOnly</code></strong> to <code class="language-plaintext highlighter-rouge">False</code>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2PatternSeedOnly</code></strong> property gets or sets whether to create a pattern in Direction 2 using the seed features only.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2EndCondition</span> <span class="o">=</span> <span class="n">swPatternEndCondition_e</span><span class="p">.</span><span class="n">swPatternEndCondition_SpacingAndInstances</span>
</code></pre></div></div>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2ReverseDirection</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above line code code, we set value of <strong><code class="language-plaintext highlighter-rouge">D2ReverseDirection</code></strong> to <code class="language-plaintext highlighter-rouge">False</code>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2ReverseDirection</code></strong> property gets or sets whether to reverse Direction 2 in this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2Spacing</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Please select spacing in direction 2"</span><span class="p">)</span> <span class="o">*</span> <span class="n">LengthConversionFactor</span>
</code></pre></div></div>

<p>In above line of code we are doing <strong>3 steps</strong> in one line.</p>

<p>Those 3 steps are explained below.</p>

<ul>
  <li><strong>Step 1</strong> - Getting direction 1 spacing from user.</li>
</ul>

<p>Below image shows the message for <strong>direction 2 spacing</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-spacing-for-direction-2.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-spacing-for-direction-2.png" alt="message-to-select-spacing-for-direction-2" /></a></p>

<ul>
  <li><strong>Step 2</strong> - Convert input spacing as per document unit system.</li>
  <li><strong>Step 3</strong> - Assigned converted value to <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2Spacing</code></strong> property.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2Spacing</code></strong> property gets or sets the spacing between pattern instances in Direction 2 of this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">D2TotalInstances</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Number of instances in direction 2"</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we are doing <strong>2 steps</strong> in one line.</p>

<p>Those 2 steps are explained below.</p>

<ul>
  <li><strong>Step 1</strong> - Getting number of instances in direction 2 from user.</li>
</ul>

<p>Below image shows the message for <strong>number of instances 2 spacing</strong> to the user.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-number-of-instance-for-direction-2.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/message-to-select-number-of-instance-for-direction-2.png" alt="message-to-select-number-of-instance-for-direction-2" /></a></p>

<ul>
  <li><strong>Step 2</strong> - Assigned input value to <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2TotalInstances</code></strong> property.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.D2TotalInstances</code></strong> property gets or sets the total number of pattern instances in <em>Direction 2</em> for this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">GeometryPattern</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above line code we set the value of <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.GeometryPattern</code></strong> to <strong><code class="language-plaintext highlighter-rouge">False</code></strong>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.GeometryPattern</code></strong> property gets or sets <strong>Geometry Pattern</strong> option for this linear pattern feature.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">swLinearPatternFeatureData</span><span class="p">.</span><span class="n">VarySketch</span> <span class="o">=</span> <span class="k">False</span>
</code></pre></div></div>

<p>In above line code we set the value of <strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.VarySketch</code></strong> to <strong><code class="language-plaintext highlighter-rouge">False</code></strong>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData.VarySketch</code></strong> property gets or sets whether to allow the pattern to vary as it repeats in this linear pattern feature.</p>

<h3 id="create-linear-pattern">Create Linear Pattern</h3>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Linear pattern</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swLinearPatternFeatureData</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swFeature</code> by <code class="language-plaintext highlighter-rouge">CreateFeature</code> method.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method takes following parameters as explained:</p>

<ul>
  <li><strong>FeatureData</strong> - <em><code class="language-plaintext highlighter-rouge">Feature or pattern-specific</code> feature data object</em>.</li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method return <strong>feature</strong> data object.</p>

<p><code class="language-plaintext highlighter-rouge">CreateFeature</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>FeatureData</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swLinearPatternFeatureData</code> as feature data object which we defined previously</em>.</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Linear Pattern creates or not</span>
<span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Linear Pattern."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an ðŸ‘‰ <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we able to create ðŸ‘‰ <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ILinearPatternFeatureData_members.html">Linear Pattern Feature</a></strong> or not.</p>

<p>If we failed to select then inform the user by a ðŸ‘‰ <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<p>After showing error message our program <strong>exit</strong> from here itself.</p>

<p>Now we run the macro and after running macro we get Revolve as shown in below image.</p>

<p><a href="/assets/Solidworks_Images/feature-linear-pattern/linear-pattern-final-result.png"><img src="/assets/Solidworks_Images/feature-linear-pattern/linear-pattern-final-result.png" alt="linear-pattern-final-result" /></a></p>

<h3 id="final-work">Final work</h3>

<p>After creating <strong>Linear Pattern</strong> feature, we have to do some cleaning work so that we can use this macro frequently.</p>

<ul>
  <li>Empty SOLIDWORKS Entity Array</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Erase array data</span>
<span class="k">Erase</span> <span class="n">swObjects</span>
</code></pre></div></div>

<p>In above line, we <strong>erase</strong> data from <em>SOLIDWORKS Entity array</em>.</p>

<p>For this we use <strong><code class="language-plaintext highlighter-rouge">Erase</code></strong> function in-build in VBA.</p>

<ul>
  <li>Make part Zoom to fit</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' View zoom to fit</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
</code></pre></div></div>

<p>In above line, we make our view zoom to fit the model.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ViewZoomtofit2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<ul>
  <li>Clear selection</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Clear all selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<p>In above line, we clear all previous selection.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ClearSelection2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<p><strong>This is it !!!</strong></p>

<p><em>I hope my efforts will helpful to someone!</em></p>

<p>If you found anything to <strong>add or update</strong>, please let me know on my <em>e-mail</em>.</p>

<p>Hope this post helps you to <strong>create Linear Pattern feature</strong> with SOLIDWORKS VBA Macros.</p>

<p>For more such tutorials on <strong>SOLIDWORKS VBA Macro</strong>, do come to this blog after sometime.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not!</em></p>

<p><em>Till then, Happy learning!!!</em></p>

        </div>
        
        <div>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Top and Bottom placed Ad -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8158659264340002"
       data-ad-slot="6644001766"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-04-10T14:47:25-04:00">April 10, 2022</time></p>


      </footer>

      
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    
    <li class="page-item mr-5">
      <a class="btn btn-primary text-light" href="/solidworks-macros/create-mirror/" title="SOLIDWORKS Macro - Create Mirror
">â® Previous</a>
    </li>
    
    
    <li class="page-item ml-5">
      <a class="btn btn-primary text-light" href="/solidworks-vba-macros/create-circular-patterns/" title="Solidworks VBA Macro - Create Circular Pattern
">Next â¯</a>
    </li>
    
  </ul>
</nav>

    </div>
  </article>

</div>
      </div>
    </div>
  </div>

  <div id="footer" class="page__footer">
    <footer>
      <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
      <footer class="bd-footer py-5 bg-light">
  <div class="container">
    <div class="row">
      <div class="col-6">
        <a class="d-inline-flex align-items-center mb-2 link-dark" href="/" aria-label="Bootstrap">
          <img src="/assets/logo.png" width="30" height="30" class="img-fluid mr-2" alt="">
          <span> The CAD Coder</span>
        </a>
        <ul class="list-unstyled small text-muted">
          <li class="mb-2">Programming Tutorials for SOLIDWORKS 3D CAD Software.</li>
          <li class="mb-2">Copyright Â© 2022 The CAD Coder</li>
          <li class="mb-2">Built with <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a>.</li>

          
            
              
            
              
              <li class="list-inline-item"><a href="https://facebook.com/thecadcoder" target="_blank" title="Facebook"><i
                class="fab fa-2x fa-facebook-f"></i></a></li>
              
            
              
            
              
            
              
            
              
            
              
              <li class="list-inline-item"><a href="https://www.youtube.com/channel/UCm_VglqA2S4WUXM55vyqAFg" target="_blank" title="YouTube"><i
                class="fab fa-2x fa-youtube"></i></a></li>
              
            
              
              <li class="list-inline-item"><a href="mailto:thecadcoder@gmail.com" target="_blank" title="Email"><i
                class="fa fa-envelope fa-2x"></i></a></li>
              
            
          
        </ul>
      </div>
      <div class="col-6">
        <h5>Links</h5>
        <ul class="list-unstyled">
          <!-- <li class="mb-2"><a href="/">Home</a></li> -->
          <li class="mb-2"><a href="/aboutMe/">About</a></li>
          <li class="mb-2"><a href="/resources/">Resources</a></li>
          <li class="mb-2"><a href="/Disclaimer/">Privacy Policy</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
    </footer>
  </div>

  
  <script src="/assets/js/main.min.js"></script>


<script>
  (function () {
    var cx = '4b2b9cb8c831ee0fb';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
    $(document).ready(function () {
      $('input#cse-search-input-box-id').on('keyup', function () {
        googleCustomSearchExecute();
      });
    });
  
</script>







  <!-- Optional JavaScript; choose one of the two! -->

  <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
    crossorigin="anonymous"></script>

  <!-- Option 2: Separate Popper and Bootstrap JS -->
  <!--
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
    -->

  
  <script src="/assets/js/main.min.js"></script>


<script>
  (function () {
    var cx = '4b2b9cb8c831ee0fb';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
    $(document).ready(function () {
      $('input#cse-search-input-box-id').on('keyup', function () {
        googleCustomSearchExecute();
      });
    });
  
</script>






</body>

</html>
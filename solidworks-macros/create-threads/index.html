<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- begin _includes/seo.html --><title>SOLIDWORKS Macro - Create Threads - The CAD Coder</title>
<meta name="description" content="This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.   If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.   But from this post onward we will take user-inputs.   In this article we did not use 🚀 UserForm for taking inputs, instead we use 🚀 Input Box for value input and 🚀 Message Box to notify user.   I hope you will also like this type of tutorials.   Thank you for reading.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="The CAD Coder">
<meta property="og:title" content="SOLIDWORKS Macro - Create Threads">
<meta property="og:url" content="http://localhost:4000/solidworks-macros/create-threads/">


  <meta property="og:description" content="This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.   If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.   But from this post onward we will take user-inputs.   In this article we did not use 🚀 UserForm for taking inputs, instead we use 🚀 Input Box for value input and 🚀 Message Box to notify user.   I hope you will also like this type of tutorials.   Thank you for reading.">







  <meta property="article:published_time" content="2022-09-27T15:07:36-04:00">






<link rel="canonical" href="http://localhost:4000/solidworks-macros/create-threads/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117501871-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117501871-2', { 'anonymize_ip': true});
</script>

<!-- end _includes/seo.html -->

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
    integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo.png">
  <link
    href="/feed.xml"
    type="application/atom+xml" rel="alternate" title="The CAD Coder Feed">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">

  <meta name="google-site-verification" content="OeSBbUv_kXDkDxaeoLixjE1BYxlbQRINt58H1UGbSMY" />

  
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="/">
        <img src="/assets/logo.png" width="30" height="30" class="img-fluid" alt="">
        <span>The CAD Coder</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a  class="nav-link"   href="/vba/vba-Introduction/"><span>VBA</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="active nav-link" style="border-bottom: 1px solid #fff;"   href="/Solidworks-macro-guide/"><span>Solidworks VBA Macro</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/Solidworks-csharp-api-tutorials/"><span>Solidworks C# API</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/Solidworks-cpp-api-tutorials/"><span>Solidworks C++ API</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/resources/"><span>Resources</span></a>
            </li>
            
            
            <li class="nav-item">
                <a  class="nav-link"   href="/aboutMe/"><span>About</span></a>
            </li>
            
            <!-- <li class="nav-item">
                <a class="nav-link disabled">Disabled</a>
            </li> -->
        </ul>
        <!-- <a class="btn btn-outline-success my-2 my-sm-0" href="/seach-document/" role="button">
            <i class="fas fa-search"></i>
        </a> -->
    </div>
</nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3 col-sm-4">
  <div class="sidebar sticky" style="overflow-y: auto; height:550px;">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">General - Solidworks Functions</span>
        

        
        <ul>
          
            <li><a href="/Solidworks-macro-guide/">Introduction</a></li>
          
            <li><a href="/solidworks-macros/open-new-document/">Open new Part document</a></li>
          
            <li><a href="/solidworks-macros/open-assembly-and-drawing/">Open Assembly and Drawing document</a></li>
          
            <li><a href="/solidworks-macros/select-plane-from-tree/">Selection Methods</a></li>
          
            <li><a href="/solidworks-macros/open-saved-document/">Open Saved Documents</a></li>
          
            <li><a href="/solidworks-macros/unit-correction/">Fix Unit Issue</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Lines</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/sketch-create-line/">Create Line</a></li>
          
            <li><a href="/solidworks-macros/sketch-create-centerline/">Create CenterLine</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Rectangles</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-corner-rectangle/">Create Corner Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-center-rectangle/">Create Center Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-3point-corner-rectangle/">Create 3-Point Corner Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-3point-center-rectangle/">Create 3-Point Center Rectangle</a></li>
          
            <li><a href="/solidworks-macros/create-parallelogram/">Create A Parallelogram</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Circles</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-circle/">Create Circle</a></li>
          
            <li><a href="/solidworks-macros/create-circle-by-radius/">Create Circle By Radius</a></li>
          
            <li><a href="/solidworks-macros/create-perimeter-circle/">Create Perimeter Circle</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Arcs</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-centerpoint-arc/">Create Centerpoint Arc</a></li>
          
            <li><a href="/solidworks-macros/create-tangent-arc/">Create Tangent Arc</a></li>
          
            <li><a href="/solidworks-macros/create-3point-arc/">Create 3-Point Arc</a></li>
          
            <li><a href="/solidworks-macros/polygon/">Create Polygon</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Slots</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-straight-slot/">Create a Straight Slot</a></li>
          
            <li><a href="/solidworks-macros/create-centerpoint-straight-slot/">Create a Centerpoint Straight Slot</a></li>
          
            <li><a href="/solidworks-macros/create-3point-arc-slot/">Create a 3-Point Arc Slot</a></li>
          
            <li><a href="/solidworks-macros/create-centerpoint-arc-slot/">Create a Centerpoint Arc Slot</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Point and Spline</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-point/">Create a Point</a></li>
          
            <li><a href="/solidworks-macros/create-spline/">Create a Spline</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Fillet and Chamfer</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-sketch-fillet/">Create a Fillet</a></li>
          
            <li><a href="/solidworks-macros/create-sketch-chamfer/">Create a Chamfer</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Trim and Extend</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/trim-entities/">Trim Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/extend-entities/">Extend Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Offset and Mirror</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/offset-entities/">Offset Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/mirror-entities/">Mirror Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Offset and Mirror</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/offset-entities/">Offset Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/mirror-entities/">Mirror Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Patterns</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/linear-skech-pattern/">Linear Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/edit-linear-skech-pattern/">Edit Linear Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/circular-skech-pattern/">Circular Sketch Pattern</a></li>
          
            <li><a href="/solidworks-macros/edit-circular-skech-pattern/">Edit Circular Sketch Pattern</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Move and Rotate</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/move-copy-sketch-entities/">Move/Copy Sketch Entities</a></li>
          
            <li><a href="/solidworks-macros/rotate-copy-sketch-entities/">Rotate/Copy Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Relations</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/toggle-display-sketch-relation/">Toggle (Hide/Show) Sketch Relations</a></li>
          
            <li><a href="/solidworks-macros/add-sketch-relations/">Add Sketch Relations (Constraints)</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Dimensions</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/add-dimension-methods/">Add dimension to Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Extrudes</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-extrude-feature/">Extrude Feature</a></li>
          
            <li><a href="/solidworks-macros/create-revolved-feature/">Revolved Boss/Base Feature</a></li>
          
            <li><a href="/solidworks-macros/create-sweep-feature/">Sweep Boss/Base Feature</a></li>
          
            <li><a href="/solidworks-macros/create-lofted-boss-feature/">Lofted Boss/Base Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Cuts</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-extrude-cut-feature/">Extrude Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-revolve-cut-feature/">Revolve Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-sweep-cut-feature/">Sweep Cut Feature</a></li>
          
            <li><a href="/solidworks-macros/create-loft-cut-feature/">Lofted Cut Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Holes and Threads</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-hole-from-hole-wizard/">Holes from Hole Wizard</a></li>
          
            <li><a href="/solidworks-macros/create-threads/" class="active">Threads</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Fillet & Chamfer</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-fillet/">Fillet Feature</a></li>
          
            <li><a href="/solidworks-macros/create-chamfer/">Chamfer Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Mirror & Patterns</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/create-mirror/">Mirror Feature</a></li>
          
            <li><a href="/solidworks-macros/create-linear-patterns/">Linear Pattern Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-circular-patterns/">Circular Pattern Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-sketch-driven-pattern/">Sketch Driven Pattern Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Features - Transformation</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/create-rib/">Rib Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-draft/">Draft Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-shell/">Shell Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-wrap/">Wrap Feature</a></li>
          
            <li><a href="/solidworks-vba-macros/create-scale/">Scale Feature</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Reference Geometry</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/create-reference-plane/">Reference Plane</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-axis/">Reference Axis</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-coordinate/">Reference Co-Ordinate</a></li>
          
            <li><a href="/solidworks-vba-macros/create-reference-point/">Reference Point</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - General</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-insert-component/">Insert Component</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-unfix-component/">Unfix Component</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - Standard Mates</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-conicident-mate/">Add Coincident Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-parallel-mate/">Add Parallel Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-perpendicular-mate/">Add Perpendicular Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-tangent-mate/">Add Tangent Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-concentric-mate/">Add Concentric Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-distance-mate/">Add Distance Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-angle-mate/">Add Angle Mate</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - Advanced Mates</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-width-mate/">Add Width Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-symmetric-mate/">Add Symmetric Mate</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - Editing Mates</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-rename-mate/">Rename Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-edit-distance-mate/">Edit Distance Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-toggle-mate-alignment/">Toggle Mate Alignment</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-delete-mate/">Delete Mate</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Assembly - Components</span>
        

        
        <ul>
          
            <li><a href="/solidworks-vba-macros/assembly-insert-virtual-part/">Insert Virtual Part</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-insert-virtual-assembly/">Insert Virtual Assembly</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-copy-with-mate/">Copy With Mate</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-hide-component/">Hide Selected Component</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-show-component/">Show Selected Component</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-suppress-component/">Suppress Selected Component</a></li>
          
            <li><a href="/solidworks-vba-macros/assembly-unsuppress-component/">Unsuppress Selected Component</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Sketch - Others</span>
        

        
        <ul>
          
            <li><a href="/solidworks-macros/convert-to-construction-sketch-segment/">Convert to Construction Sketch</a></li>
          
            <li><a href="/solidworks-macros/split-sketch-segments/">Split Open/Closed Sketch Entities</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>

</div>
      <div class="col-md-9 col-sm-8">
        <div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    
    <meta itemprop="headline" content="SOLIDWORKS Macro - Create Threads">
    
    <meta itemprop="description" content="  This article is an &quot;Intermediate&quot; post and required you to have some knowledge of VBA.  If you are following my articles you will notice that till now we were hardcoding the selections for input parameters.  But from this post onward we will take user-inputs.  In this article we did not use 🚀 UserForm for taking inputs, instead we use 🚀 Input Box for value input and 🚀 Message Box to notify user.  I hope you will also like this type of tutorials.  Thank you for reading.">
    
    
    <meta itemprop="datePublished" content="2022-09-27T15:07:36-04:00">
    

    <div class="page__inner-wrap">
      
      <header>
        <h1 id="page-title" class="page__title" itemprop="headline">SOLIDWORKS Macro - Create Threads
</h1>
        

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          15 minute read
        
      </span>
    
  </p>


      </header>
      

      <section class="page__content" itemprop="text">
        
        <aside class="sidebar__right sticky">
          <nav class="toc">
            <header>
              <h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4>
            </header>
            <ul class="toc__menu"><li><a href="#objective">Objective</a></li><li><a href="#steps-to-create-thread">Steps To Create Thread</a></li><li><a href="#results-we-can-get">Results We Can Get</a></li><li><a href="#video-of-code-on-youtube">Video of Code on YouTube</a></li><li><a href="#code-sample">Code Sample</a></li><li><a href="#prerequisite">Prerequisite</a></li><li><a href="#steps-to-follow">Steps To Follow</a><ul><li><a href="#creating-global-variables">Creating Global Variables</a></li><li><a href="#initializing-required-variables">Initializing Required Variables</a></li><li><a href="#get-cylinder-feature-by-traversing-feature-tree">Get Cylinder Feature by Traversing Feature Tree</a></li><li><a href="#select-top-edge-of-cylinder-feature">Select top edge of Cylinder Feature</a></li><li><a href="#create-thread-feature-using-thread-feature-data">Create Thread feature using Thread Feature Data</a></li><li><a href="#final-work">Final work</a></li></ul></li></ul>

            <br/>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8158659264340002"
     crossorigin="anonymous"></script>
<!-- Vertical Ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8158659264340002"
     data-ad-slot="4311368222"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
          </nav>
        </aside>
        
        <div>
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8158659264340002"
     crossorigin="anonymous"></script>
<!-- Horizontal Ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8158659264340002"
     data-ad-slot="6007593278"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
          <div class="notice--warning">
  This article is an <strong>"Intermediate"</strong> post and required you to have some knowledge of <strong>VBA</strong>.<br />
  If you are following my articles you will notice that till now we were <strong>hardcoding</strong> the selections for input parameters.<br />
  But from this post onward we will take user-inputs.<br />
  In this article we did not use 🚀 <strong><a href="/vba/userform/">UserForm</a></strong> for taking inputs, instead we use 🚀 <strong><a href="/vba/inputbox-function/">Input Box</a></strong> for <em>value input</em> and 🚀 <strong><a href="/vba/msgBox-function/">Message Box</a></strong> to notify user.<br />
  I hope you will also like this type of tutorials.<br />
  Thank you for reading.<br />
</div>

<h2 id="objective">Objective</h2>

<p>Objective of this article is to learn <em>how to create <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> through SOLIDWORKS VBA Macros</em> in SOLIDWORKS.</p>

<p>We create <strong>Thread Feature</strong> in 3 steps in general.</p>

<ol>
  <li><em>Traversing</em> through <strong>Feature Tree</strong>.</li>
  <li>Programmatically select <strong>a 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> from <strong>Feature Tree</strong> named <strong>Cylinder</strong>.</li>
  <li>Get Cylinder surface of  <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</li>
  <li>Create 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a>.</li>
  <li>Create 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> using 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a> from method <code class="language-plaintext highlighter-rouge">CreateFeature</code>.</li>
</ol>

<p>This method is <strong><em>most updated</em></strong> method, so <strong><em>use this method</em></strong> if you want to create a new <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>.</p>

<h2 id="steps-to-create-thread">Steps To Create Thread</h2>

<p>We use following steps to create 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> while writing macro</p>

<ol>
  <li><em>Traversing</em> through <strong>Feature Tree</strong>.</li>
  <li>Programmatically select <strong>a 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> from <strong>Feature Tree</strong> named <strong>Cylinder</strong>.</li>
  <li>Get all Faces of <strong>Cylinder</strong>.</li>
  <li>Get Cylinder 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html">Surface</a></strong> of selected <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</li>
  <li>Select the top 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">Edge</a></strong> of Cylinder 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html">Surface</a></strong>.</li>
  <li>Create 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a>.</li>
  <li>Create 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> using 👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"><strong>Thread Feature Definition</strong></a> from method <code class="language-plaintext highlighter-rouge">CreateFeature</code>.</li>
</ol>

<h2 id="results-we-can-get">Results We Can Get</h2>

<p>After running our we successfully create <strong>Hole feature</strong> as a result.</p>

<p>Below image shows the result we get.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/threads-final-result.png"><img src="/assets/Solidworks_Images/feature-threads/threads-final-result.png" alt="threads-final-result" /></a></p>

<blockquote>
  <p>To get the correct result please follow the steps correctly.</p>
</blockquote>

<h2 id="video-of-code-on-youtube">Video of Code on YouTube</h2>

<p>Please see below 🎬 video on <strong>how to create Thread feature</strong> from SOLIDWORKS VBA Macros.</p>

<iframe src="https://www.youtube.com/embed/T5OgoBBULDU" frameborder="0" allowfullscreen=""></iframe>
<p><br /></p>

<p>Please note that there are <strong>no explanation</strong> in the video.</p>

<p><strong>Explanation</strong> of each line and why we write code this way is given in this post.</p>

<p class="notice--warning">It is advisable to watch video, since it help you to better understand the process.</p>

<h2 id="code-sample">Code Sample</h2>

<p>Below is the <code class="language-plaintext highlighter-rouge">code</code> for creating <em>Thread Feature</em> feature in <strong>VBA</strong> is given.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>

<span class="c1">' Solidworks application variable</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>

<span class="c1">' Solidworks document variable</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>

<span class="c1">' Solidworks Thread feature data variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeatData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ThreadFeatureData</span>

<span class="c1">' Solidworks Thread Feature variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Solidworks Feature variable</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>

<span class="c1">' Solidworks Face variable</span>
<span class="k">Dim</span> <span class="nv">swFace</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Face2</span>

<span class="c1">' Solidworks Surface variable</span>
<span class="k">Dim</span> <span class="nv">swSurface</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Surface</span>

<span class="c1">' Solidworks Entity variable</span>
<span class="k">Dim</span> <span class="nv">swEnt</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>

<span class="c1">' Variable for Solidworks Edges</span>
<span class="k">Dim</span> <span class="nv">swEdges</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Solidworks Edge variable</span>
<span class="k">Dim</span> <span class="nv">swEdge</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Edge</span>

<span class="c1">' Array for Solidworks Faces</span>
<span class="k">Dim</span> <span class="nv">faceArray</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Variable for Solidworks Face</span>
<span class="k">Dim</span> <span class="nv">eachFace</span> <span class="ow">As</span> <span class="kt">Variant</span>

<span class="c1">' Boolean variable</span>
<span class="k">Dim</span> <span class="nv">boolStatus</span> <span class="ow">As</span> <span class="kt">Boolean</span>

<span class="c1">' Main program for Thread</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

  <span class="c1">' Set Solidworks application variable to current application</span>
  <span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
  
  <span class="c1">' Check if Solidworks is opened or not</span>
  <span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks is not opened"</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Set Solidworks document variable to open document</span>
  <span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
  
  <span class="c1">' Check if Solidworks document is opened or not</span>
  <span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Solidworks document is not opened. Please open a document."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Get First feature in Feature tree</span>
  <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FirstFeature</span>
  
  <span class="c1">' Check if Solidworks document is selected or not</span>
  <span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to selected First feature in Feature Tree."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' Traversing through the Feature Tree,</span>
  <span class="c1">' until Feature name is "Cylinder"</span>
  <span class="k">While</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span> <span class="o">&lt;&gt;</span> <span class="s">"Cylinder"</span>
    
    <span class="c1">' Print current Feature name is Immediate window</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
    
    <span class="c1">' Get the next feature</span>
    <span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetNextFeature</span>
  <span class="k">Wend</span>
  
  <span class="c1">' Print current Feature name is Immediate window</span>
  <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
  
  <span class="c1">' Get the faces of selected feature</span>
  <span class="n">faceArray</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetFaces</span>

  <span class="c1">' Loop through all Face array</span>
  <span class="k">For</span> <span class="k">Each</span> <span class="n">eachFace</span> <span class="ow">In</span> <span class="n">faceArray</span>
  
    <span class="c1">' Set Solidworks Face variable to current current</span>
    <span class="k">Set</span> <span class="n">swFace</span> <span class="o">=</span> <span class="n">eachFace</span>
    
    <span class="c1">' Get the Surface of from the Solidworks Face variable</span>
    <span class="k">Set</span> <span class="n">swSurface</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetSurface</span>
    
    <span class="c1">' If we have cylinder surface</span>
    <span class="k">If</span> <span class="n">swSurface</span><span class="p">.</span><span class="n">IsCylinder</span><span class="p">()</span> <span class="k">Then</span>
    
      <span class="c1">' Get all edges of this face</span>
      <span class="n">swEdges</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetEdges</span>
      
      <span class="c1">' Set Solidworks edge variable to 1st edge</span>
      <span class="k">Set</span> <span class="n">swEdge</span> <span class="o">=</span> <span class="n">swEdges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      
      <span class="c1">' Set Solidworks Entity variable to Solidworks Edge variable</span>
      <span class="k">Set</span> <span class="n">swEnt</span> <span class="o">=</span> <span class="n">swEdge</span>
      
      <span class="c1">' Select the current entity</span>
      <span class="n">boolStatus</span> <span class="o">=</span> <span class="n">swEnt</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="k">True</span><span class="p">)</span>
      
      <span class="c1">' If fail to select the edge then inform user</span>
      <span class="k">If</span> <span class="n">boolStatus</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Failed to select Edge of Cylinder."</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
      <span class="nf">End</span> <span class="k">If</span>
      
    <span class="k">End</span> <span class="k">If</span>
  <span class="k">Next</span>
  
  <span class="c1">' Create Thread feature data</span>
  <span class="k">Set</span> <span class="n">swThreadFeatData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFeatureNameID_e</span><span class="p">.</span><span class="n">swFmSweepThread</span><span class="p">)</span>
  
  <span class="c1">' Create Thread Feature</span>
  <span class="k">Set</span> <span class="n">swThreadFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swThreadFeatData</span><span class="p">)</span>
  
  <span class="c1">' Check if Thread Feature created or not</span>
  <span class="k">If</span> <span class="n">swThreadFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
    <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Thread Feature."</span><span class="p">)</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
  <span class="nf">End</span> <span class="k">If</span>
  
  <span class="c1">' View zoom to fit</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
  
  <span class="c1">' Clear all selection</span>
  <span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
    
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h2 id="prerequisite">Prerequisite</h2>

<p>There are some <em>prerequisite</em> for this article.</p>

<p>We are <strong>not</strong> creating feature from code but we use <strong>existing feature</strong> to create <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> as shown in below picture.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/prerequisite.png"><img src="/assets/Solidworks_Images/feature-threads/prerequisite.png" alt="prerequisite" /></a></p>

<p>As shown in above image, there only <em>1 Extrude feature</em> in our part.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Extrude Feature</code> : This is our <strong>Extrude part</strong> for <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>.</li>
</ul>

<p>If you want to create <strong>Extrude</strong> feature programmatically then please refer to below article.</p>

<ul>
  <li>👉 <strong><a href="/solidworks-macros/create-extrude-feature">SOLIDWORKS Macros - Create Extrude/Boss</a></strong></li>
</ul>

<p>Also, we will apply checks in this article, so the code we write should be error free most of the time.</p>

<h2 id="steps-to-follow">Steps To Follow</h2>

<p>To create <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong>, there are following steps:</p>

<ol>
  <li><em>Creating Global Variables</em></li>
  <li><em>Initializing required variables</em></li>
  <li><em>Get Cylinder Feature by Traversing Feature Tree</em></li>
  <li><em>Select top edge of Cylinder Feature</em></li>
  <li><em>Create Thread feature using Thread Feature Data</em></li>
  <li><em>Final work</em></li>
</ol>

<p>Now let us walk through <strong>each step</strong> as given above, and <strong>understand</strong> every line.</p>

<p>I also give some <strong><em>links</em></strong> (see icon 👉 ) so that you can go through them if there are anything I explained in previous articles.</p>

<h3 id="creating-global-variables">Creating Global Variables</h3>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Option</span> <span class="n">Explicit</span>
</code></pre></div></div>

<p>This line forces us to define every variable we are going to use.</p>

<p>For more information please visit 👉 <strong><a href="/solidworks-macros/open-new-document">SOLIDWORKS Macros - Open new Part document</a></strong> post.</p>

<p>We create following variables.</p>

<ul>
  <li><strong>Variable for Solidworks application</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks application</span>
<span class="k">Dim</span> <span class="nv">swApp</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swApp</code> and the type of this <code class="language-plaintext highlighter-rouge">swApp</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.SldWorks</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks document</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks document</span>
<span class="k">Dim</span> <span class="nv">swDoc</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ModelDoc2</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swDoc</code> and the type of this <code class="language-plaintext highlighter-rouge">swDoc</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ModelDoc2</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Thread feature data</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Thread feature data variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeatData</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">ThreadFeatureData</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> and the type of this <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">SldWorks.ThreadFeatureData</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks feature</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Thread Feature variable</span>
<span class="k">Dim</span> <span class="nv">swThreadFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swThreadFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swThreadFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swThreadFeature</code> for <strong>SOLIDWORKS Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Feature variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Feature variable</span>
<span class="k">Dim</span> <span class="nv">swFeature</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Feature</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swFeature</code> and the type of this <code class="language-plaintext highlighter-rouge">swFeature</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Feature</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFeature</code> for <strong>SOLIDWORKS Feature</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Feature</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Face variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Face variable</span>
<span class="k">Dim</span> <span class="nv">swFace</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Face2</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swFace</code> and the type of this <code class="language-plaintext highlighter-rouge">swFace</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Face2</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swFace</code> for <strong>SOLIDWORKS Face</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Face2</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Surface</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Surface variable</span>
<span class="k">Dim</span> <span class="nv">swSurface</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Surface</span>
</code></pre></div></div>

<p>In this line, we Create a variable which we named as <code class="language-plaintext highlighter-rouge">swSurface</code> and the type of this <code class="language-plaintext highlighter-rouge">swSurface</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Surface</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swSurface</code> for <strong>SOLIDWORKS Surface</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Surface</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Solidworks Entity</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Entity variable</span>
<span class="k">Dim</span> <span class="nv">swEnt</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Entity</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swEnt</code> and the type of this <code class="language-plaintext highlighter-rouge">swEnt</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Entity</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEnt</code> for <strong>SOLIDWORKS Entity</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Entity</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Variable for Edges</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Edges</span>
<span class="k">Dim</span> <span class="nv">swEdges</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">swEdges</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEdges</code> for to get all edges of a surface.</p>

<ul>
  <li><strong>Variable for Solidworks Edge</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Solidworks Edge variable</span>
<span class="k">Dim</span> <span class="nv">swEdge</span> <span class="ow">As</span> <span class="n">SldWorks</span><span class="p">.</span><span class="n">Edge</span>
</code></pre></div></div>

<p>In this line, we create a variable which we named as <code class="language-plaintext highlighter-rouge">swEdge</code> and the type of this <code class="language-plaintext highlighter-rouge">swEdge</code> variable is <code class="language-plaintext highlighter-rouge">SldWorks.Edge</code>.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">swEnt</code> for <strong>SOLIDWORKS Edge</strong>.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">Edge</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEdge_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<ul>
  <li><strong>Array for Solidworks Faces</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Array for Solidworks Faces</span>
<span class="k">Dim</span> <span class="nv">faceArray</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">faceArray</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">faceArray</code> for to get all face of Cylinder feature.</p>

<ul>
  <li><strong>Variable for Solidworks Face</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Variable for Solidworks Face</span>
<span class="k">Dim</span> <span class="nv">eachFace</span> <span class="ow">As</span> <span class="kt">Variant</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">eachFace</code> as <code class="language-plaintext highlighter-rouge">Variant</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">eachFace</code> for to get each face inside <code class="language-plaintext highlighter-rouge">faceArray</code> array.</p>

<ul>
  <li><strong>Boolean variable</strong></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Boolean variable</span>
<span class="k">Dim</span> <span class="nv">boolStatus</span> <span class="ow">As</span> <span class="kt">Boolean</span>
</code></pre></div></div>

<p>In this line, we create a variable named <code class="language-plaintext highlighter-rouge">boolStatus</code> as <code class="language-plaintext highlighter-rouge">Boolean</code> object type.</p>

<p>We create variable <code class="language-plaintext highlighter-rouge">boolStatus</code> to confirm method result.</p>

<p><strong><em>These all are our global variables.</em></strong></p>

<p>They are <strong>SOLIDWORKS API Objects</strong>.</p>

<p>So basically I group all the <strong>SOLIDWORKS API Objects</strong> in one place.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Main program for Thread</span>
<span class="k">Sub</span> <span class="nf">main</span><span class="p">()</span>

<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<p>Next is our <code class="language-plaintext highlighter-rouge">Sub</code> procedure which has name of <code class="language-plaintext highlighter-rouge">main</code>.</p>

<p>This procedure hold all the <em>statements (instructions)</em> we give to computer.</p>

<p>To know more about <strong>Sub Procedure</strong> you can check 👉 <strong><a href="/vba/sub-and-function-procedure/">VBA Sub and Function Procedures</a></strong> article of this website.</p>

<h3 id="initializing-required-variables">Initializing Required Variables</h3>

<p>Inside this procedure we first initialize required variables as given below.</p>

<ul>
  <li><em>Set SOLIDWORKS variable to SOLIDWORKS application</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS variable to SOLIDWORKS application</span>
<span class="k">Set</span> <span class="n">swApp</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">SldWorks</span>
</code></pre></div></div>

<p>In this line, we set the value of our SOLIDWORKS variable <code class="language-plaintext highlighter-rouge">swApp</code>; which we define earlier; to SOLIDWORKS application.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS is opened or not</span>
<span class="k">If</span> <span class="n">swApp</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS is not opened"</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS application variable is <em>successfully assigned</em> to current SOLIDWORKS application.</p>

<ul>
  <li><em>Set SOLIDWORKS document variable to opened part document</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set SOLIDWORKS document variable to opened part document</span>
<span class="k">Set</span> <span class="n">swDoc</span> <span class="o">=</span> <span class="n">swApp</span><span class="p">.</span><span class="n">ActiveDoc</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> variable to currently open part document.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if SOLIDWORKS document is opened or not</span>
<span class="k">If</span> <span class="n">swDoc</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"SOLIDWORKS document is not opened. Please open a document."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if SOLIDWORKS document <code class="language-plaintext highlighter-rouge">swDoc</code> is opened.</p>

<p>If SOLIDWORKS document is not opened then code execute inside the code and inform the user by a 👉 <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<h3 id="get-cylinder-feature-by-traversing-feature-tree">Get Cylinder Feature by Traversing Feature Tree</h3>

<p>Now we will get <strong>Cylinder</strong> feature by <em>Traversing Feature Tree</em>.</p>

<p>Please follow steps given below.</p>

<ul>
  <li><em>Get First feature in Feature tree</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get First feature in Feature tree</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FirstFeature</span>
</code></pre></div></div>

<p>In above line of code, we set SOLIDWORKS Feature <code class="language-plaintext highlighter-rouge">swFeature</code> variable to <strong>first</strong> feature in <em>Feature Tree</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Solidworks document is selected or not</span>
<span class="k">If</span> <span class="n">swFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to selected First feature in Feature Tree."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we get SOLIDWORKS Feature <code class="language-plaintext highlighter-rouge">swFeature</code>.</p>

<p>If we failed to get SOLIDWORKS Feature then code execute inside the code and inform the user by a 👉 <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Traversing through the Feature Tree,</span>
<span class="c1">' until Feature name is "Cylinder"</span>
<span class="k">While</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span> <span class="o">&lt;&gt;</span> <span class="s">"Cylinder"</span>

<span class="k">Wend</span>
</code></pre></div></div>

<p>In above line of code, we create another <code class="language-plaintext highlighter-rouge">While</code> loop.</p>

<p>This loop will continue until we select the our <strong>Cylinder</strong> <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<p>For more details about <code class="language-plaintext highlighter-rouge">While</code> loop, please see 👉 <strong><a href="/vba/looping/">VBA Looping</a></strong> article from this website.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Print current Feature name is Immediate window</span>
<span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div></div>

<p>In above line of code, we print <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> name into <em>Immediate window</em>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the next feature</span>
<span class="k">Set</span> <span class="n">swFeature</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetNextFeature</span>
</code></pre></div></div>

<p>In above line of code, we set <code class="language-plaintext highlighter-rouge">swFeature</code> variable to next <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Print current Feature name is Immediate window</span>
<span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div></div>

<p>In above line of code, we print <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong> name into <em>Immediate window</em>.</p>

<p>Since this line is outside of <code class="language-plaintext highlighter-rouge">While</code> loop, it means selected feature is <strong>Cylinder</strong> <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<h3 id="select-top-edge-of-cylinder-feature">Select top edge of Cylinder Feature</h3>

<p>Now we need to select top edge of previously selected <strong>Cylinder</strong> <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<p>Please follow steps given below.</p>

<ul>
  <li><em>Get the faces of selected feature</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the faces of selected feature</span>
<span class="n">faceArray</span> <span class="o">=</span> <span class="n">swFeature</span><span class="p">.</span><span class="n">GetFaces</span>
</code></pre></div></div>

<p>In above line of code we get all faces of selected <strong>Cylinder</strong> <strong>👉 <a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html">Feature</a></strong>.</p>

<ul>
  <li><em>Loop through all face array</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Loop through all Face array</span>
<span class="k">For</span> <span class="k">Each</span> <span class="n">eachFace</span> <span class="ow">In</span> <span class="n">faceArray</span>

<span class="k">Next</span>
</code></pre></div></div>

<p>In above line of code we create a 👉 <strong><a href="/vba/looping/">For Each</a></strong> loop.</p>

<ul>
  <li><em>Get surface of current Face</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks Face variable to current face</span>
<span class="k">Set</span> <span class="n">swFace</span> <span class="o">=</span> <span class="n">eachFace</span>
</code></pre></div></div>

<p>In above line of code, we Set 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">SOLIDWORKS Face</a></strong> variable <code class="language-plaintext highlighter-rouge">swFace</code> to current face.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get the Surface of from the Solidworks Face variable</span>
<span class="k">Set</span> <span class="n">swSurface</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetSurface</span>
</code></pre></div></div>

<p>In above line of code we get the 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">Surface</a></strong> of from the 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html">SOLIDWORKS Face</a></strong> variable using <code class="language-plaintext highlighter-rouge">GetSurface</code> 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2~GetSurface.html">method</a></strong>.</p>

<ul>
  <li><em>If Statement for Cylindrical Surface</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' If we have cylinder surface</span>
<span class="k">If</span> <span class="n">swSurface</span><span class="p">.</span><span class="n">IsCylinder</span><span class="p">()</span> <span class="k">Then</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html">SOLIDWORKS Surface</a></strong> <code class="language-plaintext highlighter-rouge">swSurface</code> is Cylindrical Surface or not.</p>

<ul>
  <li><em>Select first edge of Cylindrical Surface</em></li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Get all edges of this face</span>
<span class="n">swEdges</span> <span class="o">=</span> <span class="n">swFace</span><span class="p">.</span><span class="n">GetEdges</span>
</code></pre></div></div>

<p>In above line of code we get all edges of current face.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks edge variable to 1st edge</span>
<span class="k">Set</span> <span class="n">swEdge</span> <span class="o">=</span> <span class="n">swEdges</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">SOLIDWORKS edge</a></strong> variable <code class="language-plaintext highlighter-rouge">swEdge</code> to 1st edge.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Set Solidworks Entity variable to Solidworks Edge variable</span>
<span class="k">Set</span> <span class="n">swEnt</span> <span class="o">=</span> <span class="n">swEdge</span>
</code></pre></div></div>

<p>In above line of code we set 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">SOLIDWORKS Entity</a></strong> variable to 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html">SOLIDWORKS edge</a></strong> variable.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Select the current entity</span>
<span class="n">boolStatus</span> <span class="o">=</span> <span class="n">swEnt</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="k">True</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we select the current entity.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' If fail to select the edge then inform user</span>
<span class="k">If</span> <span class="n">boolStatus</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="s">"Failed to select Edge of Cylinder."</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if <strong><code class="language-plaintext highlighter-rouge">Boolean</code></strong> variable <code class="language-plaintext highlighter-rouge">boolStatus</code> is <code class="language-plaintext highlighter-rouge">False</code>.</p>

<p>If <strong><code class="language-plaintext highlighter-rouge">Boolean</code></strong> variable <code class="language-plaintext highlighter-rouge">boolStatus</code> is <code class="language-plaintext highlighter-rouge">False</code>. then code execute inside the code and inform the user by a 👉 <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<h3 id="create-thread-feature-using-thread-feature-data">Create Thread feature using Thread Feature Data</h3>

<p>We have completed our <em>selection</em> of 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html">SOLIDWORKS Entity</a></strong>.</p>

<p>Now we create Thread Feature.</p>

<p>For this we use 2 steps as follows:</p>

<ol>
  <li><em>Create Thread Feature definition</em></li>
  <li><em>Create Thread Feature using the definition</em></li>
</ol>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Thread feature data</span>
<span class="k">Set</span> <span class="n">swThreadFeatData</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateDefinition</span><span class="p">(</span><span class="n">swFeatureNameID_e</span><span class="p">.</span><span class="n">swFmSweepThread</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> by <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method.</p>

<p><code class="language-plaintext highlighter-rouge">CreateDefinition</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method takes following parameters as explained:</p>

<ul>
  <li>
    <p><strong>Type</strong> - <em><code class="language-plaintext highlighter-rouge">Feature name ID</code> as defined in <code class="language-plaintext highlighter-rouge">swFeatureNameID_e</code></em>.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">swFmBoundingBox</code> <em>(bounding box)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCirPattern</code> <em>(circular pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmCurvePattern</code> <em>(curve-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDerivedLPattern</code> <em>(derived-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmDimPattern</code> <em>(variable/dimension pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmFillPattern</code> <em>(fill pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmGroundPlane</code> <em>(ground plane)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLibraryFeature</code> <em>(library)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalChainPattern</code> <em>(chain component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCirPattern</code> <em>(circular component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalCurvePattern</code> <em>(curve-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalLPattern</code> <em>(linear component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLocalSketchPattern</code> <em>(sketch-driven component pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmLPattern</code> <em>(linear pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmNormalCut</code> <em>(sheet metal normal cut)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefCurve</code> <em>(projection curve)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmRefSurface</code> <em>(surface sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSketchPattern</code> <em>(sketch-driven pattern)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweep</code> <em>(boss sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepCut</code> <em>(cut sweep)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmSweepThread</code> <em>(Thread)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTabAndSlot</code> <em>(tab and slot)</em></li>
      <li><code class="language-plaintext highlighter-rouge">swFmTablePattern</code> <em>(table pattern)</em></li>
    </ul>
  </li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateDefinition</code> method retun <strong>feature or pattern-specific</strong> feature data object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>Type</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swFmSweepThread</code> as <code class="language-plaintext highlighter-rouge">Feature name ID</code></em>.</li>
</ul>

<p>If you want to know more information about Sweep Feature data then please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">this page of Solidworks API Help</a></strong>.</p>

<p>This page will give you information about various properties and methods of <code class="language-plaintext highlighter-rouge">IThreadFeatureData</code> Interface.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Create Thread Feature</span>
<span class="k">Set</span> <span class="n">swThreadFeature</span> <span class="o">=</span> <span class="n">swDoc</span><span class="p">.</span><span class="n">FeatureManager</span><span class="p">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">swThreadFeatData</span><span class="p">)</span>
</code></pre></div></div>

<p>In above line of code we set the value of variable <code class="language-plaintext highlighter-rouge">swThreadFeature</code> by <code class="language-plaintext highlighter-rouge">CreateFeature</code> method.</p>

<p>This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method takes following parameters as explained:</p>

<ul>
  <li><strong>FeatureData</strong> - <em><code class="language-plaintext highlighter-rouge">Feature or pattern-specific</code> feature data object</em>.</li>
</ul>

<p><strong>Return Value</strong> : This <code class="language-plaintext highlighter-rouge">CreateFeature</code> method return <strong>feature</strong> data object.</p>

<p><code class="language-plaintext highlighter-rouge">CreateFeature</code> method is part of <code class="language-plaintext highlighter-rouge">FeatureManager</code> object.</p>

<p>This <code class="language-plaintext highlighter-rouge">FeatureManager</code> is again part of <code class="language-plaintext highlighter-rouge">swDoc</code> variable i.e. <code class="language-plaintext highlighter-rouge">ModelDoc2</code> object.</p>

<p>To see methods and properties related to <code class="language-plaintext highlighter-rouge">FeatureManager</code> object, please visit 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html">this page of SOLIDWORKS API Help</a></strong>.</p>

<p>In our code, I have used following values:</p>

<ul>
  <li><strong>FeatureData</strong> - <em>I use <code class="language-plaintext highlighter-rouge">swThreadFeatData</code> as feature data object which we defined previously</em>.</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Check if Thread Feature created or not</span>
<span class="k">If</span> <span class="n">swThreadFeature</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
  <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Failed to create Thread Feature."</span><span class="p">)</span>
  <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">If</span>
</code></pre></div></div>

<p>In above line of code, we use an 👉 <strong><a href="/vba/if-then-structure-select-case/">IF statement</a></strong> to check if we able to create 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> or not.</p>

<p>If we failed to select then inform the user by a 👉 <strong><a href="/vba/msgBox-function/">Message Window</a></strong>.</p>

<p>After showing error message our program <strong>exit</strong> from here itself.</p>

<p>Now we run the macro and after running macro we get Revolve as shown in below image.</p>

<p><a href="/assets/Solidworks_Images/feature-threads/threads-final-result.png"><img src="/assets/Solidworks_Images/feature-threads/threads-final-result.png" alt="threads-final-result" /></a></p>

<h3 id="final-work">Final work</h3>

<p>After creating 👉 <strong><a href="https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html">Thread Feature</a></strong> , we have to do some cleaning work so that we can use this macro frequently.</p>

<ul>
  <li>Make part Zoom to fit</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' View zoom to fit</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ViewZoomtofit2</span>
</code></pre></div></div>

<p>In above line, we make our view zoom to fit the model.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ViewZoomtofit2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<ul>
  <li>Clear selection</li>
</ul>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">' Clear all selection</span>
<span class="n">swDoc</span><span class="p">.</span><span class="n">ClearSelection2</span> <span class="k">True</span>
</code></pre></div></div>

<p>In above line, we clear all previous selection.</p>

<p>For this we use <code class="language-plaintext highlighter-rouge">ClearSelection2</code> method which is part of <em>SOLIDWORKS Document</em> variable i.e <code class="language-plaintext highlighter-rouge">swDoc</code> variable.</p>

<p><strong>This is it !!!</strong></p>

<p><em>I hope my efforts will helpful to someone!</em></p>

<p>If you found anything to <strong>add or update</strong>, please let me know on my <em>e-mail</em>.</p>

<p>Hope this post helps you to <strong>create Threads</strong> with SOLIDWORKS VBA Macros.</p>

<p>For more such tutorials on <strong>SOLIDWORKS VBA Macro</strong>, do come to this blog after sometime.</p>

<p><em>If you like the post then please share it with your friends also.</em></p>

<p><em>Do let me know by you like this post or not!</em></p>

<p><em>Till then, Happy learning!!!</em></p>

        </div>
        
        <div>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Top and Bottom placed Ad -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8158659264340002"
       data-ad-slot="6644001766"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-09-27T15:07:36-04:00">September 27, 2022</time></p>


      </footer>

      
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    
    <li class="page-item mr-5">
      <a class="btn btn-primary text-light" href="/solidworks-macros/create-hole-from-hole-wizard/" title="SOLIDWORKS Macro - Create Holes from Hole Wizard
">❮ Previous</a>
    </li>
    
    
    <li class="page-item ml-5">
      <a class="btn btn-primary text-light" href="/solidworks-macros/create-fillet/" title="SOLIDWORKS Macro - Create Fillet
">Next ❯</a>
    </li>
    
  </ul>
</nav>

    </div>
  </article>

</div>
      </div>
    </div>
  </div>

  <div id="footer" class="page__footer">
    <footer>
      <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
      <footer class="bd-footer py-5 bg-light">
  <div class="container">
    <div class="row">
      <div class="col-6">
        <a class="d-inline-flex align-items-center mb-2 link-dark" href="/" aria-label="Bootstrap">
          <img src="/assets/logo.png" width="30" height="30" class="img-fluid mr-2" alt="">
          <span> The CAD Coder</span>
        </a>
        <ul class="list-unstyled small text-muted">
          <li class="mb-2">Programming Tutorials for SOLIDWORKS 3D CAD Software.</li>
          <li class="mb-2">Copyright © 2022 The CAD Coder</li>
          <li class="mb-2">Built with <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a>.</li>

          
            
              
            
              
              <li class="list-inline-item"><a href="https://facebook.com/thecadcoder" target="_blank" title="Facebook"><i
                class="fab fa-2x fa-facebook-f"></i></a></li>
              
            
              
            
              
            
              
            
              
            
              
              <li class="list-inline-item"><a href="https://www.youtube.com/channel/UCm_VglqA2S4WUXM55vyqAFg" target="_blank" title="YouTube"><i
                class="fab fa-2x fa-youtube"></i></a></li>
              
            
              
              <li class="list-inline-item"><a href="mailto:thecadcoder@gmail.com" target="_blank" title="Email"><i
                class="fa fa-envelope fa-2x"></i></a></li>
              
            
          
        </ul>
      </div>
      <div class="col-6">
        <h5>Links</h5>
        <ul class="list-unstyled">
          <!-- <li class="mb-2"><a href="/">Home</a></li> -->
          <li class="mb-2"><a href="/aboutMe/">About</a></li>
          <li class="mb-2"><a href="/resources/">Resources</a></li>
          <li class="mb-2"><a href="/Disclaimer/">Privacy Policy</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
    </footer>
  </div>

  
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  <!-- Optional JavaScript; choose one of the two! -->

  <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
    crossorigin="anonymous"></script>

  <!-- Option 2: Separate Popper and Bootstrap JS -->
  <!--
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
    -->

  
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






</body>

</html>
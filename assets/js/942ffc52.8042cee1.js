"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[5603],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=p(n),h=l,c=d["".concat(s,".").concat(h)]||d[h]||u[h]||i;return n?a.createElement(c,r(r({ref:t},m),{},{components:n})):a.createElement(c,r({ref:t},m))}));function h(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=n.length,r=new Array(i);r[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:l,r[1]=o;for(var p=2;p<i;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},97733:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var a=n(87462),l=(n(67294),n(3905));const i={title:"VBA GetOpenFilename, GetSaveAsFilename and Getting a Folder Name",tags:["VBA"],permalink:"/vba/other-dialogs/"},r=void 0,o={unversionedId:"vba-other-dialog",id:"vba-other-dialog",title:"VBA GetOpenFilename, GetSaveAsFilename and Getting a Folder Name",description:"If your VBA procedure needs to ask the user for a filename, you could use the InputBox function.",source:"@site/docs/vba/26-vba-other-dialog.md",sourceDirName:".",slug:"/vba-other-dialog",permalink:"/vba/vba-other-dialog",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:26,frontMatter:{title:"VBA GetOpenFilename, GetSaveAsFilename and Getting a Folder Name",tags:["VBA"],permalink:"/vba/other-dialogs/"},sidebar:"tutorialSidebar",previous:{title:"VBA InputBox Function",permalink:"/vba/vba-inputbox-function"},next:{title:"VBA UserForms",permalink:"/vba/vba-userform"}},s={},p=[{value:"Syntax for the GetOpenFilename method",id:"syntax-for-the-getopenfilename-method",level:2},{value:"A GetOpenFilename example",id:"a-getopenfilename-example",level:2},{value:"GetSaveAsFilename Method",id:"getsaveasfilename-method",level:2},{value:"Getting a Folder Name",id:"getting-a-folder-name",level:2}],m={toc:p};function u(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"If your VBA procedure needs to ask the user for a filename, you could use the ",(0,l.kt)("em",{parentName:"p"},"InputBox")," function. "),(0,l.kt)("p",null,"An input box usually isn\u2019t the best tool for this job, however, because most users find it difficult to remember paths, backslashes, filenames, and file extensions. "),(0,l.kt)("p",null,"In other words, it\u2019s far too easy to make a ",(0,l.kt)("strong",{parentName:"p"},"typographical error")," when typing a filename."),(0,l.kt)("p",null,"For a better solution to this problem, use the ",(0,l.kt)("strong",{parentName:"p"},"GetOpenFilename")," method of the Application object, which ensures that your code gets its hands on a valid filename, including its complete path. "),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"GetOpenFilename")," method displays the familiar Open dialog box."),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"GetOpenFilename")," method doesn\u2019t actually open the specified file. "),(0,l.kt)("p",null,"This method simply returns the user-selected filename as a ",(0,l.kt)("inlineCode",{parentName:"p"},"string"),". "),(0,l.kt)("p",null,"Then you can write code to do whatever you want with the filename."),(0,l.kt)("h2",{id:"syntax-for-the-getopenfilename-method"},"Syntax for the GetOpenFilename method"),(0,l.kt)("p",null,"The official syntax for the ",(0,l.kt)("strong",{parentName:"p"},"GetOpenFilename")," method is as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' The GetOpenFilename method syntax\nobject.GetOpenFilename ([fileFilter], [filterIndex], [title],[buttonText], [multiSelect])\n")),(0,l.kt)("p",null,"The GetOpenFilename method takes the optional arguments shown in below Table."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Arguments"),(0,l.kt)("th",{parentName:"tr",align:null},"What it does"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"FileFilter"),(0,l.kt)("td",{parentName:"tr",align:null},"Determines the types of files that appear in the dialog box (for example, *.TXT).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"You can specify several different filters from which the user can choose."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"FilterIndex"),(0,l.kt)("td",{parentName:"tr",align:null},"Determines which of the file filters the dialog box displays by default.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Title"),(0,l.kt)("td",{parentName:"tr",align:null},"Specifies the caption for the dialog box\u2019s title bar.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ButtonText"),(0,l.kt)("td",{parentName:"tr",align:null},"Ignored")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"MultiSelect"),(0,l.kt)("td",{parentName:"tr",align:null},"If True, the user can select multiple files.")))),(0,l.kt)("h2",{id:"a-getopenfilename-example"},"A GetOpenFilename example"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"fileFilter")," argument determines what appears in the dialog box\u2019s Files of Type drop-down list. "),(0,l.kt)("p",null,"This argument consists of pairs of file filter strings followed by the wild card file filter specification, with commas separating each part and pair. "),(0,l.kt)("p",null,"If omitted, this argument defaults to the following:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' A GetOpenFilename example\nAll Files (*.*), *.*\n")),(0,l.kt)("p",null,"Notice that this string consists of two parts:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"All Files (*.*)\n")),(0,l.kt)("p",null,"and"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"*.*\n")),(0,l.kt)("p",null,"The first part of this string is the text displayed in the Files of Type dropdown list. "),(0,l.kt)("p",null,"The second part determines which files the dialog box displays. For example, ",(0,l.kt)("em",{parentName:"p"},".")," means all files."),(0,l.kt)("p",null,"The code in the following example brings up a dialog box that asks the user for a filename. "),(0,l.kt)("p",null,"The procedure defines five file filters. "),(0,l.kt)("p",null,"Notice that I use the VBA line continuation sequence to set up the Filter variable; doing so helps simplify this rather complicated argument."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' A GetOpenFilename example\nSub GetImportFileName()\n  Dim Finfo As String\n  Dim FilterIndex As Integer\n  Dim Title As String\n  Dim FileName As Variant\n\n  \'Set up list of file filters\n  If (IsNumeric)NumberOfSheets Then\n  FInfo = "Text Files (*.txt),*.txt," & _\n  "Lotus Files (*.prn),*.prn," & _\n  "Comma Separated Files (*.csv),*.csv," & _\n  "ASCII Files (*.asc),*.asc," & _\n  "All Files (*.*),*.*"\n\n  \'Display *.* by default\n  FilterIndex = 5\n\n  \'Set the dialog box caption\n  Title = "Select a File to Import"\n\n  \'Get the filename\n  FileName = Application.GetOpenFilename (FInfo, FilterIndex, Title)\n\n  \'Handle return info from dialog box\n  If FileName = False Then\n    MsgBox "No file was selected."\n  Else\n    MsgBox "You selected " & FileName\n  End If\nEnd Sub\n')),(0,l.kt)("p",null,"Notice that the ",(0,l.kt)("inlineCode",{parentName:"p"},"FileName")," variable is declared as a Variant data type. "),(0,l.kt)("p",null,"If the user clicks ",(0,l.kt)("inlineCode",{parentName:"p"},"Cancel"),", that variable contains a Boolean value (False). "),(0,l.kt)("p",null,"Otherwise, FileName is a ",(0,l.kt)("inlineCode",{parentName:"p"},"string"),". Therefore, using a Variant data type handles both possibilities."),(0,l.kt)("h2",{id:"getsaveasfilename-method"},"GetSaveAsFilename Method"),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"GetSaveAsFilename")," method works just like the ",(0,l.kt)("em",{parentName:"p"},"GetOpenFilename")," method, but it displays the Save As dialog box rather than its Open dialog box. "),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"GetSaveAsFilename")," method gets a path and filename from the user but doesn\u2019t do anything with it. "),(0,l.kt)("p",null,"It\u2019s up to you to write code that actually saves the file."),(0,l.kt)("p",null,"The syntax for this method follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' The GetSaveAsFilename method syntax\nobject.GetSaveAsFilename ([InitialFilename], [FileFilter], [FilterIndex], [Title], [ButtonText])\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"GetSaveAsFilename")," method takes below arguments, all of which are optional."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Arguments"),(0,l.kt)("th",{parentName:"tr",align:null},"What it does"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"InitialFileName"),(0,l.kt)("td",{parentName:"tr",align:null},"Specifies a default filename that appears in the File Name box.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"FileFilter"),(0,l.kt)("td",{parentName:"tr",align:null},"Determines the types of files that appear in the dialog box (for example, *.TXT).")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"You can specify several different filters from which the user can choose."),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"FilterIndex"),(0,l.kt)("td",{parentName:"tr",align:null},"Determines which of the file filters the dialog box displays by default.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Title"),(0,l.kt)("td",{parentName:"tr",align:null},"Specifies the caption for the dialog box\u2019s title bar.")))),(0,l.kt)("h2",{id:"getting-a-folder-name"},"Getting a Folder Name"),(0,l.kt)("p",null,"Sometimes, you don\u2019t need to get a filename; you just need to get a folder name. "),(0,l.kt)("p",null,"If that\u2019s the case, the ",(0,l.kt)("em",{parentName:"p"},"FileDialog")," object is just what the doctor ordered."),(0,l.kt)("p",null,"The following procedure displays a dialog box that allows the user to select a directory. "),(0,l.kt)("p",null,"The selected directory name (or \u201cCanceled\u201d) is then displayed by using the ",(0,l.kt)("inlineCode",{parentName:"p"},"MsgBox")," function."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' FileDialog example\nSub GetAFolder()\n  With Application.FileDialog(msoFileDialogFolderPicker)\n    .InitialFileName = Application.DefaultFilePath & "\\"\n    .Title = "Please select a location for the backup"\n    .Show\n    If .SelectedItems.Count = 0 Then\n      MsgBox "Canceled"\n    Else\n      MsgBox .SelectedItems(1)\n    End If\n  End With\nEnd Sub\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("em",{parentName:"p"},"FileDialog")," object lets you specify the starting directory by specifying a value for the InitialFileName property. "),(0,l.kt)("p",null,"In this case, the code uses default file path as the starting directory."),(0,l.kt)("p",null,"Next post will be about ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"VBA UserForms")),"."))}u.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[4715],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,k=c["".concat(s,".").concat(m)]||c[m]||d[m]||a;return n?o.createElement(k,i(i({ref:t},u),{},{components:n})):o.createElement(k,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},30612:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),i=["components"],l={categories:"Solidworks-C++-API",title:"Open Solidworks Part Document",tags:["Solidworks C++ API"],permalink:"/solidworks-cpp/open-part-document/",id:"open-part-document"},s=void 0,p={unversionedId:"open-part-document",id:"open-part-document",title:"Open Solidworks Part Document",description:"In this post, I tell you about how to Open Solidworks Part Document using Solidworks C++ API from Visual Studio.",source:"@site/docs/solidworks-cpp/001.4-open-part-document.md",sourceDirName:".",slug:"/open-part-document",permalink:"/solidworks-cpp/open-part-document",draft:!1,tags:[{label:"Solidworks C++ API",permalink:"/solidworks-cpp/tags/solidworks-c-api"}],version:"current",frontMatter:{categories:"Solidworks-C++-API",title:"Open Solidworks Part Document",tags:["Solidworks C++ API"],permalink:"/solidworks-cpp/open-part-document/",id:"open-part-document"},sidebar:"tutorialSidebar",previous:{title:"Open Solidworks & Hello World",permalink:"/solidworks-cpp/open-solidworks"},next:{title:"Browse and Open Solidworks Document",permalink:"/solidworks-cpp/browse-and-open-document"}},u={},d=[{value:"Video of Code on YouTube",id:"video-of-code-on-youtube",level:2},{value:"Create a New project",id:"create-a-new-project",level:2},{value:"Add Source file",id:"add-source-file",level:2},{value:"Add References to Solidworks Type Library files",id:"add-references-to-solidworks-type-library-files",level:2},{value:"Add Code to Source file",id:"add-code-to-source-file",level:2},{value:"Final Result",id:"final-result",level:2},{value:"Issues and Solutions",id:"issues-and-solutions",level:2}],c={toc:d};function m(e){var t=e.components,l=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this post, I tell you about ",(0,a.kt)("strong",{parentName:"p"},"how to Open Solidworks Part Document using Solidworks C++ API")," from Visual Studio."),(0,a.kt)("p",null,"I hope you have setup Visual Studio community version."),(0,a.kt)("p",null,"If not then please go to \ud83d\ude80 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/cpp-prerequisite/"},"Solidworks C++ API - Prerequisite"))," post and watch the suggested videos before proceeding further."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"video-of-code-on-youtube"},"Video of Code on YouTube"),(0,a.kt)("p",null,"Please see below video on ",(0,a.kt)("strong",{parentName:"p"},"how to Open Solidworks Part Document using Solidworks C++ API")," from Visual Studio."),(0,a.kt)("iframe",{src:"https://www.youtube.com/embed/DBESb0ZGnGc",frameborder:"0",allowfullscreen:!0,width:"100%",height:"500"}),(0,a.kt)("p",null,"Please note that there are ",(0,a.kt)("strong",{parentName:"p"},"no explaination")," in the video. "),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Explaination")," of each line and why we write code this way is given in this post."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"create-a-new-project"},"Create a New project"),(0,a.kt)("p",null,"Fist, we will create a new project in Visual Studio."),(0,a.kt)("p",null,"As shown in below image I have created a new project named ",(0,a.kt)("inlineCode",{parentName:"p"},"OpenPartDocument")," in Visual Studio."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"new-project-window",src:n(70900).Z,width:"785",height:"448"})),(0,a.kt)("p",null,"If you want to know more detail for Creating a New Project in Visual Studio, please visit \ud83d\ude80 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/open-solidworks#create-a-new-project"},"Create a New project"))," section of \ud83d\ude80 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/open-solidworks"},"Solidworks C++ API - Open Solidworks & Hello World"))," post."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"add-source-file"},"Add Source file"),(0,a.kt)("p",null,"After creating a new project, we need to Add Source file to our project."),(0,a.kt)("p",null,'I have already explain each steps taken to create/add a "',(0,a.kt)("strong",{parentName:"p"},"Source.cpp"),'" into our project in \ud83d\ude80 ',(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/open-solidworks#add-source-file"},"Add Source file"))," section of \ud83d\ude80 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/open-solidworks"},"Solidworks C++ API - Open Solidworks & Hello World"))," post."),(0,a.kt)("p",null,'This will add "',(0,a.kt)("strong",{parentName:"p"},"Source.cpp"),'" file into our project.'),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"add-references-to-solidworks-type-library-files"},"Add References to Solidworks Type Library files"),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"This section is copy/paste from \ud83d\ude80 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/solidworks-cpp/open-solidworks"},"Solidworks C++ API - Open Solidworks & Hello World"))," post."))),(0,a.kt)("p",null,"Now we need to ",(0,a.kt)("em",{parentName:"p"},"add References to Solidworks Type Library files.")),(0,a.kt)("p",null,"For this please follow below steps."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select the ",(0,a.kt)("strong",{parentName:"p"},"OpenSolidworkTest")," project and and ",(0,a.kt)("em",{parentName:"p"},"Click Right Mouse Button (RMB)"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"By doing this ",(0,a.kt)("em",{parentName:"p"},"a context menu")," is appear as shown in below image.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"From this ",(0,a.kt)("em",{parentName:"p"},"context menu"),", select ",(0,a.kt)("strong",{parentName:"p"},'"Properties"')," option, which is the last one, as shown in below image."))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"open-property-window",src:n(87243).Z,width:"634",height:"738"})),(0,a.kt)("p",null,"This will open a new window as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"project-property-window",src:n(95115).Z,width:"824",height:"560"})),(0,a.kt)("p",null,"Now following below steps:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select C/C++ option")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Add SOLIDWORKS folders path to 2nd Red colored box as shown in below image. Usually this path is "',(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"C:\\Program Files\\ Solidworks Corp\\SOLIDWORKS")),'" if installed in default location.'))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"add-solidowrks-reference",src:n(22603).Z,width:"825",height:"562"})),(0,a.kt)("p",null,'After adding the folder path, select "',(0,a.kt)("strong",{parentName:"p"},"Apply"),'" button.'),(0,a.kt)("p",null,"This complete the process of ",(0,a.kt)("em",{parentName:"p"},"adding References to Solidworks Type Library files.")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"add-code-to-source-file"},"Add Code to Source file"),(0,a.kt)("p",null,"Now we need to add to ",(0,a.kt)("em",{parentName:"p"},"Source.cpp")," file."),(0,a.kt)("p",null,"Please copy the below code sample to your ",(0,a.kt)("em",{parentName:"p"},"Source.cpp")," file."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp",metastring:"showLineNumbers",showLineNumbers:!0},'#include <atlbase.h>\n\n#import "sldworks.tlb" raw_interfaces_only, raw_native_types, no_namespace, named_guids  // SOLIDWORKS type library\n\n#import "swconst.tlb" raw_interfaces_only, raw_native_types, no_namespace, named_guids   // SOLIDWORKS constants type library\n\nint main()\n{\n    // Initialize COM\n    // Do this before using ATL smart pointers so COM is available.\n    CoInitialize(NULL);\n\n    // Use a block, so the smart pointers are destructed when the scope of this block is left\n    {\n        // COM Pointer of Soldiworks object\n        CComPtr<ISldWorks> swApp;\n\n        // COM Pointer of Soldiworks Model Document\n        CComPtr<IModelDoc2> swDoc;\n\n        // Variable to check if function is \n        HRESULT result = NOERROR;\n\n        // COM Style String for message to user\n        CComBSTR _messageToUser;\n\n        // long type variable to store the result value by user\n        long _lMessageResult;\n\n        // Create an instance of Solidworks application\n        // If it fails then return 0 and close program\n        if (swApp.CoCreateInstance(__uuidof(SldWorks), NULL, CLSCTX_LOCAL_SERVER) != S_OK) \n        {\n            // Stop COM \n            CoUninitialize();\n            return(0);\n        }\n\n        // COM Style String to store document type\n        CComBSTR _documentType;\n\n        // Get the Default Part document\n        swApp->GetUserPreferenceStringValue(swUserPreferenceStringValue_e::swDefaultTemplatePart, &_documentType);\n\n        // Create a new Part Document \n        result = swApp->INewDocument2(_documentType, 0, 0, 0, &swDoc);\n\n        // If there are no Default Part document assign then show a message to user\n        // and Stop COM, Visible the Solidworks and return the function\n        if (result != S_OK)\n        {\n            // COM Style String for message to user\n            _messageToUser = (L"Failed to open document.\\nPlease try again.");\n\n            // Send a message to user and store the return value in _lMessageResult by referencing it\n            swApp->SendMsgToUser2(_messageToUser, swMessageBoxIcon_e::swMbInformation, swMessageBoxBtn_e::swMbOk, &_lMessageResult);\n\n            // Visible the Solidworks\n            swApp->put_Visible(VARIANT_TRUE);\n\n            // Stop COM \n            CoUninitialize();\n            return(0);\n        }\n\n        // If created successfully, then visible the Solidworks\n        swApp->put_Visible(VARIANT_TRUE);\n    }\n\n    // Stop COM \n    CoUninitialize();\n}\n')),(0,a.kt)("p",null,"Now Build the Solution as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"build-solution",src:n(34062).Z,width:"648",height:"166"})),(0,a.kt)("p",null,"After Building Solution run the program by pressing ",(0,a.kt)("strong",{parentName:"p"},"F5"),"."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"final-result"},"Final Result"),(0,a.kt)("p",null,"After running the program wait for few minute."),(0,a.kt)("p",null,"You will get result as shown in below image!!!"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"open-part-window",src:n(8762).Z,width:"1080",height:"584"})),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"issues-and-solutions"},"Issues and Solutions"),(0,a.kt)("p",null,"There are some issues I can think of which might be come to some people."),(0,a.kt)("p",null,"Those are as follows:"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue 1:")),(0,a.kt)("p",null,"Program closed without open Solidworks!"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")),(0,a.kt)("p",null,"I you face this issue, then open Solidworks Manually one time, close it and then run the program."),(0,a.kt)("p",null,"It will solve this issue."),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue 2:")),(0,a.kt)("p",null,"Program unable to create Part Document."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")),(0,a.kt)("p",null,"This is a tricky one!!!"),(0,a.kt)("p",null,'If you face this issue, then you need to confirm in Solidworks that you have assigned the "default Part template".'),(0,a.kt)("p",null,"Please refer to below image for proper setting to fix this issue."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"default-template-locations",src:n(92207).Z,width:"866",height:"614"})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"I hope this will helpful!!!"))),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"This is it !!!"))),(0,a.kt)("p",null,"We have completed our ",(0,a.kt)("em",{parentName:"p"},"Open Part Document")," program in ",(0,a.kt)("em",{parentName:"p"},"Solidworks")," using ",(0,a.kt)("strong",{parentName:"p"},"Solidworks C++ APIs"),"."),(0,a.kt)("p",null,"Hope this post helps you to start with ",(0,a.kt)("em",{parentName:"p"},"Solidworks C++ API"),"."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"If you like the post then please share it with your friends also.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Do let me know by you like this post or not! I will continue creating Solidworks C++ posts.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Till then, Happy learning!!!")))}m.isMDXComponent=!0},92207:function(e,t,n){t.Z=n.p+"assets/images/default-template-locations-abf74a769182507e4b234c14c5bc8c75.png"},70900:function(e,t,n){t.Z=n.p+"assets/images/new-project-window-de59822283fe5ca841a16722957d5604.png"},8762:function(e,t,n){t.Z=n.p+"assets/images/open-part-window-c644dafb267abcd0b776b8c1946e290c.png"},22603:function(e,t,n){t.Z=n.p+"assets/images/add-solidowrks-reference-1a1ca5269a89c20dcf68687bed4f57f1.png"},34062:function(e,t,n){t.Z=n.p+"assets/images/build-solution-588c7601214b803be92cd586a148bb2e.png"},87243:function(e,t,n){t.Z=n.p+"assets/images/open-property-window-fbed5c07225a50d940c99768ebb68f86.png"},95115:function(e,t,n){t.Z=n.p+"assets/images/project-property-window-71bcffa26b32a7297231b56e5ae5d052.png"}}]);
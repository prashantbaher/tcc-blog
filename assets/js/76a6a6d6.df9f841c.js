"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[4234],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=o.createContext({}),s=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=s(e.components);return o.createElement(u.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=s(n),d=a,m=c["".concat(u,".").concat(d)]||c[d]||h[d]||i;return n?o.createElement(m,r(r({ref:t},p),{},{components:n})):o.createElement(m,r({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=c;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},69221:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return h}});var o=n(87462),a=n(63366),i=(n(67294),n(3905)),r=["components"],l={title:"VBA Debugger",tags:["VBA"],permalink:"/vba/debugger/"},u=void 0,s={unversionedId:"vba-debugger",id:"vba-debugger",title:"VBA Debugger",description:"In this section, I discuss the details of using the VBA debugging tools.",source:"@site/docs/vba/21-vba-debugger.md",sourceDirName:".",slug:"/vba-debugger",permalink:"/vba/vba-debugger",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:21,frontMatter:{title:"VBA Debugger",tags:["VBA"],permalink:"/vba/debugger/"},sidebar:"tutorialSidebar",previous:{title:"Bug Finding",permalink:"/vba/vba-bug-finding"},next:{title:"VBA Bug Reduction Tips",permalink:"/vba/vba-bug-reduction-tips"}},p={},h=[{value:"Setting breakpoints in your code",id:"setting-breakpoints-in-your-code",level:2},{value:"Using the Immediate window",id:"using-the-immediate-window",level:3},{value:"Stepping through your code",id:"stepping-through-your-code",level:3},{value:"Using the Watch window",id:"using-the-watch-window",level:2},{value:"Using the Locals window",id:"using-the-locals-window",level:2}],c={toc:h};function d(e){var t=e.components,l=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"In this section, I discuss the details of using the VBA debugging tools. "),(0,i.kt)("p",null,"These tools are much more powerful than the techniques I discuss in the previous section. "),(0,i.kt)("p",null,"But along with power comes responsibility. Using the debugging tools takes a bit of setup work."),(0,i.kt)("h2",{id:"setting-breakpoints-in-your-code"},"Setting breakpoints in your code"),(0,i.kt)("p",null,"In earlier sections, I discuss using ",(0,i.kt)("inlineCode",{parentName:"p"},"MsgBox")," functions in your code to monitor the values of certain variables. "),(0,i.kt)("p",null,"Displaying a message box essentially halts your code in mid-execution, and clicking the ",(0,i.kt)("strong",{parentName:"p"},"OK")," button resumes execution."),(0,i.kt)("p",null,"Wouldn\u2019t it be nice if you could halt a routine\u2019s execution, take a look at the value of any of your variables, and then continue execution? "),(0,i.kt)("p",null,"Well, that\u2019s exactly what you can do by setting a ",(0,i.kt)("em",{parentName:"p"},"breakpoint"),". "),(0,i.kt)("p",null,"You can set a ",(0,i.kt)("em",{parentName:"p"},"breakpoint")," in your VBA code in several ways:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Move the cursor to the statement at which you want execution to stop; then press ",(0,i.kt)("inlineCode",{parentName:"li"},"F9"),"."),(0,i.kt)("li",{parentName:"ul"},"Click in the ",(0,i.kt)("em",{parentName:"li"},"gray")," margin to the left of the statement at which you want execution to stop. ",(0,i.kt)("em",{parentName:"li"},"This is I used mainly.")),(0,i.kt)("li",{parentName:"ul"},"Position the insertion point in the statement at which you want execution to stop. Then use the ",(0,i.kt)("strong",{parentName:"li"},"Debug -> Toggle Breakpoint")," command."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Right-click")," a statement and choose ",(0,i.kt)("strong",{parentName:"li"},"Toggle -> Breakpoint")," from the shortcut menu.")),(0,i.kt)("p",null,"The results of setting a breakpoint are shown in below figure. "),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"VBE")," highlights the line to remind you that you set a breakpoint there; it also inserts a large dot in the gray margin."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Breakpoint-in-procedure",src:n(77386).Z,width:"1351",height:"701"})),(0,i.kt)("p",null,"When you execute the procedure, VBE goes into Break mode before the line with the breakpoint is executed. "),(0,i.kt)("p",null,"In ",(0,i.kt)("em",{parentName:"p"},"Break mode"),", the word ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"break"))," is displayed in the VBE title bar. "),(0,i.kt)("p",null,"To get out of Break mode and continue execution, press ",(0,i.kt)("inlineCode",{parentName:"p"},"F5")," or click the ",(0,i.kt)("strong",{parentName:"p"},"Run Sub/UserForm")," button in the VBE toolbar."),(0,i.kt)("p",null,"To quickly remove a breakpoint, click the large dot in the gray margin or move the cursor to the highlighted line and press ",(0,i.kt)("inlineCode",{parentName:"p"},"F9"),". "),(0,i.kt)("p",null,"To remove all breakpoints in the module, press ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl+Shift+F9"),"."),(0,i.kt)("p",null,"What is Break mode? You can think of it as a state of suspended animation. "),(0,i.kt)("p",null,"Your VBA code stops running and the current statement is highlighted in bright yellow. In Break mode, you can"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type VBA statements in the ",(0,i.kt)("em",{parentName:"li"},"Immediate window"),"."),(0,i.kt)("li",{parentName:"ul"},"Press ",(0,i.kt)("inlineCode",{parentName:"li"},"F8")," to step through your code one line at a time to check various things while the program is paused."),(0,i.kt)("li",{parentName:"ul"},"Move the mouse pointer over a variable to display its value in a small pop-up window."),(0,i.kt)("li",{parentName:"ul"},"Skip the next statement(s) and continue execution there (or even go back a couple of statements)."),(0,i.kt)("li",{parentName:"ul"},"Edit a statement and then continue.")),(0,i.kt)("p",null,"Below figure shows some debugging action. "),(0,i.kt)("p",null,"A breakpoint is set (notice the big dot), and I\u2019m using the ",(0,i.kt)("inlineCode",{parentName:"p"},"F8")," key to step through the code line by line (notice the arrow that points to the current statement). "),(0,i.kt)("p",null,"I used the ",(0,i.kt)("em",{parentName:"p"},"Immediate window")," to print ",(0,i.kt)("inlineCode",{parentName:"p"},"Hello world"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Break-mode",src:n(3268).Z,width:"1366",height:"729"})),(0,i.kt)("h3",{id:"using-the-immediate-window"},"Using the Immediate window"),(0,i.kt)("p",null,"The ",(0,i.kt)("em",{parentName:"p"},"Immediate window")," may not be visible in the VBE. "),(0,i.kt)("p",null,"You can display the VBE\u2019s ",(0,i.kt)("em",{parentName:"p"},"Immediate window")," at any time by pressing ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl+G"),"."),(0,i.kt)("p",null,"In Break mode, the Immediate window is particularly useful for finding the current value of any variable in your program. "),(0,i.kt)("p",null,"For example, if you want to know the current value of a variable, enter the following in the Immediate window and press ",(0,i.kt)("inlineCode",{parentName:"p"},"Enter"),"."),(0,i.kt)("p",null,"The Immediate window lets you do other things besides check variable values. "),(0,i.kt)("p",null,"For example, you can change the value of a variable, try for a new condition. "),(0,i.kt)("p",null,"Just make sure that the command you enter is a valid VBA statement."),(0,i.kt)("h3",{id:"stepping-through-your-code"},"Stepping through your code"),(0,i.kt)("p",null,"While in ",(0,i.kt)("em",{parentName:"p"},"Break mode"),", you can also step through your code line by line. "),(0,i.kt)("p",null,"One statement is executed each time you press ",(0,i.kt)("inlineCode",{parentName:"p"},"F8"),". "),(0,i.kt)("p",null,"Throughout this line-by-line execution of your code, you can activate the Immediate window at any time to check the status of your variables."),(0,i.kt)("p",null,"You can use your mouse to change which statement VBA will execute next. "),(0,i.kt)("p",null,"If you put your mouse pointer in the gray margin to the left of the currently highlighted statement (which will usually be yellow), your pointer changes to a right-pointing arrow. "),(0,i.kt)("p",null,"Simply drag your mouse to the statement you want done next and watch that statement turn yellow."),(0,i.kt)("h2",{id:"using-the-watch-window"},"Using the Watch window"),(0,i.kt)("p",null,"In some cases, you may want to know whether a certain variable or expression takes on a particular value. "),(0,i.kt)("p",null,"For example, suppose that a procedure loops through ",(0,i.kt)("strong",{parentName:"p"},"1,000 times"),". "),(0,i.kt)("p",null,"You notice that a problem occurs during the ",(0,i.kt)("strong",{parentName:"p"},"800th")," iteration of the loop. "),(0,i.kt)("p",null,"Well, you could insert a breakpoint in the loop, but that would mean responding to ",(0,i.kt)("strong",{parentName:"p"},"799")," prompts before the code finally gets to the iteration you want to see (and that gets boring real fast). "),(0,i.kt)("p",null,"A more efficient solution involves setting a ",(0,i.kt)("strong",{parentName:"p"},"watch")," expression."),(0,i.kt)("p",null,"For example, you can create a watch expression that puts the procedure into Break mode whenever a certain variable takes on a specific value \u2014 for example, ",(0,i.kt)("inlineCode",{parentName:"p"},"AnyNumber=800"),". "),(0,i.kt)("p",null,"To create a watch expression, choose ",(0,i.kt)("strong",{parentName:"p"},"Debug -> Add Watch")," to display the Add Watch dialog box. See below figure."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Break-mode",src:n(17137).Z,width:"1168",height:"513"})),(0,i.kt)("p",null,"The Add Watch dialog has three parts:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Expression"),": Enter a valid VBA expression or a variable here. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"AnyNumber=900")," or just ",(0,i.kt)("inlineCode",{parentName:"p"},"AnyNumber"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Context"),": Select the procedure and the module you want to watch. Note that you can select All Procedures and All Modules.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Watch Type"),": Select the type of watch by clicking an option button. Your choice here depends on the expression you enter. The first choice, Watch Expression, does not cause a break; it simply displays the expression\u2019s value when a break occurs."))),(0,i.kt)("p",null,"Execute your procedure after setting up your watch expression(s). "),(0,i.kt)("p",null,"Things run normally until your watch expression is satisfied (based on the Watch Type you specified). "),(0,i.kt)("p",null,"When that happens, VBE enters Break mode (you did set the Watch Type to \u201cBreak When Value Is True,\u201d didn\u2019t you?). "),(0,i.kt)("p",null,"From there, you can step through the code or use the Immediate window to debug your code."),(0,i.kt)("p",null,"When you create a watch, VBE displays the Watches window shown in below figure. "),(0,i.kt)("p",null,"This window displays the value of all watches that you\u2019ve defined. "),(0,i.kt)("p",null,"In this figure, when the value hit ",(0,i.kt)("inlineCode",{parentName:"p"},"800"),", which caused VBE to enter Break mode."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Watch-window-dialog-box-with-all-watches",src:n(65658).Z,width:"1170",height:"513"})),(0,i.kt)("p",null,"The best way to understand how this Watch business works is to use it and try various options. "),(0,i.kt)("p",null,"Before long, you\u2019ll probably wonder how you ever got along without it."),(0,i.kt)("h2",{id:"using-the-locals-window"},"Using the Locals window"),(0,i.kt)("p",null,"Another useful debugging aid is the Locals window. "),(0,i.kt)("p",null,"You can show this window by choosing ",(0,i.kt)("strong",{parentName:"p"},"View -> Locals")," Window from the VBE\u2019s menu. "),(0,i.kt)("p",null,"When you are in Break mode, this window will show you a list of all variables that are local to the current procedure (see below figure). "),(0,i.kt)("p",null,"The nice thing about this window is that you don\u2019t have to add a load of watches manually if you want to look at the content of many variables. "),(0,i.kt)("p",null,"The VBE has done all the hard workfor you."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Local-window",src:n(98790).Z,width:"1170",height:"513"})),(0,i.kt)("p",null,"Next post will be about ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"VBA Bug Reduction Tips")),"."))}d.isMDXComponent=!0},77386:function(e,t,n){t.Z=n.p+"assets/images/1.BreakpointInProcedure-86c18379aced3d14fcd490d0d4278c86.PNG"},3268:function(e,t,n){t.Z=n.p+"assets/images/2.BreakMode-fe18fe04e9bd9672d46805e138a7d25d.PNG"},17137:function(e,t,n){t.Z=n.p+"assets/images/3.WatchWindowDialogBox-7226283cec0bbd3205dcdfbdfb90348a.PNG"},65658:function(e,t,n){t.Z=n.p+"assets/images/4.WatchWindowDialogBoxWithAllWatches-1ef197e85847a1d3a9fc510e873f9a70.PNG"},98790:function(e,t,n){t.Z=n.p+"assets/images/5.LocalWindow-3960c15f4074ae124fb1026003c70090.PNG"}}]);
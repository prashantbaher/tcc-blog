"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[8015],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>d});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=o.createContext({}),p=function(e){var t=o.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=p(e.components);return o.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,g=c["".concat(i,".").concat(d)]||c[d]||u[d]||a;return n?o.createElement(g,l(l({ref:t},m),{},{components:n})):o.createElement(g,l({ref:t},m))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=c;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var p=2;p<a;p++)l[p]=n[p];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},33627:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var o=n(87462),r=(n(67294),n(3905));const a={title:"VBA Userforms - Testing Open new Assembly and Drawing document",tags:["VBA Macro Testing"],permalink:"/vba/testing-open-assembly-and-drawing-document-macro/"},l=void 0,s={unversionedId:"testing-open-assembly-and-drawing-document-macro",id:"testing-open-assembly-and-drawing-document-macro",title:"VBA Userforms - Testing Open new Assembly and Drawing document",description:"Introduction",source:"@site/docs/vba/30-testing-open-assembly-and-drawing-document-macro.md",sourceDirName:".",slug:"/testing-open-assembly-and-drawing-document-macro",permalink:"/vba/testing-open-assembly-and-drawing-document-macro",draft:!1,tags:[{label:"VBA Macro Testing",permalink:"/vba/tags/vba-macro-testing"}],version:"current",sidebarPosition:30,frontMatter:{title:"VBA Userforms - Testing Open new Assembly and Drawing document",tags:["VBA Macro Testing"],permalink:"/vba/testing-open-assembly-and-drawing-document-macro/"},sidebar:"tutorialSidebar",previous:{title:"VBA Userforms - Open new Assembly and Drawing document",permalink:"/vba/open-assembly-and-drawing-from-userform"},next:{title:"VBA Userforms - Browse SOLIDWORKS file(s)",permalink:"/vba/browse-solidworks-file"}},i={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Code block to check",id:"code-block-to-check",level:2},{value:"Apply check",id:"apply-check",level:2},{value:"Cause of Error",id:"cause-of-error",level:2}],m={toc:p};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,o.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"In this post, we ",(0,r.kt)("strong",{parentName:"p"},"test")," our ",(0,r.kt)("strong",{parentName:"p"},"Open new Assembly and Drawing document")," code sample."),(0,r.kt)("p",null,"This post is supplement of ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"/vba/open-assembly-and-drawing-from-userform/"},"VBA Userforms - Open new Assembly and Drawing document"))," post."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"Please visit above post before this post."))),(0,r.kt)("p",null,"From ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"/vba/open-assembly-and-drawing-from-userform/"},"VBA Userforms - Open new Assembly and Drawing document"))," post we expect following results :"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Open Assembly"),' document when we select "',(0,r.kt)("em",{parentName:"p"},"Assembly document"),'".')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Open Drawing"),' document when we select "',(0,r.kt)("em",{parentName:"p"},"Drawing document"),'".'))),(0,r.kt)("p",null,"When we run our ",(0,r.kt)("strong",{parentName:"p"},"VBA macro")," we get the expected result."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Now, as a developer, we want to give a thoroughly tested macro/application to our users.")),(0,r.kt)("p",null,"For testing our VBA macro, we apply some checks so that macro perform same at all machine."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"code-block-to-check"},"Code block to check"),(0,r.kt)("p",null,"Below is code block where we want to apply our check."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n\n' Creating variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n' Creating variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n\n' Private function of Open New Part Button \nPrivate Sub OpenDocumentButton_Click()\n\n  ' Setting Solidworks variable to Solidworks application\n  Set swApp = Application.SldWorks\n  \n  ' Creating string type variable for storing default Assembly location\n  Dim defaultTemplate As String\n  \n  If DocumentTypeComboBox.Value = \"Assembly Document\" Then\n    ' Setting value of this string type variable to \"Default Assembly template\"\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly)\n  Else\n    ' Setting value of this string type variable to \"Default drawing template\" without define paper size\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing)\n  End If\n\n  ' Setting Solidworks document to new Assembly document\n  Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n  \n  ' Hiding the Window after opening the selected document\n  OpenDocumentWindow.Hide\n  \n  ' Reset the Index of Combo Box to \"0\" again\n  DocumentTypeComboBox.ListIndex = 0\n    \nEnd Sub\n")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"apply-check"},"Apply check"),(0,r.kt)("p",null,"In above code there is only ",(0,r.kt)("strong",{parentName:"p"},"one")," check we apply."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"We need to check if get the template value or not."))),(0,r.kt)("p",null,"For this, we need to put an ",(0,r.kt)("inlineCode",{parentName:"p"},"If")," condition before opening a new document."),(0,r.kt)("p",null,"Please see below code for condition."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showLineNumbers",showLineNumbers:!0},'\' Checking if we got template path\nIf defaultTemplate = vbNullString Then\n  \' If template path is empty then show message and exit from procedure.\n  MsgBox "Failed to open " + DocumentTypeComboBox.Value + " template."\n  Exit Sub\nEnd If\n')),(0,r.kt)("p",null,"In above code, we check ",(0,r.kt)("em",{parentName:"p"},"if got the template path or not"),"."),(0,r.kt)("p",null,"If template path is ",(0,r.kt)("strong",{parentName:"p"},"empty")," then "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"we ",(0,r.kt)("em",{parentName:"li"},"show a message")," to user as show in below image."),(0,r.kt)("li",{parentName:"ol"},"we ",(0,r.kt)("strong",{parentName:"li"},"end")," our ",(0,r.kt)("inlineCode",{parentName:"li"},"sub")," procedure from here.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"error-message-on-empty-template",src:n(28282).Z,width:"853",height:"465"})),(0,r.kt)("p",null,"After adding our check, procedure has following code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Private function of Open New Part Button\nPrivate Sub OpenDocumentButton_Click()\n\n  \' Setting Solidworks variable to Solidworks application\n  Set swApp = Application.SldWorks\n  \n  \' Creating string type variable for storing default Assembly location\n  Dim defaultTemplate As String\n  \n  If DocumentTypeComboBox.Value = "Assembly Document" Then\n    \' Setting value of this string type variable to "Default Assembly template"\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly)\n  Else\n    \' Setting value of this string type variable to "Default drawing template" without define paper size\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing)\n  End If\n  \n  \' Checking if we got template path\n  If defaultTemplate = vbNullString Then\n    \' If template path is empty then show message and exit from procedure.\n    MsgBox "Failed to open " + DocumentTypeComboBox.Value + " template."\n    Exit Sub\n  End If\n\n  \' Setting Solidworks document to new Assembly document\n  Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n  \n  \' Hiding the Window aft er opening the selected document\n  OpenDocumentWindow.Hide\n  \n  \' Reset the Index of Combo Box to "0" again\n  DocumentTypeComboBox.ListIndex = 0\n    \nEnd Sub\n')),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"cause-of-error"},"Cause of Error"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"You might wondering how can we have such error?")),(0,r.kt)("p",null,"We have this error, if the value of templates path is ",(0,r.kt)("strong",{parentName:"p"},"not set")," in option setting."),(0,r.kt)("p",null,"For reference please see below image."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"default-template-options",src:n(56890).Z,width:"664",height:"490"})),(0,r.kt)("p",null,"As you can see, in my machine these value are already set."),(0,r.kt)("p",null,"But they are empty in case of fresh installation."),(0,r.kt)("p",null,"Hence if someone runs this macro on fresh SOLIDWORKS copy, they might get error message which we give."),(0,r.kt)("hr",null),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"This is it !!!")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"I hope this be will helpful to someone!")),(0,r.kt)("p",null,"If you found anything to ",(0,r.kt)("strong",{parentName:"p"},"add or update"),", please let me know on my ",(0,r.kt)("em",{parentName:"p"},"e-mail")," which is given in bottom."),(0,r.kt)("p",null,"this post helps us to ",(0,r.kt)("strong",{parentName:"p"},"test")," our ",(0,r.kt)("strong",{parentName:"p"},"Open new Assembly and Drawing document")," macro."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"We will see this type of testing of all our macros which we in this website.")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"If you like the post then please share it with your friends also.")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Do let me know by you like this post or not!")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Till then, Happy learning!!!")))}u.isMDXComponent=!0},56890:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/default-template-options-24282151e7bce2afd8c4ada2cf4914d8.png"},28282:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/error-message-on-empty-template-5361cce7e2fbb020fe05519a878ab8b2.png"}}]);
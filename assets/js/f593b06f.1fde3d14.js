"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[2500],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=p(a),d=r,b=c["".concat(s,".").concat(d)]||c[d]||u[d]||i;return a?n.createElement(b,l(l({ref:t},m),{},{components:a})):n.createElement(b,l({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},43994:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={title:"Variable Scope",tags:["VBA"],permalink:"/vba/variable-scope/"},l=void 0,o={unversionedId:"vba-variable-scope",id:"vba-variable-scope",title:"Variable Scope",description:"A variable\u2019s scope determines which modules and procedures can use the variable.",source:"@site/docs/vba/09-vba-variable-scope.md",sourceDirName:".",slug:"/vba-variable-scope",permalink:"/vba/vba-variable-scope",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:9,frontMatter:{title:"Variable Scope",tags:["VBA"],permalink:"/vba/variable-scope/"},sidebar:"tutorialSidebar",previous:{title:"Declaring and Scoping of Variables",permalink:"/vba/vba-declaring-and-scoping-of-variables"},next:{title:"Public, Static and Variable's Life",permalink:"/vba/vba-publc-static-variable-life"}},s={},p=[{value:"Procedure-only Variables",id:"procedure-only-variables",level:2},{value:"Module-only Variables",id:"module-only-variables",level:2}],m={toc:p};function u(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"A ",(0,r.kt)("em",{parentName:"p"},"variable\u2019s")," scope determines which modules and procedures can use the variable."),(0,r.kt)("h2",{id:"procedure-only-variables"},"Procedure-only Variables"),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"lowest")," level of scope for a variable is at the ",(0,r.kt)("strong",{parentName:"p"},"procedure")," level. "),(0,r.kt)("p",null,"A procedure is either a ",(0,r.kt)("inlineCode",{parentName:"p"},"Sub")," or a ",(0,r.kt)("inlineCode",{parentName:"p"},"Function")," procedure. "),(0,r.kt)("p",null,"Variables declared with this scope can be used only in the procedure in which they are declared. "),(0,r.kt)("p",null,"When the procedure ends, the variable no longer exists (it goes to the great big bucket in the sky), and your ",(0,r.kt)("strong",{parentName:"p"},"CAD")," application frees up its memory. "),(0,r.kt)("p",null,"If you execute the procedure again, the variable comes back to life, but its previous value is lost."),(0,r.kt)("p",null,"The most common way to declare a ",(0,r.kt)("em",{parentName:"p"},"procedure-only")," variable is with a ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," statement. "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," doesn\u2019t refer to the mental capacity of the VBA designers. "),(0,r.kt)("p",null,"Rather, it\u2019s an old programming term that\u2019s short for dimension, which simply means you are setting aside memory for a particular variable. "),(0,r.kt)("p",null,"You usually place ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," statements immediately after the ",(0,r.kt)("inlineCode",{parentName:"p"},"Sub")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Function")," statement and before the procedure\u2019s code. "),(0,r.kt)("p",null,"The following example shows some procedure-only variables declared by using ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," statements: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Sub MySub()\n  Dim x As Integer\n  Dim First As Long\n  Dim PartDimension As Single\n  Dim myValue\n' ...[The procedure\u2019s code goes here]...\nEnd Sub \n")),(0,r.kt)("p",null,"Notice that the last ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," statement in the preceding example doesn\u2019t declare a data type; it declares only the variable itself. The effect is that the variable ",(0,r.kt)("inlineCode",{parentName:"p"},"MyValue")," is a ",(0,r.kt)("em",{parentName:"p"},"Variant"),"."),(0,r.kt)("p",null,"By the way, you can also declare several variables with a single ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," statement, as in the following example: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Dim x As Integer, y As Integer, z As Integer\nDim First As Long, Last As Double\n")),(0,r.kt)("p",null,"Unlike some languages, ",(0,r.kt)("strong",{parentName:"p"},"VBA")," doesn\u2019t allow you to declare a ",(0,r.kt)("em",{parentName:"p"},"group")," of variables to be a particular ",(0,r.kt)("em",{parentName:"p"},"data type")," by separating the variables with ",(0,r.kt)("strong",{parentName:"p"},"commas"),". "),(0,r.kt)("p",null,"For example, though valid, the following statement does not declare all the variables as ",(0,r.kt)("em",{parentName:"p"},"Integers"),": "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Dim i, j, k As Integer\n")),(0,r.kt)("p",null,"In this example, only ",(0,r.kt)("inlineCode",{parentName:"p"},"k")," is declared to be an ",(0,r.kt)("em",{parentName:"p"},"Integer"),"; the other variables are declared to be ",(0,r.kt)("em",{parentName:"p"},"Variants"),". "),(0,r.kt)("p",null,"If you declare a variable with ",(0,r.kt)("em",{parentName:"p"},"procedure-only")," scope, other procedures in the same module can use the same variable name, but each instance of the variable is unique to its own procedure."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"In general, variables declared at the ",(0,r.kt)("em",{parentName:"p"},"procedure level")," are the most efficient because ",(0,r.kt)("strong",{parentName:"p"},"VBA")," frees up the memory they use when the procedure ends.")),(0,r.kt)("h2",{id:"module-only-variables"},"Module-only Variables"),(0,r.kt)("p",null,"Sometimes, you want a ",(0,r.kt)("em",{parentName:"p"},"variable")," to be available to ",(0,r.kt)("em",{parentName:"p"},"all procedures")," in a module. "),(0,r.kt)("p",null,"If so, just declare the ",(0,r.kt)("em",{parentName:"p"},"variable")," (using ",(0,r.kt)("inlineCode",{parentName:"p"},"Dim")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Private"),") before the module\u2019s first ",(0,r.kt)("inlineCode",{parentName:"p"},"Sub")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Function")," statement \u2014 outside any procedures. "),(0,r.kt)("p",null,"This is done in the ",(0,r.kt)("strong",{parentName:"p"},"Declarations")," section, at the ",(0,r.kt)("em",{parentName:"p"},"beginning")," of your module. "),(0,r.kt)("p",null,"This is also where the ",(0,r.kt)("inlineCode",{parentName:"p"},"Option Explicit")," statement is located. "),(0,r.kt)("p",null,"Below figure shows how you know when you\u2019re working with the ",(0,r.kt)("strong",{parentName:"p"},"Declarations")," section. "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Variable-Scope-Example",src:a(11087).Z,width:"695",height:"417"})),(0,r.kt)("p",null,"As shown in above image, I want a variable named ",(0,r.kt)("inlineCode",{parentName:"p"},"swApp"),", so that it can available to all procedures in this module. "),(0,r.kt)("p",null,"Hence I declare this variable in ",(0,r.kt)("strong",{parentName:"p"},"Declaration")," section of ",(0,r.kt)("strong",{parentName:"p"},"VBE"),". "),(0,r.kt)("p",null,"Next post wil be about ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Public, Static and Variable's Life")),"."))}u.isMDXComponent=!0},11087:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1.VariableExamples-8d70943c64958fbaf96ca837f6ff063d.PNG"}}]);
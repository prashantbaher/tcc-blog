"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[1403],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return u}});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),p=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},m=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),k=p(a),u=n,h=k["".concat(i,".").concat(u)]||k[u]||d[u]||o;return a?r.createElement(h,s(s({ref:t},m),{},{components:a})):r.createElement(h,s({ref:t},m))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,s=new Array(o);s[0]=k;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:n,s[1]=l;for(var p=2;p<o;p++)s[p]=a[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}k.displayName="MDXCreateElement"},89134:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return i},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var r=a(87462),n=a(63366),o=(a(67294),a(3905)),s=["components"],l={categories:"Solidworks-macro",title:"SOLIDWORKS Macro - Create Threads",permalink:"/solidworks-macros/create-threads/",tags:["Solidworks Macro"],id:"feature-create-thread"},i=void 0,p={unversionedId:"feature-create-thread",id:"feature-create-thread",title:"SOLIDWORKS Macro - Create Threads",description:'This article is an "Intermediate" post and required you to have some knowledge of VBA.',source:"@site/docs/solidworks-macros/017.2-feature-create-thread.md",sourceDirName:".",slug:"/feature-create-thread",permalink:"/solidworks-macros/feature-create-thread",draft:!1,tags:[{label:"Solidworks Macro",permalink:"/solidworks-macros/tags/solidworks-macro"}],version:"current",frontMatter:{categories:"Solidworks-macro",title:"SOLIDWORKS Macro - Create Threads",permalink:"/solidworks-macros/create-threads/",tags:["Solidworks Macro"],id:"feature-create-thread"},sidebar:"tutorialSidebar",previous:{title:"SOLIDWORKS Macro - Create Holes from Hole Wizard",permalink:"/solidworks-macros/feature-create-hole-wizard"},next:{title:"SOLIDWORKS Macro - Create Fillet",permalink:"/solidworks-macros/feature-create-fillet"}},m={},d=[{value:"Objective",id:"objective",level:2},{value:"Steps To Create Thread",id:"steps-to-create-thread",level:2},{value:"Results We Can Get",id:"results-we-can-get",level:2},{value:"Video of Code on YouTube",id:"video-of-code-on-youtube",level:2},{value:"Code Sample",id:"code-sample",level:2},{value:"Prerequisite",id:"prerequisite",level:2},{value:"Steps To Follow",id:"steps-to-follow",level:2},{value:"Creating Global Variables",id:"creating-global-variables",level:3},{value:"Initializing Required Variables",id:"initializing-required-variables",level:3},{value:"Get Cylinder Feature by Traversing Feature Tree",id:"get-cylinder-feature-by-traversing-feature-tree",level:3},{value:"Select top edge of Cylinder Feature",id:"select-top-edge-of-cylinder-feature",level:3},{value:"Create Thread feature using Thread Feature Data",id:"create-thread-feature-using-thread-feature-data",level:3},{value:"Final work",id:"final-work",level:3}],k={toc:d};function u(e){var t=e.components,l=(0,n.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},k,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"  This article is an ",(0,o.kt)("strong",null,'"Intermediate"')," post and required you to have some knowledge of ",(0,o.kt)("strong",null,"VBA"),".\nIf you are following my articles you will notice that till now we were ",(0,o.kt)("strong",null,"hardcoding")," the selections for input parameters.\nBut from this post onward we will take user-inputs.\nIn this article we did not use \ud83d\ude80 ",(0,o.kt)("strong",null,(0,o.kt)("a",{href:"/vba/vba-userform/"},"UserForm"))," for taking inputs, instead we use \ud83d\ude80 ",(0,o.kt)("strong",null,(0,o.kt)("a",{href:"/vba/vba-inputbox-function/"},"Input Box"))," for ",(0,o.kt)("em",null,"value input")," and \ud83d\ude80 ",(0,o.kt)("strong",null,(0,o.kt)("a",{href:"/vba/vba-msgBox-function/"},"Message Box"))," to notify user.\nI hope you will also like this type of tutorials.\nThank you for reading."))),(0,o.kt)("h2",{id:"objective"},"Objective"),(0,o.kt)("p",null,"Objective of this article is to learn ",(0,o.kt)("em",{parentName:"p"},"how to create ",(0,o.kt)("strong",{parentName:"em"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," through SOLIDWORKS VBA Macros")," in SOLIDWORKS."),(0,o.kt)("p",null,"We create ",(0,o.kt)("strong",{parentName:"p"},"Thread Feature")," in 3 steps in general."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Traversing")," through ",(0,o.kt)("strong",{parentName:"li"},"Feature Tree"),"."),(0,o.kt)("li",{parentName:"ol"},"Programmatically select ",(0,o.kt)("strong",{parentName:"li"},"a \ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature"))," from ",(0,o.kt)("strong",{parentName:"li"},"Feature Tree")," named ",(0,o.kt)("strong",{parentName:"li"},"Cylinder"),"."),(0,o.kt)("li",{parentName:"ol"},"Get Cylinder surface of  ",(0,o.kt)("strong",{parentName:"li"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("li",{parentName:"ol"},"Create \ud83d\ude80 ",(0,o.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"},(0,o.kt)("strong",{parentName:"a"},"Thread Feature Definition")),"."),(0,o.kt)("li",{parentName:"ol"},"Create \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," using \ud83d\ude80 ",(0,o.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"},(0,o.kt)("strong",{parentName:"a"},"Thread Feature Definition"))," from method ",(0,o.kt)("inlineCode",{parentName:"li"},"CreateFeature"),".")),(0,o.kt)("p",null,"This method is ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"most updated"))," method, so ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"use this method"))," if you want to create a new ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature")),"."),(0,o.kt)("h2",{id:"steps-to-create-thread"},"Steps To Create Thread"),(0,o.kt)("p",null,"We use following steps to create \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," while writing macro"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Traversing")," through ",(0,o.kt)("strong",{parentName:"li"},"Feature Tree"),"."),(0,o.kt)("li",{parentName:"ol"},"Programmatically select ",(0,o.kt)("strong",{parentName:"li"},"a \ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature"))," from ",(0,o.kt)("strong",{parentName:"li"},"Feature Tree")," named ",(0,o.kt)("strong",{parentName:"li"},"Cylinder"),"."),(0,o.kt)("li",{parentName:"ol"},"Get all Faces of ",(0,o.kt)("strong",{parentName:"li"},"Cylinder"),"."),(0,o.kt)("li",{parentName:"ol"},"Get Cylinder \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html"},"Surface"))," of selected ",(0,o.kt)("strong",{parentName:"li"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("li",{parentName:"ol"},"Select the top \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html"},"Edge"))," of Cylinder \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isurface_members.html"},"Surface")),"."),(0,o.kt)("li",{parentName:"ol"},"Create \ud83d\ude80 ",(0,o.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"},(0,o.kt)("strong",{parentName:"a"},"Thread Feature Definition")),"."),(0,o.kt)("li",{parentName:"ol"},"Create \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," using \ud83d\ude80 ",(0,o.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"},(0,o.kt)("strong",{parentName:"a"},"Thread Feature Definition"))," from method ",(0,o.kt)("inlineCode",{parentName:"li"},"CreateFeature"),".")),(0,o.kt)("h2",{id:"results-we-can-get"},"Results We Can Get"),(0,o.kt)("p",null,"After running our we successfully create ",(0,o.kt)("strong",{parentName:"p"},"Hole feature")," as a result."),(0,o.kt)("p",null,"Below image shows the result we get."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:a(45552).Z},(0,o.kt)("img",{alt:"threads-final-result",src:a(47878).Z,width:"1366",height:"549"}))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"To get the correct result please follow the steps correctly."))),(0,o.kt)("h2",{id:"video-of-code-on-youtube"},"Video of Code on YouTube"),(0,o.kt)("p",null,"Please see below \ud83c\udfac video on ",(0,o.kt)("strong",{parentName:"p"},"how to create Thread feature")," from SOLIDWORKS VBA Macros."),(0,o.kt)("iframe",{src:"https://www.youtube.com/embed/T5OgoBBULDU",frameborder:"0",allowfullscreen:!0,width:"100%",height:"500"}),(0,o.kt)("p",null,"Please note that there are ",(0,o.kt)("strong",{parentName:"p"},"no explanation")," in the video. "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Explanation")," of each line and why we write code this way is given in this post."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"It is advisable to watch video, since it help you to better understand the process."))),(0,o.kt)("h2",{id:"code-sample"},"Code Sample"),(0,o.kt)("p",null,"Below is the ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," for creating ",(0,o.kt)("em",{parentName:"p"},"Thread Feature")," feature in ",(0,o.kt)("strong",{parentName:"p"},"VBA")," is given."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n\n' Solidworks application variable\nDim swApp As SldWorks.SldWorks\n\n' Solidworks document variable\nDim swDoc As SldWorks.ModelDoc2\n\n' Solidworks Thread feature data variable\nDim swThreadFeatData As SldWorks.ThreadFeatureData\n\n' Solidworks Thread Feature variable\nDim swThreadFeature As SldWorks.Feature\n\n' Solidworks Feature variable\nDim swFeature As SldWorks.Feature\n\n' Solidworks Face variable\nDim swFace As SldWorks.Face2\n\n' Solidworks Surface variable\nDim swSurface As SldWorks.Surface\n\n' Solidworks Entity variable\nDim swEnt As SldWorks.Entity\n\n' Variable for Solidworks Edges\nDim swEdges As Variant\n\n' Solidworks Edge variable\nDim swEdge As SldWorks.Edge\n\n' Array for Solidworks Faces\nDim faceArray As Variant\n\n' Variable for Solidworks Face\nDim eachFace As Variant\n\n' Boolean variable\nDim boolStatus As Boolean\n\n' Main program for Thread\nSub main()\n\n  ' Set Solidworks application variable to current application\n  Set swApp = Application.SldWorks\n  \n  ' Check if Solidworks is opened or not\n  If swApp Is Nothing Then\n    MsgBox (\"Solidworks is not opened\")\n    Exit Sub\n  End If\n  \n  ' Set Solidworks document variable to open document\n  Set swDoc = swApp.ActiveDoc\n  \n  ' Check if Solidworks document is opened or not\n  If swDoc Is Nothing Then\n    MsgBox (\"Solidworks document is not opened. Please open a document.\")\n    Exit Sub\n  End If\n  \n  ' Get First feature in Feature tree\n  Set swFeature = swDoc.FirstFeature\n  \n  ' Check if Solidworks document is selected or not\n  If swFeature Is Nothing Then\n    MsgBox (\"Failed to selected First feature in Feature Tree.\")\n    Exit Sub\n  End If\n  \n  ' Traversing through the Feature Tree,\n  ' until Feature name is \"Cylinder\"\n  While swFeature.Name <> \"Cylinder\"\n    \n    ' Print current Feature name is Immediate window\n    Debug.Print swFeature.Name\n    \n    ' Get the next feature\n    Set swFeature = swFeature.GetNextFeature\n  Wend\n  \n  ' Print current Feature name is Immediate window\n  Debug.Print swFeature.Name\n  \n  ' Get the faces of selected feature\n  faceArray = swFeature.GetFaces\n\n  ' Loop through all Face array\n  For Each eachFace In faceArray\n  \n    ' Set Solidworks Face variable to current current\n    Set swFace = eachFace\n    \n    ' Get the Surface of from the Solidworks Face variable\n    Set swSurface = swFace.GetSurface\n    \n    ' If we have cylinder surface\n    If swSurface.IsCylinder() Then\n    \n      ' Get all edges of this face\n      swEdges = swFace.GetEdges\n      \n      ' Set Solidworks edge variable to 1st edge\n      Set swEdge = swEdges(0)\n      \n      ' Set Solidworks Entity variable to Solidworks Edge variable\n      Set swEnt = swEdge\n      \n      ' Select the current entity\n      boolStatus = swEnt.Select(True)\n      \n      ' If fail to select the edge then inform user\n      If boolStatus = False Then\n        MsgBox \"Failed to select Edge of Cylinder.\"\n        Exit Sub\n      End If\n      \n    End If\n  Next\n  \n  ' Create Thread feature data\n  Set swThreadFeatData = swDoc.FeatureManager.CreateDefinition(swFeatureNameID_e.swFmSweepThread)\n  \n  ' Create Thread Feature\n  Set swThreadFeature = swDoc.FeatureManager.CreateFeature(swThreadFeatData)\n  \n  ' Check if Thread Feature created or not\n  If swThreadFeature Is Nothing Then\n    MsgBox (\"Failed to create Thread Feature.\")\n    Exit Sub\n  End If\n  \n  ' View zoom to fit\n  swDoc.ViewZoomtofit2\n  \n  ' Clear all selection\n  swDoc.ClearSelection2 True\n    \nEnd Sub\n")),(0,o.kt)("h2",{id:"prerequisite"},"Prerequisite"),(0,o.kt)("p",null,"There are some ",(0,o.kt)("em",{parentName:"p"},"prerequisite")," for this article."),(0,o.kt)("p",null,"We are ",(0,o.kt)("strong",{parentName:"p"},"not")," creating feature from code but we use ",(0,o.kt)("strong",{parentName:"p"},"existing feature")," to create ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," as shown in below picture."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:a(54847).Z},(0,o.kt)("img",{alt:"prerequisite",src:a(60810).Z,width:"1366",height:"549"}))),(0,o.kt)("p",null,"As shown in above image, there only ",(0,o.kt)("em",{parentName:"p"},"1 Extrude feature")," in our part."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Extrude Feature")," : This is our ",(0,o.kt)("strong",{parentName:"li"},"Extrude part")," for ",(0,o.kt)("strong",{parentName:"li"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature")),".")),(0,o.kt)("p",null,"If you want to create ",(0,o.kt)("strong",{parentName:"p"},"Extrude")," feature programmatically then please refer to below article."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/solidworks-macros/feature-create-extrude-boss"},"SOLIDWORKS Macros - Create Extrude/Boss")))),(0,o.kt)("p",null,"Also, we will apply checks in this article, so the code we write should be error free most of the time."),(0,o.kt)("h2",{id:"steps-to-follow"},"Steps To Follow"),(0,o.kt)("p",null,"To create ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature")),", there are following steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Creating Global Variables")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Initializing required variables")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Get Cylinder Feature by Traversing Feature Tree")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Select top edge of Cylinder Feature")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create Thread feature using Thread Feature Data")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Final work"))),(0,o.kt)("p",null,"Now let us walk through ",(0,o.kt)("strong",{parentName:"p"},"each step")," as given above, and ",(0,o.kt)("strong",{parentName:"p"},"understand")," every line."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"I also give some ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"links"))," (see icon \ud83d\ude80 ) so that you can go through them if there are anything I explained in previous articles."))),(0,o.kt)("h3",{id:"creating-global-variables"},"Creating Global Variables"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n")),(0,o.kt)("p",null,"This line forces us to define every variable we are going to use. "),(0,o.kt)("p",null,"For more information please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/solidworks-macros/open-new-document"},"SOLIDWORKS Macros - Open new Part document"))," post."),(0,o.kt)("p",null,"We create following variables."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks application"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n")),(0,o.kt)("p",null,"In this line, we create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swApp")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swApp")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.SldWorks"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.SldWorks")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks document"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n")),(0,o.kt)("p",null,"In this line, we create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.ModelDoc2"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.ModelDoc2")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Thread feature data"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Thread feature data variable\nDim swThreadFeatData As SldWorks.ThreadFeatureData\n")),(0,o.kt)("p",null,"In this line, we create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeatData")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeatData")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.ThreadFeatureData"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.ThreadFeatureData")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateDefinition.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks feature"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Thread Feature variable\nDim swThreadFeature As SldWorks.Feature\n")),(0,o.kt)("p",null,"In this line, we Create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeature")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeature")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Feature"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeature")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Feature"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Feature")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Feature variable"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Feature variable\nDim swFeature As SldWorks.Feature\n")),(0,o.kt)("p",null,"In this line, we Create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Feature"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Feature"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Feature")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Face variable"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Face variable\nDim swFace As SldWorks.Face2\n")),(0,o.kt)("p",null,"In this line, we Create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swFace")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swFace")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Face2"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swFace")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Face"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Face2")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Surface"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Surface variable\nDim swSurface As SldWorks.Surface\n")),(0,o.kt)("p",null,"In this line, we Create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swSurface")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swSurface")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Surface"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swSurface")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Surface"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Surface")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Entity"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Entity variable\nDim swEnt As SldWorks.Entity\n")),(0,o.kt)("p",null,"In this line, we create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swEnt")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swEnt")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Entity"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swEnt")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Entity"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Entity")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Edges"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks Edges\nDim swEdges As Variant\n")),(0,o.kt)("p",null,"In this line, we create a variable named ",(0,o.kt)("inlineCode",{parentName:"p"},"swEdges")," as ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," object type."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swEdges")," for to get all edges of a surface."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Edge"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Solidworks Edge variable\nDim swEdge As SldWorks.Edge\n")),(0,o.kt)("p",null,"In this line, we create a variable which we named as ",(0,o.kt)("inlineCode",{parentName:"p"},"swEdge")," and the type of this ",(0,o.kt)("inlineCode",{parentName:"p"},"swEdge")," variable is ",(0,o.kt)("inlineCode",{parentName:"p"},"SldWorks.Edge"),"."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swEnt")," for ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS Edge"),"."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"Edge")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEdge_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Array for Solidworks Faces"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Array for Solidworks Faces\nDim faceArray As Variant\n")),(0,o.kt)("p",null,"In this line, we create a variable named ",(0,o.kt)("inlineCode",{parentName:"p"},"faceArray")," as ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," object type."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"faceArray")," for to get all face of Cylinder feature."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable for Solidworks Face"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks Face\nDim eachFace As Variant\n")),(0,o.kt)("p",null,"In this line, we create a variable named ",(0,o.kt)("inlineCode",{parentName:"p"},"eachFace")," as ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," object type."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"eachFace")," for to get each face inside ",(0,o.kt)("inlineCode",{parentName:"p"},"faceArray")," array."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Boolean variable"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Boolean variable\nDim boolStatus As Boolean\n")),(0,o.kt)("p",null,"In this line, we create a variable named ",(0,o.kt)("inlineCode",{parentName:"p"},"boolStatus")," as ",(0,o.kt)("inlineCode",{parentName:"p"},"Boolean")," object type."),(0,o.kt)("p",null,"We create variable ",(0,o.kt)("inlineCode",{parentName:"p"},"boolStatus")," to confirm method result."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"These all are our global variables."))),(0,o.kt)("p",null,"They are ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS API Objects"),"."),(0,o.kt)("p",null,"So basically I group all the ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS API Objects")," in one place."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Main program for Thread\nSub main()\n\nEnd Sub\n")),(0,o.kt)("p",null,"Next is our ",(0,o.kt)("inlineCode",{parentName:"p"},"Sub")," procedure which has name of ",(0,o.kt)("inlineCode",{parentName:"p"},"main"),". "),(0,o.kt)("p",null,"This procedure hold all the ",(0,o.kt)("em",{parentName:"p"},"statements (instructions)")," we give to computer."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"To know more about ",(0,o.kt)("strong",{parentName:"p"},"Sub Procedure")," you can check \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-sub-and-function-procedure/"},"VBA Sub and Function Procedures"))," article of this website."))),(0,o.kt)("h3",{id:"initializing-required-variables"},"Initializing Required Variables"),(0,o.kt)("p",null,"Inside this procedure we first initialize required variables as given below."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Set SOLIDWORKS variable to SOLIDWORKS application"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set SOLIDWORKS variable to SOLIDWORKS application\nSet swApp = Application.SldWorks\n")),(0,o.kt)("p",null,"In this line, we set the value of our SOLIDWORKS variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swApp"),"; which we define earlier; to SOLIDWORKS application."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if SOLIDWORKS is opened or not\nIf swApp Is Nothing Then\n  MsgBox ("SOLIDWORKS is not opened")\n  Exit Sub\nEnd If\n')),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if SOLIDWORKS application variable is ",(0,o.kt)("em",{parentName:"p"},"successfully assigned")," to current SOLIDWORKS application."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Set SOLIDWORKS document variable to opened part document"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set SOLIDWORKS document variable to opened part document\nSet swDoc = swApp.ActiveDoc\n")),(0,o.kt)("p",null,"In above line of code, we set SOLIDWORKS document ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable to currently open part document."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if SOLIDWORKS document is opened or not\nIf swDoc Is Nothing Then\n  MsgBox ("SOLIDWORKS document is not opened. Please open a document.")\n  Exit Sub\nEnd If\n')),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if SOLIDWORKS document ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," is opened."),(0,o.kt)("p",null,"If SOLIDWORKS document is not opened then code execute inside the code and inform the user by a \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"Message Window")),"."),(0,o.kt)("h3",{id:"get-cylinder-feature-by-traversing-feature-tree"},"Get Cylinder Feature by Traversing Feature Tree"),(0,o.kt)("p",null,"Now we will get ",(0,o.kt)("strong",{parentName:"p"},"Cylinder")," feature by ",(0,o.kt)("em",{parentName:"p"},"Traversing Feature Tree"),"."),(0,o.kt)("p",null,"Please follow steps given below."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Get First feature in Feature tree"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get First feature in Feature tree\nSet swFeature = swDoc.FirstFeature\n")),(0,o.kt)("p",null,"In above line of code, we set SOLIDWORKS Feature ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature")," variable to ",(0,o.kt)("strong",{parentName:"p"},"first")," feature in ",(0,o.kt)("em",{parentName:"p"},"Feature Tree"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Solidworks document is selected or not\nIf swFeature Is Nothing Then\n  MsgBox ("Failed to selected First feature in Feature Tree.")\n  Exit Sub\nEnd If\n')),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if we get SOLIDWORKS Feature ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature"),"."),(0,o.kt)("p",null,"If we failed to get SOLIDWORKS Feature then code execute inside the code and inform the user by a \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"Message Window")),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Traversing through the Feature Tree,\n\' until Feature name is "Cylinder"\nWhile swFeature.Name <> "Cylinder"\n\nWend\n')),(0,o.kt)("p",null,"In above line of code, we create another ",(0,o.kt)("inlineCode",{parentName:"p"},"While")," loop."),(0,o.kt)("p",null,"This loop will continue until we select the our ",(0,o.kt)("strong",{parentName:"p"},"Cylinder")," ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"For more details about ",(0,o.kt)("inlineCode",{parentName:"p"},"While")," loop, please see \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-looping/"},"VBA Looping"))," article from this website."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Print current Feature name is Immediate window\nDebug.Print swFeature.Name\n")),(0,o.kt)("p",null,"In above line of code, we print ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature"))," name into ",(0,o.kt)("em",{parentName:"p"},"Immediate window"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get the next feature\nSet swFeature = swFeature.GetNextFeature\n")),(0,o.kt)("p",null,"In above line of code, we set ",(0,o.kt)("inlineCode",{parentName:"p"},"swFeature")," variable to next ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Print current Feature name is Immediate window\nDebug.Print swFeature.Name\n")),(0,o.kt)("p",null,"In above line of code, we print ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature"))," name into ",(0,o.kt)("em",{parentName:"p"},"Immediate window"),"."),(0,o.kt)("p",null,"Since this line is outside of ",(0,o.kt)("inlineCode",{parentName:"p"},"While")," loop, it means selected feature is ",(0,o.kt)("strong",{parentName:"p"},"Cylinder")," ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("h3",{id:"select-top-edge-of-cylinder-feature"},"Select top edge of Cylinder Feature"),(0,o.kt)("p",null,"Now we need to select top edge of previously selected ",(0,o.kt)("strong",{parentName:"p"},"Cylinder")," ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("p",null,"Please follow steps given below."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Get the faces of selected feature"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get the faces of selected feature\nfaceArray = swFeature.GetFaces\n")),(0,o.kt)("p",null,"In above line of code we get all faces of selected ",(0,o.kt)("strong",{parentName:"p"},"Cylinder")," ",(0,o.kt)("strong",{parentName:"p"},"\ud83d\ude80 ",(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature_members.html"},"Feature")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Loop through all face array"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Loop through all Face array\nFor Each eachFace In faceArray\n\nNext\n")),(0,o.kt)("p",null,"In above line of code we create a \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-looping/"},"For Each"))," loop."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Get surface of current Face"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks Face variable to current face\nSet swFace = eachFace\n")),(0,o.kt)("p",null,"In above line of code, we Set \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html"},"SOLIDWORKS Face"))," variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swFace")," to current face."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get the Surface of from the Solidworks Face variable\nSet swSurface = swFace.GetSurface\n")),(0,o.kt)("p",null,"In above line of code we get the \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html"},"Surface"))," of from the \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html"},"SOLIDWORKS Face"))," variable using ",(0,o.kt)("inlineCode",{parentName:"p"},"GetSurface")," \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2~GetSurface.html"},"method")),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"If Statement for Cylindrical Surface"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' If we have cylinder surface\nIf swSurface.IsCylinder() Then\n\nEnd If\n")),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISurface_members.html"},"SOLIDWORKS Surface"))," ",(0,o.kt)("inlineCode",{parentName:"p"},"swSurface")," is Cylindrical Surface or not."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Select first edge of Cylindrical Surface"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get all edges of this face\nswEdges = swFace.GetEdges\n")),(0,o.kt)("p",null,"In above line of code we get all edges of current face."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks edge variable to 1st edge\nSet swEdge = swEdges(0)\n")),(0,o.kt)("p",null,"In above line of code we set \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html"},"SOLIDWORKS edge"))," variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swEdge")," to 1st edge."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks Entity variable to Solidworks Edge variable\nSet swEnt = swEdge\n")),(0,o.kt)("p",null,"In above line of code we set \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html"},"SOLIDWORKS Entity"))," variable to \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iedge_members.html"},"SOLIDWORKS edge"))," variable."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Select the current entity\nboolStatus = swEnt.Select(True)\n")),(0,o.kt)("p",null,"In above line of code we select the current entity."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' If fail to select the edge then inform user\nIf boolStatus = False Then\n  MsgBox "Failed to select Edge of Cylinder."\n  Exit Sub\nEnd If\n')),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"Boolean"))," variable ",(0,o.kt)("inlineCode",{parentName:"p"},"boolStatus")," is ",(0,o.kt)("inlineCode",{parentName:"p"},"False"),"."),(0,o.kt)("p",null," If ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"Boolean"))," variable ",(0,o.kt)("inlineCode",{parentName:"p"},"boolStatus")," is ",(0,o.kt)("inlineCode",{parentName:"p"},"False"),". then code execute inside the code and inform the user by a \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"Message Window")),"."),(0,o.kt)("h3",{id:"create-thread-feature-using-thread-feature-data"},"Create Thread feature using Thread Feature Data"),(0,o.kt)("p",null,"We have completed our ",(0,o.kt)("em",{parentName:"p"},"selection")," of \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity_members.html"},"SOLIDWORKS Entity")),"."),(0,o.kt)("p",null,"Now we create Thread Feature."),(0,o.kt)("p",null,"For this we use 2 steps as follows:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create Thread Feature definition")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create Thread Feature using the definition"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Create Thread feature data\nSet swThreadFeatData = swDoc.FeatureManager.CreateDefinition(swFeatureNameID_e.swFmSweepThread)\n")),(0,o.kt)("p",null,"In above line of code we set the value of variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeatData")," by ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateDefinition")," method."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"CreateDefinition")," method is part of ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," object."),(0,o.kt)("p",null,"This ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," is again part of ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"ModelDoc2")," object."),(0,o.kt)("p",null,"This ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateDefinition")," method takes following parameters as explained:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Type")," - ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"Feature name ID")," as defined in ",(0,o.kt)("inlineCode",{parentName:"em"},"swFeatureNameID_e")),"."),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmBoundingBox")," ",(0,o.kt)("em",{parentName:"li"},"(bounding box)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmCirPattern")," ",(0,o.kt)("em",{parentName:"li"},"(circular pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmCurvePattern")," ",(0,o.kt)("em",{parentName:"li"},"(curve-driven pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmDerivedLPattern")," ",(0,o.kt)("em",{parentName:"li"},"(derived-driven pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmDimPattern")," ",(0,o.kt)("em",{parentName:"li"},"(variable/dimension pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmFillPattern")," ",(0,o.kt)("em",{parentName:"li"},"(fill pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmGroundPlane")," ",(0,o.kt)("em",{parentName:"li"},"(ground plane)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLibraryFeature")," ",(0,o.kt)("em",{parentName:"li"},"(library)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLocalChainPattern")," ",(0,o.kt)("em",{parentName:"li"},"(chain component pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLocalCirPattern")," ",(0,o.kt)("em",{parentName:"li"},"(circular component pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLocalCurvePattern")," ",(0,o.kt)("em",{parentName:"li"},"(curve-driven component pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLocalLPattern")," ",(0,o.kt)("em",{parentName:"li"},"(linear component pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLocalSketchPattern")," ",(0,o.kt)("em",{parentName:"li"},"(sketch-driven component pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmLPattern")," ",(0,o.kt)("em",{parentName:"li"},"(linear pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmNormalCut")," ",(0,o.kt)("em",{parentName:"li"},"(sheet metal normal cut)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmRefCurve")," ",(0,o.kt)("em",{parentName:"li"},"(projection curve)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmRefSurface")," ",(0,o.kt)("em",{parentName:"li"},"(surface sweep)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmSketchPattern")," ",(0,o.kt)("em",{parentName:"li"},"(sketch-driven pattern)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmSweep")," ",(0,o.kt)("em",{parentName:"li"},"(boss sweep)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmSweepCut")," ",(0,o.kt)("em",{parentName:"li"},"(cut sweep)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmSweepThread")," ",(0,o.kt)("em",{parentName:"li"},"(Thread)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmTabAndSlot")," ",(0,o.kt)("em",{parentName:"li"},"(tab and slot)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"swFmTablePattern")," ",(0,o.kt)("em",{parentName:"li"},"(table pattern)"))))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Return Value")," : This ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateDefinition")," method retun ",(0,o.kt)("strong",{parentName:"p"},"feature or pattern-specific")," feature data object."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html"},"this page of Solidworks API Help")),"."),(0,o.kt)("p",null,"In our code, I have used following values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Type")," - ",(0,o.kt)("em",{parentName:"li"},"I use ",(0,o.kt)("inlineCode",{parentName:"em"},"swFmSweepThread")," as ",(0,o.kt)("inlineCode",{parentName:"em"},"Feature name ID")),".")),(0,o.kt)("p",null,"If you want to know more information about Sweep Feature data then please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"this page of Solidworks API Help")),"."),(0,o.kt)("p",null,"This page will give you information about various properties and methods of ",(0,o.kt)("inlineCode",{parentName:"p"},"IThreadFeatureData")," Interface."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Create Thread Feature\nSet swThreadFeature = swDoc.FeatureManager.CreateFeature(swThreadFeatData)\n")),(0,o.kt)("p",null,"In above line of code we set the value of variable ",(0,o.kt)("inlineCode",{parentName:"p"},"swThreadFeature")," by ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateFeature")," method."),(0,o.kt)("p",null,"This ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateFeature")," method takes following parameters as explained:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FeatureData")," - ",(0,o.kt)("em",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"em"},"Feature or pattern-specific")," feature data object"),".")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Return Value")," : This ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateFeature")," method return ",(0,o.kt)("strong",{parentName:"p"},"feature")," data object."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"CreateFeature")," method is part of ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," object."),(0,o.kt)("p",null,"This ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," is again part of ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"ModelDoc2")," object."),(0,o.kt)("p",null,"To see methods and properties related to ",(0,o.kt)("inlineCode",{parentName:"p"},"FeatureManager")," object, please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html"},"this page of SOLIDWORKS API Help")),"."),(0,o.kt)("p",null,"In our code, I have used following values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FeatureData")," - ",(0,o.kt)("em",{parentName:"li"},"I use ",(0,o.kt)("inlineCode",{parentName:"em"},"swThreadFeatData")," as feature data object which we defined previously"),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Thread Feature created or not\nIf swThreadFeature Is Nothing Then\n  MsgBox ("Failed to create Thread Feature.")\n  Exit Sub\nEnd If\n')),(0,o.kt)("p",null,"In above line of code, we use an \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," to check if we able to create \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," or not."),(0,o.kt)("p",null,"If we failed to select then inform the user by a \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"Message Window")),"."),(0,o.kt)("p",null,"After showing error message our program ",(0,o.kt)("strong",{parentName:"p"},"exit")," from here itself."),(0,o.kt)("p",null,"Now we run the macro and after running macro we get Revolve as shown in below image."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:a(45552).Z},(0,o.kt)("img",{alt:"threads-final-result",src:a(47878).Z,width:"1366",height:"549"}))),(0,o.kt)("h3",{id:"final-work"},"Final work"),(0,o.kt)("p",null,"After creating \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html"},"Thread Feature"))," , we have to do some cleaning work so that we can use this macro frequently."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Make part Zoom to fit")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' View zoom to fit\nswDoc.ViewZoomtofit2\n")),(0,o.kt)("p",null,"In above line, we make our view zoom to fit the model."),(0,o.kt)("p",null,"For this we use ",(0,o.kt)("inlineCode",{parentName:"p"},"ViewZoomtofit2")," method which is part of ",(0,o.kt)("em",{parentName:"p"},"SOLIDWORKS Document")," variable i.e ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Clear selection")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Clear all selection\nswDoc.ClearSelection2 True\n")),(0,o.kt)("p",null,"In above line, we clear all previous selection."),(0,o.kt)("p",null,"For this we use ",(0,o.kt)("inlineCode",{parentName:"p"},"ClearSelection2")," method which is part of ",(0,o.kt)("em",{parentName:"p"},"SOLIDWORKS Document")," variable i.e ",(0,o.kt)("inlineCode",{parentName:"p"},"swDoc")," variable."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"This is it !!!")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"I hope my efforts will helpful to someone!")),(0,o.kt)("p",null,"If you found anything to ",(0,o.kt)("strong",{parentName:"p"},"add or update"),", please let me know on my ",(0,o.kt)("em",{parentName:"p"},"e-mail"),"."),(0,o.kt)("p",null,"Hope this post helps you to ",(0,o.kt)("strong",{parentName:"p"},"create Threads")," with SOLIDWORKS VBA Macros."),(0,o.kt)("p",null,"For more such tutorials on ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS VBA Macro"),", do come to this blog after sometime."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"If you like the post then please share it with your friends also.")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Do let me know by you like this post or not!")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Till then, Happy learning!!!")))}u.isMDXComponent=!0},54847:function(e,t,a){t.Z=a.p+"assets/files/prerequisite-1f9825f6a0ff4aefab14871f5ba53512.png"},45552:function(e,t,a){t.Z=a.p+"assets/files/threads-final-result-fe803083993a45e2bc095365d4de6eae.png"},60810:function(e,t,a){t.Z=a.p+"assets/images/prerequisite-1f9825f6a0ff4aefab14871f5ba53512.png"},47878:function(e,t,a){t.Z=a.p+"assets/images/threads-final-result-fe803083993a45e2bc095365d4de6eae.png"}}]);
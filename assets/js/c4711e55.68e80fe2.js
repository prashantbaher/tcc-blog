"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[9920],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),c=a,k=u["".concat(p,".").concat(c)]||u[c]||d[c]||r;return n?o.createElement(k,i(i({ref:t},m),{},{components:n})):o.createElement(k,i({ref:t},m))}));function c(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},64020:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var o=n(87462),a=(n(67294),n(3905));const r={title:"VBA Userforms - Open new Assembly and Drawing document",tags:["VBA"],permalink:"/vba/open-assembly-and-drawing-from-userform/"},i=void 0,l={unversionedId:"open-assembly-and-drawing-from-userform",id:"open-assembly-and-drawing-from-userform",title:"VBA Userforms - Open new Assembly and Drawing document",description:"In this post, we learn how can we Open new Assembly and Drawing document from a Visual Basic for Application's Userform.",source:"@site/docs/vba/29-open-assembly-and-drawing-from-userform.md",sourceDirName:".",slug:"/open-assembly-and-drawing-from-userform",permalink:"/vba/open-assembly-and-drawing-from-userform",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:29,frontMatter:{title:"VBA Userforms - Open new Assembly and Drawing document",tags:["VBA"],permalink:"/vba/open-assembly-and-drawing-from-userform/"},sidebar:"tutorialSidebar",previous:{title:"VBA Userforms - Open new Part document",permalink:"/vba/open-part-from-userform"},next:{title:"VBA Userforms - Testing Open new Assembly and Drawing document",permalink:"/vba/testing-open-assembly-and-drawing-document-macro"}},p={},s=[{value:"Video of Code on YouTube",id:"video-of-code-on-youtube",level:2},{value:"Create a new macro",id:"create-a-new-macro",level:2},{value:"Insert userform in the macro",id:"insert-userform-in-the-macro",level:2},{value:"Adding Controls into Userform",id:"adding-controls-into-userform",level:2},{value:"Adding ComboBox",id:"adding-combobox",level:3},{value:"Adding CommandButton",id:"adding-commandbutton",level:3},{value:"Updating Properties",id:"updating-properties",level:2},{value:"Updating Properties of the UserForm",id:"updating-properties-of-the-userform",level:3},{value:"Updating Properties of the ComboBox",id:"updating-properties-of-the-combobox",level:3},{value:"Updating Properties of the Command Button",id:"updating-properties-of-the-command-button",level:3},{value:"Calling UserForm in Main Module",id:"calling-userform-in-main-module",level:2},{value:"Adding Document list",id:"adding-document-list",level:2},{value:"First Test of Macro",id:"first-test-of-macro",level:2},{value:"Add Functionality to Open NewPart Button",id:"add-functionality-to-open-newpart-button",level:2},{value:"Exercise to do",id:"exercise-to-do",level:2}],m={toc:s};function d(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this post, we learn how can we ",(0,a.kt)("strong",{parentName:"p"},"Open new Assembly and Drawing document")," from a Visual Basic for Application's ",(0,a.kt)("strong",{parentName:"p"},"Userform"),"."),(0,a.kt)("p",null,"For this please we need to do following steps as described below."),(0,a.kt)("h2",{id:"video-of-code-on-youtube"},"Video of Code on YouTube"),(0,a.kt)("p",null,"Please see below video how visually we ",(0,a.kt)("em",{parentName:"p"},"Open new Assembly and Drawing document")," in ",(0,a.kt)("strong",{parentName:"p"},"Solidworks VBA macro Userform"),"."),(0,a.kt)("iframe",{src:"https://www.youtube.com/embed/AQ3Fyw78ExI",frameborder:"0",allowfullscreen:!0,width:"100%",height:"500"}),(0,a.kt)("p",null,"Please note that there are ",(0,a.kt)("strong",{parentName:"p"},"no explanation")," in the video. "),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Explanation")," of each line and why we write code this way is given in this post."),(0,a.kt)("h2",{id:"create-a-new-macro"},"Create a new macro"),(0,a.kt)("p",null,"1st we need to create a ",(0,a.kt)("strong",{parentName:"p"},"new macro")," in ",(0,a.kt)("em",{parentName:"p"},"Solidworks 3D CAD Software"),"."),(0,a.kt)("p",null,"If you don't know how to create a new macro in Solidworks, please go to ",(0,a.kt)("a",{parentName:"p",href:"/solidworks-macros/vba-in-solidworks/"},"VBA in Solidworks")," post for this."),(0,a.kt)("p",null,"This will open a new macro in Visual Basic Editor with some code as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"open-new-macro",src:n(78612).Z,width:"1366",height:"738"})," "),(0,a.kt)("h2",{id:"insert-userform-in-the-macro"},"Insert userform in the macro"),(0,a.kt)("p",null,"After this we need to insert ",(0,a.kt)("em",{parentName:"p"},"a userform")," in our macro."),(0,a.kt)("p",null,"For this, select the button shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"insert-userform-into-macro",src:n(22783).Z,width:"1366",height:"738"})),(0,a.kt)("p",null,"This button is called ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"insert userform")),". "),(0,a.kt)("p",null,"As the name suggest, function of this button is ",(0,a.kt)("em",{parentName:"p"},"inserting a userform"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Please note that in a macro we can insert any number of userform as we like. But for this example we insert only 1 userform.")),(0,a.kt)("p",null,"After clicking the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"insert userform"))," button we get the userform window."),(0,a.kt)("h2",{id:"adding-controls-into-userform"},"Adding Controls into Userform"),(0,a.kt)("p",null,"Now in our userform window, we add following controls:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"A ComboBox"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"A CommandButton")))),(0,a.kt)("h3",{id:"adding-combobox"},"Adding ComboBox"),(0,a.kt)("p",null,"You can find ",(0,a.kt)("inlineCode",{parentName:"p"},"ComboBox")," option, as highlighted in ",(0,a.kt)("em",{parentName:"p"},"Red Square")," in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"insert-combox-into-userform",src:n(21994).Z,width:"1368",height:"740"})),(0,a.kt)("p",null,"After adding ComboBox, we get window as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"combobox-into-userform",src:n(74531).Z,width:"1368",height:"738"})),(0,a.kt)("h3",{id:"adding-commandbutton"},"Adding CommandButton"),(0,a.kt)("p",null,"You can find ",(0,a.kt)("inlineCode",{parentName:"p"},"CommandButton")," option, as highlighted in ",(0,a.kt)("em",{parentName:"p"},"Red Square")," in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"insert-command-button-into-userform",src:n(35169).Z,width:"1370",height:"738"})),(0,a.kt)("p",null,"After adding CommandButton, we get window as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"command-button-into-userform",src:n(49282).Z,width:"1370",height:"768"})),(0,a.kt)("h2",{id:"updating-properties"},"Updating Properties"),(0,a.kt)("p",null,"Now we update some properties of following:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"UserForm"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"ComboBox"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"CommandButton")))),(0,a.kt)("h3",{id:"updating-properties-of-the-userform"},"Updating Properties of the UserForm"),(0,a.kt)("p",null,"We update following properties of the Userform:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Name of Userform")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Caption of Userform"))),(0,a.kt)("p",null,"In below image, I have shown the properties of ",(0,a.kt)("inlineCode",{parentName:"p"},"Userform1")," and update the properties:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"update-userform-properties",src:n(23843).Z,width:"1372",height:"738"})),(0,a.kt)("p",null,"Update the value of ",(0,a.kt)("em",{parentName:"p"},"Name")," property from ",(0,a.kt)("inlineCode",{parentName:"p"},"UserForm1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"OpenDocumentWindow"),"."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"From ",(0,a.kt)("em",{parentName:"li"},"Name")," property, we access the Userform.")),(0,a.kt)("p",null,"Update the value of ",(0,a.kt)("em",{parentName:"p"},"Caption")," property from ",(0,a.kt)("inlineCode",{parentName:"p"},"UserForm1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"Open Document"),"."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"From ",(0,a.kt)("em",{parentName:"li"},"Caption")," property, we update the text appears in the window of our Userform.")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Please note that it is ",(0,a.kt)("strong",{parentName:"p"},"not necessary")," to update properties but it is a good habit to update them for our purpose. ")),(0,a.kt)("h3",{id:"updating-properties-of-the-combobox"},"Updating Properties of the ComboBox"),(0,a.kt)("p",null,"Now, we update following property of the ComboBox:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Name of ComboBox")),(0,a.kt)("p",null,"In below image, I have shown the properties of ",(0,a.kt)("inlineCode",{parentName:"p"},"ComboBox1")," and update the properties:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"update-combobox-properties",src:n(41395).Z,width:"1374",height:"740"})),(0,a.kt)("p",null,"Update the value of ",(0,a.kt)("em",{parentName:"p"},"Name")," property from ",(0,a.kt)("inlineCode",{parentName:"p"},"ComboBox1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"DocumentTypeComboBox"),"."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"From ",(0,a.kt)("em",{parentName:"li"},"Name")," property, we access the ComboBox.")),(0,a.kt)("h3",{id:"updating-properties-of-the-command-button"},"Updating Properties of the Command Button"),(0,a.kt)("p",null,"Now, we update following property of the Command Button:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Name of Command Button")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Caption of Command Button"))),(0,a.kt)("p",null,"In below image, I have shown the properties of ",(0,a.kt)("inlineCode",{parentName:"p"},"CommandButton1")," and update the properties:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"update-command-button-properties",src:n(96265).Z,width:"1378",height:"736"})),(0,a.kt)("p",null,"Update the value of ",(0,a.kt)("em",{parentName:"p"},"Name")," property from ",(0,a.kt)("inlineCode",{parentName:"p"},"CommandButton1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"OpenDocumentButton"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"From ",(0,a.kt)("em",{parentName:"p"},"Name")," property, we access the Command Button.")),(0,a.kt)("p",null,"Update the value of ",(0,a.kt)("em",{parentName:"p"},"Caption")," property from ",(0,a.kt)("inlineCode",{parentName:"p"},"CommandButton1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"Open Selected Document"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"From ",(0,a.kt)("em",{parentName:"p"},"Caption")," property, we update the text appears in the Command Button of our Userform.")),(0,a.kt)("h2",{id:"calling-userform-in-main-module"},"Calling UserForm in Main Module"),(0,a.kt)("p",null,"Now, we need to call the our ",(0,a.kt)("em",{parentName:"p"},"Userform")," inside main ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"module")),"."),(0,a.kt)("p",null,"For this goto main ",(0,a.kt)("inlineCode",{parentName:"p"},"Sub procedure")," inside the ",(0,a.kt)("strong",{parentName:"p"},"main Module"),"."),(0,a.kt)("p",null,"Code inside the main Module is as given below."),(0,a.kt)("p",null,"{% highlight vb showLineNumbers %}\nDim swApp As Object\nSub main()"),(0,a.kt)("p",null,"Set swApp = Application.SldWorks\nEnd Sub\n{% endhighlight %}"),(0,a.kt)("p",null,"To call our ",(0,a.kt)("inlineCode",{parentName:"p"},"Userform"),", replace above code with below code:"),(0,a.kt)("p",null,"{% highlight vb showLineNumbers %}\n' Main function of our VBA program\nSub main()\n' Calling our window to show\nOpenDocumentWindow.Show\nEnd Sub\n{% endhighlight %}"),(0,a.kt)("p",null,"Above function call our window to appears on screen."),(0,a.kt)("p",null,"When the window appears on screen, we ",(0,a.kt)("em",{parentName:"p"},"1st")," select the document we want to ",(0,a.kt)("em",{parentName:"p"},"open")," and ",(0,a.kt)("em",{parentName:"p"},"then")," hit the button to open selected document."),(0,a.kt)("h2",{id:"adding-document-list"},"Adding Document list"),(0,a.kt)("p",null,"Before anything we need to ",(0,a.kt)("em",{parentName:"p"},"add")," a ",(0,a.kt)("em",{parentName:"p"},"list")," of documents inside our combobox."),(0,a.kt)("p",null,"From this list, we select the document which we want to open."),(0,a.kt)("p",null,'In this post, we are listing only "',(0,a.kt)("strong",{parentName:"p"},"Assembly"),'" and "',(0,a.kt)("strong",{parentName:"p"},"Drawing"),'" documents.'),(0,a.kt)("p",null,'For "',(0,a.kt)("strong",{parentName:"p"},"Part"),'" document, I will give you a simple exercise.'),(0,a.kt)("p",null,"To add documents list inside our combobox, we 1st need to go in ",(0,a.kt)("strong",{parentName:"p"},"Code Window")," of userform."),(0,a.kt)("p",null,"For this, we need to ",(0,a.kt)("strong",{parentName:"p"},"right click"),' on userform and select "',(0,a.kt)("strong",{parentName:"p"},"View Code"),'" option.'),(0,a.kt)("p",null,'Please see below image for "',(0,a.kt)("em",{parentName:"p"},"how to open code window of userform"),'".'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"select-view-code-option",src:n(32540).Z,width:"1380",height:"738"})),(0,a.kt)("p",null,'After selecting "',(0,a.kt)("strong",{parentName:"p"},"View Code"),'" a ',(0,a.kt)("em",{parentName:"p"},"Code window")," appears, which is shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"behind-userform-code-window",src:n(28865).Z,width:"1378",height:"738"})),(0,a.kt)("p",null,"Now ",(0,a.kt)("em",{parentName:"p"},"before")," adding document list we need to understand ",(0,a.kt)("strong",{parentName:"p"},"one important thing"),"!!!"),(0,a.kt)("p",null,"We want to add document list, when we ",(0,a.kt)("strong",{parentName:"p"},"load")," our ",(0,a.kt)("inlineCode",{parentName:"p"},"Userform"),"."),(0,a.kt)("p",null,"For this we need to create an ",(0,a.kt)("inlineCode",{parentName:"p"},"Initialize Function"),"."),(0,a.kt)("p",null,"Below ",(0,a.kt)("inlineCode",{parentName:"p"},"Code")," is that ",(0,a.kt)("inlineCode",{parentName:"p"},"Initialize Function")," which load document lists in our combobox."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Call when user load\nPrivate Sub UserForm_Initialize()\n  ' Adding items in Combo Box and also set index to '0'\n  ' '0' index means by default we can see \"Assembly Document\" as already filled\n  With DocumentTypeComboBox\n    .AddItem \"Assembly Document\"    ' Adding Assembly Document in Combo Box\n    .AddItem \"Drawing Document\"     ' Adding Drawing Document in Combo Box\n    .ListIndex = 0                  ' Select list index for default value to show in combobox\n  End With\nEnd Sub\n")),(0,a.kt)("p",null,"Now, above code is ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"fully commented"))," and ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"self explanatory"))," hence I will not explain it."),(0,a.kt)("h2",{id:"first-test-of-macro"},"First Test of Macro"),(0,a.kt)("p",null,"After writing code sample in previous section, we will test if every thing is working correct?"),(0,a.kt)("p",null,"By working correct means:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"When we ",(0,a.kt)("inlineCode",{parentName:"p"},"Run")," macro, is ",(0,a.kt)("strong",{parentName:"p"},"Open Document")," window appears or not?")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"If window appears, then combobox has documents listed in it?")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'If both item listed, then "',(0,a.kt)("strong",{parentName:"p"},"Assembly document"),'" is showing as pre-filled value or not?')),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Since we have not given any functionality to "',(0,a.kt)("strong",{parentName:"p"},"Open Document"),'" button, hence it should not any done anything when clicking!!!'))),(0,a.kt)("p",null,"For testing all the above points we need to ",(0,a.kt)("inlineCode",{parentName:"p"},"Run")," the macro as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"first-test-of-macro",src:n(2627).Z,width:"1382",height:"736"})),(0,a.kt)("p",null,"After running the window we got a window as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"sample-userform-window",src:n(57128).Z,width:"311",height:"236"})),(0,a.kt)("p",null,"Please ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"do check"))," if your macro is running perfectly till now or not!"),(0,a.kt)("p",null,"If not, then I suggest you to read this article again."),(0,a.kt)("h2",{id:"add-functionality-to-open-newpart-button"},"Add Functionality to Open NewPart Button"),(0,a.kt)("p",null,"To add functionality in our ",(0,a.kt)("inlineCode",{parentName:"p"},"Open Selected Button"),", just double click the ",(0,a.kt)("inlineCode",{parentName:"p"},"Open NewPart Button"),"."),(0,a.kt)("p",null,"This will add give some code behind the designer and opens the ",(0,a.kt)("strong",{parentName:"p"},"code window")," of Userform designer."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Private Sub OpenDocumentButton_Click()\n\nEnd Sub\n")),(0,a.kt)("p",null,"We need to update this code for opening new part after clicking the button."),(0,a.kt)("p",null,"For this replace all above code with below code."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n\n' Creating variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n' Creating variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n\n' Private function of Open New Part Button \nPrivate Sub OpenDocumentButton_Click()\n\n  ' Setting Solidworks variable to Solidworks application\n  Set swApp = Application.SldWorks\n  \n  ' Creating string type variable for storing default Assembly location\n  Dim defaultTemplate As String\n  \n  If DocumentTypeComboBox.Value = \"Assembly Document\" Then\n    ' Setting value of this string type variable to \"Default Assembly template\"\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly)\n  Else\n    ' Setting value of this string type variable to \"Default drawing template\" without define paper size\n    defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing)\n  End If\n\n  ' Setting Solidworks document to new Assembly document\n  Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n  \n  ' Hiding the Window after opening the selected document\n  OpenDocumentWindow.Hide\n  \n  ' Reset the Index of Combo Box to \"0\" again\n  DocumentTypeComboBox.ListIndex = 0\n    \nEnd Sub\n")),(0,a.kt)("p",null,"Now I have added codes in ",(0,a.kt)("strong",{parentName:"p"},"2 parts"),"."),(0,a.kt)("p",null,"In ",(0,a.kt)("strong",{parentName:"p"},"1st part")," I added below code lines ",(0,a.kt)("em",{parentName:"p"},"at top")," of the code window."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n\n' Creating variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n' Creating variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n")),(0,a.kt)("p",null,"Please see below image for more reference."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"add-code-at-top-of-userform-codewindow",src:n(91866).Z,width:"1384",height:"738"})),(0,a.kt)("p",null,"In ",(0,a.kt)("strong",{parentName:"p"},"2nd part")," I added ",(0,a.kt)("inlineCode",{parentName:"p"},"OpenDocumentButton_Click")," function in the code window as shown in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"code-when-button-clicked",src:n(21354).Z,width:"1370",height:"740"})),(0,a.kt)("p",null,"I have already explained code inside ",(0,a.kt)("inlineCode",{parentName:"p"},"OpenDocumentButton_Click")," function in ",(0,a.kt)("a",{parentName:"p",href:"/solidworks-macros/open-assembly-and-drawing"},"Open Assembly and Drawing document"),"."),(0,a.kt)("p",null,"But here, I have added a condition which is shown in Red colored box in below image."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"condition-that-control-opening-document",src:n(9544).Z,width:"1366",height:"738"})),(0,a.kt)("p",null,'Basically, this condition stated that, if we select "',(0,a.kt)("em",{parentName:"p"},"Assembly Document"),'" in combobox, then by clicking "',(0,a.kt)("em",{parentName:"p"},"Open Select Document"),'" button our macro open "',(0,a.kt)("strong",{parentName:"p"},"Assembly"),'" document in ',(0,a.kt)("em",{parentName:"p"},"Solidworks"),"."),(0,a.kt)("p",null,'Otherwise, it will always open "',(0,a.kt)("strong",{parentName:"p"},"Drawing"),'" document in ',(0,a.kt)("em",{parentName:"p"},"Solidworks"),"."),(0,a.kt)("p",null,"The above code will ",(0,a.kt)("em",{parentName:"p"},"open New part document")," when we click the button."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Run")," the macro, and check wheather our macro is working correct document or not!!"),(0,a.kt)("p",null,"If not, send your macro and I will guide you in doing it correctly! "),(0,a.kt)("h2",{id:"exercise-to-do"},"Exercise to do"),(0,a.kt)("p",null,"For those who wants to do more I have an exercise!!"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Add "',(0,a.kt)("strong",{parentName:"p"},"Part Document"),'" in ComboBox list.')),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Make "',(0,a.kt)("strong",{parentName:"p"},"Part Document"),'" as ',(0,a.kt)("em",{parentName:"p"},"pre-filled")," value in ComboBox.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Change the ",(0,a.kt)("strong",{parentName:"p"},"conditional statement"),", so that it can handle ",(0,a.kt)("strong",{parentName:"p"},"all 3 conditions"),"!!"))),(0,a.kt)("p",null,"Send me the Code of macro in my below ",(0,a.kt)("strong",{parentName:"p"},"e-mail")," and I will ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"verify"))," it. "),(0,a.kt)("p",null,"That's it for now."),(0,a.kt)("p",null,"Hope you learn some use of Userforms and by this post you can get the idea how they works."),(0,a.kt)("p",null,"I will provide more tutorials on using of Userform time to time."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"Till then do come to visit this blog and Happy learning!!!"))))}d.isMDXComponent=!0},91866:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/add-code-at-top-of-userform-codewindow-bf23525039b13b3541a17582d33b3249.png"},28865:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/behind-userform-code-window-53f7c7ccf79efeedfacece8d9f01c554.png"},21354:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/code-when-button-clicked-9603ffb1fba2b3c7e42e697dec7db67b.png"},74531:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/combobox-into-userform-63ac1d4d4e8021a6b43868f651e6c7cb.png"},49282:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/command-button-into-userform-b11cf60652222f0a250f9e952be4c2b0.png"},9544:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/condition-that-control-opening-document-2ac32ef463a4d7ddfc1c0ef4236e74e2.png"},2627:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/first-test-of-macro-1993ba56e3541062dc3e75f4315bc669.png"},21994:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/insert-combox-into-userform-cbfcbcc646555660439e14dc8c3b353a.png"},35169:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/insert-command-button-into-userform-1eec72bde036662833f493102f51a14b.png"},22783:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/insert-userform-into-macro-4b981270c4f9349b4be7efaa800e712f.png"},78612:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/open-new-macro-b822f2e9b8c402eebf9f3386f8de3d09.png"},57128:(e,t,n)=>{n.d(t,{Z:()=>o});const o="data:image/png;base64,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"},32540:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/select-view-code-option-8c6dcbfce1db91dd5a445b011d8be298.png"},41395:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/update-combobox-properties-ef7ff04fbc4228169fe06ad4932f5755.png"},96265:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/update-command-button-properties-3632a93bb86f0e261f12da770d6737a1.png"},23843:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/update-userform-properties-59368ef851ec6debed291ae1f9f392d6.png"}}]);
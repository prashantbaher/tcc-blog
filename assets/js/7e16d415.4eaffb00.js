"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[7637],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return c}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),l=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(s.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=u(e,["components","mdxType","originalType","parentName"]),m=l(n),c=r,d=m["".concat(s,".").concat(c)]||m[c]||g[c]||a;return n?o.createElement(d,i(i({ref:t},p),{},{components:n})):o.createElement(d,i({ref:t},p))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=m;var u={};for(var s in t)hasOwnProperty.call(t,s)&&(u[s]=t[s]);u.originalType=e,u.mdxType="string"==typeof e?e:r,i[1]=u;for(var l=2;l<a;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},30500:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return u},metadata:function(){return l},toc:function(){return g}});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),i=["components"],u={title:"Bug Finding",tags:["VBA"],permalink:"/vba/bug-finding/"},s=void 0,l={unversionedId:"vba-bug-finding",id:"vba-bug-finding",title:"Bug Finding",description:"A bug is an error in your programming. Here I cover the topic of programming bugs \u2014 how to identify them and how to remove them from your module.",source:"@site/docs/vba/20-vba-bug-finding.md",sourceDirName:".",slug:"/vba-bug-finding",permalink:"/vba/vba-bug-finding",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:20,frontMatter:{title:"Bug Finding",tags:["VBA"],permalink:"/vba/bug-finding/"},sidebar:"tutorialSidebar",previous:{title:"VBA Looping",permalink:"/vba/vba-looping"},next:{title:"VBA Debugger",permalink:"/vba/vba-debugger"}},p={},g=[{value:"Types of Bugs",id:"types-of-bugs",level:2},{value:"Identifying Bugs",id:"identifying-bugs",level:2},{value:"Debugging Techniques",id:"debugging-techniques",level:2},{value:"Examine your code",id:"examine-your-code",level:3},{value:"Using the MsgBox function",id:"using-the-msgbox-function",level:3},{value:"Inserting Debug.Print Statement",id:"inserting-debugprint-statement",level:3}],m={toc:g};function c(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"bug")," is an error in your programming. Here I cover the topic of programming bugs \u2014 how to identify them and how to remove them from your module. "),(0,a.kt)("h2",{id:"types-of-bugs"},"Types of Bugs"),(0,a.kt)("p",null,"The term ",(0,a.kt)("em",{parentName:"p"},"program bug"),", as you probably know, refers to a problem with software. "),(0,a.kt)("p",null,"In other words, if software doesn\u2019t perform as expected, it has a ",(0,a.kt)("strong",{parentName:"p"},"bug"),". "),(0,a.kt)("p",null,"Fact is, all major software programs have bugs \u2014 lots of bugs. "),(0,a.kt)("p",null,"A CAD software like ",(0,a.kt)("em",{parentName:"p"},"Solidworks")," itself has hundreds (if not thousands) of bugs. "),(0,a.kt)("p",null,"Fortunately, the vast majority of these bugs are relatively obscure and appear in only very specific circumstances."),(0,a.kt)("p",null,"When you write non-trivial VBA programs, your code probably will have bugs. "),(0,a.kt)("p",null,"This is a fact of life and not necessarily a reflection of your programming ability. The bugs may fall into any of the following categories: "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("em",{parentName:"p"},"Logical flaws in your code"),": You can often avoid these bugs by carefully thinking through the problem your program addresses.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("em",{parentName:"p"},"Incorrect context bugs"),": This type of bug surfaces when you attempt to do something at the wrong time. For example, you may try to update the sketch dimension and there are no sketch is activated. ")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("em",{parentName:"p"},"Extreme-case bugs"),": These bugs rear their heads when you encounter data you didn\u2019t anticipate, such as very large or very small numbers. ")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("em",{parentName:"p"},"Wrong data types bugs"),": This type of bug occurs when you try to process data of the wrong type, such as attempting to take the square root of a text string. "))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Debugging")," is the process of identifying and correcting bugs in your program. "),(0,a.kt)("p",null,"Developing debugging skills takes time, so don\u2019t be discouraged if this process is difficult at first. "),(0,a.kt)("p",null,"It\u2019s important to understand the distinction between bugs and syntax errors. "),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"syntax error")," is a language error. For example, you might misspell a keyword, omit the Next statement in a ",(0,a.kt)("inlineCode",{parentName:"p"},"For-Next")," loop, or have a mismatched parenthesis. "),(0,a.kt)("p",null,"Before you can even execute the procedure, you must correct these syntax errors. "),(0,a.kt)("p",null,"A program bug is much ",(0,a.kt)("em",{parentName:"p"},"subtler"),". You can execute the routine, but it doesn\u2019t perform as expected. "),(0,a.kt)("h2",{id:"identifying-bugs"},"Identifying Bugs"),(0,a.kt)("p",null,"Before you can do any debugging, you must determine whether a bug actually exists. "),(0,a.kt)("p",null,"You can tell that your macro contains a bug if it doesn\u2019t work the way it should. Usually, but not always, you can easily discern this. "),(0,a.kt)("p",null,"A key fact known to all programmers is that bugs often appear when you least expect them. "),(0,a.kt)("p",null,"For example, just because your macro works fine with one data set doesn\u2019t mean you can assume it will work equally as well with all data sets. "),(0,a.kt)("p",null,"Or your macro runs fine in your system but not working properly in your friend's system. "),(0,a.kt)("p",null,"Such cases happened all the time and are part of debugging. "),(0,a.kt)("p",null,"The best debugging approach is to start with thorough testing, under a variety of real-life conditions. "),(0,a.kt)("p",null,"Because any changes made by your VBA code cannot be undone, it is always a good idea to use a backup copy of your CAD files that you use for testing. "),(0,a.kt)("p",null,"I usually copy some files into a temporary folder and use those files for my testing. "),(0,a.kt)("h2",{id:"debugging-techniques"},"Debugging Techniques"),(0,a.kt)("p",null,"In this section, I discuss the some of the most common methods for debugging VBA code: "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Examine your code"),(0,a.kt)("li",{parentName:"ul"},"Inserting ",(0,a.kt)("inlineCode",{parentName:"li"},"MsgBox")," functions at various locations in your code"),(0,a.kt)("li",{parentName:"ul"},"Inserting ",(0,a.kt)("inlineCode",{parentName:"li"},"Debug.Print")," statement")),(0,a.kt)("h3",{id:"examine-your-code"},"Examine your code"),(0,a.kt)("p",null,"Perhaps the most straightforward debugging technique is simply taking a close look at your code to see whether you can find the problem. "),(0,a.kt)("p",null,"If you\u2019re lucky, the error jumps right out, and you can fix the problem."),(0,a.kt)("p",null,"Notice I said, \u201cIf you\u2019re lucky.\u201d That\u2019s because often you discover errors when you have been working on your program for long hours and you are running on caffeine and willpower. "),(0,a.kt)("p",null,"At times like that, you are lucky if you can even see your code. "),(0,a.kt)("p",null,"Thus, don\u2019t be surprised if simply examining your code isn\u2019t enough to make you find and expunge all the bugs it contains. "),(0,a.kt)("h3",{id:"using-the-msgbox-function"},"Using the MsgBox function"),(0,a.kt)("p",null,"A common problem in many programs involves one or more variables not taking on the values you expect. "),(0,a.kt)("p",null,"In such cases, monitoring the variable(s) while your code runs is a helpful debugging technique. "),(0,a.kt)("p",null,"One way to do this is by inserting temporary ",(0,a.kt)("inlineCode",{parentName:"p"},"MsgBox")," functions into your routine. "),(0,a.kt)("p",null,"For example, I used ",(0,a.kt)("inlineCode",{parentName:"p"},"MsgBox")," function to check conditions. Whenever I use ",(0,a.kt)("inlineCode",{parentName:"p"},"If-Else")," statement, I put one message in ",(0,a.kt)("inlineCode",{parentName:"p"},"If")," condition and put another message in ",(0,a.kt)("inlineCode",{parentName:"p"},"Else")," condition. "),(0,a.kt)("p",null,"By this way, I make sure condition which I want is working correct or not. "),(0,a.kt)("p",null,"Feel free to use ",(0,a.kt)("inlineCode",{parentName:"p"},"MsgBox")," functions frequently when you debug your code. "),(0,a.kt)("p",null,"Just make sure that you remove them after you identify and correct the problem."),(0,a.kt)("h3",{id:"inserting-debugprint-statement"},"Inserting Debug.Print Statement"),(0,a.kt)("p",null,"As an alternative to using ",(0,a.kt)("inlineCode",{parentName:"p"},"MsgBox")," functions in your code, you can insert one or more temporary ",(0,a.kt)("inlineCode",{parentName:"p"},"Debug.Print")," statements. "),(0,a.kt)("p",null,"Use these statements to print the value of one or more variables in the ",(0,a.kt)("em",{parentName:"p"},"Immediate")," window. "),(0,a.kt)("p",null,'Here\u2019s an example that displays a message of "This condition is working fine". '),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'If swPart Is Nothing Then\n  Debug.Print "This condition is working fine."\n')),(0,a.kt)("p",null,"If VBE\u2019s ",(0,a.kt)("strong",{parentName:"p"},"Immediate")," window is not visible, press ",(0,a.kt)("inlineCode",{parentName:"p"},"Ctrl+G"),"."),(0,a.kt)("p",null,"Unlike ",(0,a.kt)("inlineCode",{parentName:"p"},"MsgBox"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"Debug.Print")," statements do not halt your code. "),(0,a.kt)("p",null,"So you\u2019ll need to keep an eye on the ",(0,a.kt)("strong",{parentName:"p"},"Immediate")," window to see what\u2019s going on. "),(0,a.kt)("p",null,"After you\u2019ve debugged your code, be sure to remove all the ",(0,a.kt)("inlineCode",{parentName:"p"},"Debug.Print")," statements."),(0,a.kt)("p",null,"Next post will be about ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"VBA Debugger")),"."))}c.isMDXComponent=!0}}]);
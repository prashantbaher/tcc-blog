"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[6034],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=s(n),d=r,k=c["".concat(p,".").concat(d)]||c[d]||m[d]||o;return n?a.createElement(k,i(i({ref:t},u),{},{components:n})):a.createElement(k,i({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},70347:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return m}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=["components"],l={title:"Declaring and Scoping of Variables",tags:["VBA"],permalink:"/vba/declaring-and-scoping-of-variables/"},p=void 0,s={unversionedId:"vba-declaring-and-scoping-of-variables",id:"vba-declaring-and-scoping-of-variables",title:"Declaring and Scoping of Variables",description:"If you read the previous topics, you now know a bit about Variables and Data-types.",source:"@site/docs/vba/08-vba-declaring-and-scoping-of-variables.md",sourceDirName:".",slug:"/vba-declaring-and-scoping-of-variables",permalink:"/vba/vba-declaring-and-scoping-of-variables",draft:!1,tags:[{label:"VBA",permalink:"/vba/tags/vba"}],version:"current",sidebarPosition:8,frontMatter:{title:"Declaring and Scoping of Variables",tags:["VBA"],permalink:"/vba/declaring-and-scoping-of-variables/"},sidebar:"tutorialSidebar",previous:{title:"VBA Variables",permalink:"/vba/vba-variables"},next:{title:"Variable Scope",permalink:"/vba/vba-variable-scope"}},u={},m=[],c={toc:m};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"If you read the previous topics, you now know a bit about ",(0,o.kt)("a",{parentName:"p",href:"/vba/vba-variables"},"Variables")," and ",(0,o.kt)("a",{parentName:"p",href:"/vba/vba-programming-concepts#data-types-in-vba"},"Data-types"),". "),(0,o.kt)("p",null,"In this topic, you discover how to ",(0,o.kt)("strong",{parentName:"p"},"declare")," a ",(0,o.kt)("inlineCode",{parentName:"p"},"variable")," as a certain ",(0,o.kt)("em",{parentName:"p"},"data type"),"."),(0,o.kt)("p",null,"If you don\u2019t ",(0,o.kt)("em",{parentName:"p"},"declare")," the ",(0,o.kt)("em",{parentName:"p"},"data type")," for a ",(0,o.kt)("inlineCode",{parentName:"p"},"variable")," you use in a ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA routine"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," uses the default data type: ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant"),". "),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Data stored")," as a ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," acts like a ",(0,o.kt)("strong",{parentName:"p"},"chameleon"),"; it changes type depending on what you do with it. "),(0,o.kt)("p",null,"For example, if a ",(0,o.kt)("em",{parentName:"p"},"variable")," is a ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," data type and contains a text string that looks like a number (such as \u201c123\u201d), you can use this ",(0,o.kt)("em",{parentName:"p"},"variable")," for ",(0,o.kt)("inlineCode",{parentName:"p"},"string")," manipulations as well as ",(0,o.kt)("inlineCode",{parentName:"p"},"numeric")," calculations. "),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," automatically handles the conversion. Letting ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," handle data types may seem like an easy way out \u2014 but remember that you sacrifice speed and memory."),(0,o.kt)("p",null,"Before you use ",(0,o.kt)("em",{parentName:"p"},"variables")," in a ",(0,o.kt)("inlineCode",{parentName:"p"},"procedure"),", it\u2019s an excellent practice to ",(0,o.kt)("em",{parentName:"p"},"declare")," your variables \u2014 that is, tell ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," each variable\u2019s data type. "),(0,o.kt)("p",null,"Declaring your ",(0,o.kt)("em",{parentName:"p"},"variables")," makes your program run ",(0,o.kt)("strong",{parentName:"p"},"faster")," and use memory ",(0,o.kt)("em",{parentName:"p"},"more efficiently"),". "),(0,o.kt)("p",null,"The default ",(0,o.kt)("em",{parentName:"p"},"data type"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant"),", causes ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," to repeatedly perform time consuming checks and reserve more memory than necessary. "),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," knows a ",(0,o.kt)("em",{parentName:"p"},"variable\u2019s data type"),", it doesn\u2019t have to investigate and can reserve just enough memory to store the data."),(0,o.kt)("p",null,"To force yourself to declare all the variables you use, include the following as the first statement in your ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," module:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n")),(0,o.kt)("p",null,"When this ",(0,o.kt)("em",{parentName:"p"},"statement")," is present, you won\u2019t be able to run your code if it contains any undeclared ",(0,o.kt)("em",{parentName:"p"},"variables"),"."),(0,o.kt)("p",null,"You need to use ",(0,o.kt)("inlineCode",{parentName:"p"},"Option Explicit")," only once: at the ",(0,o.kt)("em",{parentName:"p"},"beginning")," of your module, prior to the declaration of any procedures in the module. "),(0,o.kt)("p",null,"Keep in mind that the ",(0,o.kt)("inlineCode",{parentName:"p"},"Option Explicit")," statement applies only to the module in which it resides. "),(0,o.kt)("p",null,"If you have more than one ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," module in a ",(0,o.kt)("strong",{parentName:"p"},"project"),", you need an ",(0,o.kt)("inlineCode",{parentName:"p"},"Option Explicit")," statement for each module."),(0,o.kt)("p",null,"Suppose that you use an ",(0,o.kt)("em",{parentName:"p"},"undeclared variable")," (that is, a ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant"),") named ",(0,o.kt)("inlineCode",{parentName:"p"},"myDimension"),". "),(0,o.kt)("p",null,"At some point in your routine, you insert the following statement:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"myDimnsion = 11\n")),(0,o.kt)("p",null,"This misspelled ",(0,o.kt)("em",{parentName:"p"},"variable"),", which is difficult to spot, will probably cause your routine to give incorrect results. "),(0,o.kt)("p",null,"If you use ",(0,o.kt)("inlineCode",{parentName:"p"},"Option Explicit")," at the beginning of your module (forcing you to declare the ",(0,o.kt)("inlineCode",{parentName:"p"},"myDimension")," variable), ",(0,o.kt)("inlineCode",{parentName:"p"},"VBE")," generates an error if it encounters a misspelled variation of that variable."),(0,o.kt)("p",null,"To ensure that the ",(0,o.kt)("inlineCode",{parentName:"p"},"Option Explicit")," statement is inserted automatically whenever you insert a new ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," module; turn on the ",(0,o.kt)("em",{parentName:"p"},"Require Variable Definition option"),". "),(0,o.kt)("p",null,"You find it in the ",(0,o.kt)("strong",{parentName:"p"},"Editor tab")," of the ",(0,o.kt)("strong",{parentName:"p"},"Options dialog box")," (in the VBE, choose ",(0,o.kt)("strong",{parentName:"p"},"Tools -> Options"),"). "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"I highly recommend doing so.")),(0,o.kt)("p",null,"Declaring your variables also lets you take advantage of a shortcut that can save some typing. "),(0,o.kt)("p",null,"Just type the first two or three characters of the variable name, and then press ",(0,o.kt)("inlineCode",{parentName:"p"},"Ctrl + Space"),". "),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"VBE")," will either complete the entry for you or \u2014 if the choice is ambiguous \u2014 show you a list of matching words to select from. "),(0,o.kt)("p",null,"In fact, this slick trick works with ",(0,o.kt)("em",{parentName:"p"},"reserved words")," and ",(0,o.kt)("em",{parentName:"p"},"functions"),", too."),(0,o.kt)("p",null,"You now know the advantages of declaring ",(0,o.kt)("em",{parentName:"p"},"variables"),", but how do you do this? "),(0,o.kt)("p",null,"The most common way is to use a ",(0,o.kt)("inlineCode",{parentName:"p"},"Dim")," statement. "),(0,o.kt)("p",null,"Here are some examples of variables being declared:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Dim YourName as String\nDim PartLength as Long\nDim bRet as Boolean\nDim X\n")),(0,o.kt)("p",null,"The first ",(0,o.kt)("em",{parentName:"p"},"three")," variables are declared as a specific ",(0,o.kt)("em",{parentName:"p"},"data type"),". "),(0,o.kt)("p",null,"The last variable, ",(0,o.kt)("strong",{parentName:"p"},"X"),", is not declared as a specific ",(0,o.kt)("em",{parentName:"p"},"data type"),", so it\u2019s treated as a ",(0,o.kt)("inlineCode",{parentName:"p"},"Variant")," (it can be anything)."),(0,o.kt)("p",null,"Besides ",(0,o.kt)("inlineCode",{parentName:"p"},"Dim"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA")," has ",(0,o.kt)("em",{parentName:"p"},"three")," other keywords that are used to declare variables:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Static"),(0,o.kt)("li",{parentName:"ul"},"Public"),(0,o.kt)("li",{parentName:"ul"},"Private")),(0,o.kt)("p",null,"I explain more about the ",(0,o.kt)("inlineCode",{parentName:"p"},"Dim, Static, Public"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"Private")," keywords later on, but first I must cover two other topics that are relevant here: ",(0,o.kt)("strong",{parentName:"p"},"a variable\u2019s scope")," and ",(0,o.kt)("strong",{parentName:"p"},"a variable\u2019s life"),"."),(0,o.kt)("p",null,"Recall that your code can have any number of ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA modules")," and a ",(0,o.kt)("inlineCode",{parentName:"p"},"VBA module")," can have any number of ",(0,o.kt)("inlineCode",{parentName:"p"},"Sub")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Function")," procedures. "),(0,o.kt)("p",null,"A variable\u2019s scope determines which modules and procedures can use the variable. "),(0,o.kt)("p",null,"Below Table describes the scopes:"),(0,o.kt)("table",{class:"w3-table-all w3-mobile w3-card-4"},(0,o.kt)("tr",null,(0,o.kt)("th",{class:"w3-center",colspan:"2"},"VBA\u2019s Variable\u2019s Scope")),(0,o.kt)("tr",null,(0,o.kt)("th",null,"Scope"),(0,o.kt)("th",null,"How the Variable is Declared")),(0,o.kt)("tr",null,(0,o.kt)("td",null,"Procedure only"),(0,o.kt)("td",null,"By using a ",(0,o.kt)("strong",null,"Dim")," or a ",(0,o.kt)("strong",null,"Static")," statement in the procedure that uses the variable.")),(0,o.kt)("tr",null,(0,o.kt)("td",null,"Module only"),(0,o.kt)("td",null,"By using a ",(0,o.kt)("strong",null,"Dim")," or a ",(0,o.kt)("strong",null,"Private")," statement before the first ",(0,o.kt)("strong",null,"Sub")," or ",(0,o.kt)("strong",null,"Function")," statement in the module.")),(0,o.kt)("tr",null,(0,o.kt)("td",null,"All procedures in all modules"),(0,o.kt)("td",null,"By using a ",(0,o.kt)("strong",null,"Public")," statement before the first ",(0,o.kt)("strong",null,"Sub")," or",(0,o.kt)("strong",null,"Function")," statement in the module."))),(0,o.kt)("p",null,"If you get confused keep reading next post on these topics."),(0,o.kt)("p",null,"Next post will be about ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Variable Scope")),"."))}d.isMDXComponent=!0}}]);
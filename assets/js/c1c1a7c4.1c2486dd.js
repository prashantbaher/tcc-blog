"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[9186],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return c}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),m=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(i.Provider,{value:t},e.children)},k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=m(a),c=r,d=u["".concat(i,".").concat(c)]||u[c]||k[c]||l;return a?n.createElement(d,o(o({ref:t},p),{},{components:a})):n.createElement(d,o({ref:t},p))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,o=new Array(l);o[0]=u;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var m=2;m<l;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},44935:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return i},default:function(){return c},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return k}});var n=a(87462),r=a(63366),l=(a(67294),a(3905)),o=["components"],s={categories:"Solidworks-macro",title:"Solidworks VBA Macro - Insert Virtual Part",permalink:"/solidworks-vba-macros/assembly-insert-virtual-part/",tags:["Solidworks Macro"],id:"assembly-insert-virtual-part"},i=void 0,m={unversionedId:"assembly-insert-virtual-part",id:"assembly-insert-virtual-part",title:"Solidworks VBA Macro - Insert Virtual Part",description:"Objective",source:"@site/docs/solidworks-macros/025.1-assembly-insert-virtual-part.md",sourceDirName:".",slug:"/assembly-insert-virtual-part",permalink:"/solidworks-macros/assembly-insert-virtual-part",draft:!1,tags:[{label:"Solidworks Macro",permalink:"/solidworks-macros/tags/solidworks-macro"}],version:"current",frontMatter:{categories:"Solidworks-macro",title:"Solidworks VBA Macro - Insert Virtual Part",permalink:"/solidworks-vba-macros/assembly-insert-virtual-part/",tags:["Solidworks Macro"],id:"assembly-insert-virtual-part"},sidebar:"tutorialSidebar",previous:{title:"Solidworks VBA Macro - Delete Mate",permalink:"/solidworks-macros/assembly-delete-mate"},next:{title:"Solidworks VBA Macro - Insert Virtual Assembly",permalink:"/solidworks-macros/assembly-insert-virtual-assembly"}},p={},k=[{value:"Objective",id:"objective",level:2},{value:"Results We Can Get",id:"results-we-can-get",level:2},{value:"Macro Video",id:"macro-video",level:2},{value:"VBA Macro",id:"vba-macro",level:2},{value:"Prerequisite",id:"prerequisite",level:2},{value:"Steps To Follow",id:"steps-to-follow",level:2},{value:"Create Global Variables",id:"create-global-variables",level:3},{value:"Initialize Global Variables",id:"initialize-global-variables",level:3},{value:"Insert Virtual Part",id:"insert-virtual-part",level:3}],u={toc:k};function c(e){var t=e.components,s=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"objective"},"Objective"),(0,l.kt)("p",null,'In this article, we understand "how to" ',(0,l.kt)("strong",{parentName:"p"},"Insert Virtual Part")," in ",(0,l.kt)("strong",{parentName:"p"},"Assembly document")," from VBA macro."),(0,l.kt)("p",null,"This is most updated method of ",(0,l.kt)("strong",{parentName:"p"},"inserting Virtual part")," in as assembly document."),(0,l.kt)("h2",{id:"results-we-can-get"},"Results We Can Get"),(0,l.kt)("p",null,"Below image shows the result we get."),(0,l.kt)("p",null,(0,l.kt)("a",{target:"_blank",href:a(6973).Z},(0,l.kt)("img",{alt:"assembly-insert-virtual-part",src:a(31888).Z,width:"1366",height:"728"}))),(0,l.kt)("p",null,"We ",(0,l.kt)("strong",{parentName:"p"},"Insert Virtual Part")," in simple manners."),(0,l.kt)("p",null,"There are no extra steps required."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"To get the correct result, please follow the steps correctly."))),(0,l.kt)("h2",{id:"macro-video"},"Macro Video"),(0,l.kt)("p",null,"Below \ud83c\udfac video shows how to ",(0,l.kt)("strong",{parentName:"p"},"Insert Virtual Part")," from ",(0,l.kt)("em",{parentName:"p"},"SOLIDWORKS VBA Macros"),"."),(0,l.kt)("iframe",{src:"https://www.youtube.com/embed/2gCs5QEGZUs",frameborder:"0",allowfullscreen:!0,width:"100%",height:"500"}),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"Above video is just for visualization and there is no explanation."))," "),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"I have explained every line in this article."))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"It is advisable to watch video, since it helps you to better understand the process."))),(0,l.kt)("h2",{id:"vba-macro"},"VBA Macro"),(0,l.kt)("p",null,"Below is the ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"VBA macro"))," for ",(0,l.kt)("em",{parentName:"p"},"Insert Virtual Part"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n\n' Variable for Solidworks Application\nDim swApp As SldWorks.SldWorks\n\n' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n\n' Variable for Solidworks Assembly\nDim swAssembly As SldWorks.AssemblyDoc\n\n' Variable for Solidworks Component\nDim swComponent As SldWorks.Component2\n\n' Variable for Solidworks Face\nDim swFace As SldWorks.Face2\n\n' Program to Insert virtual part\nSub main()\n  \n  ' Set Solidworks Application variable to current application\n  Set swApp = Application.SldWorks\n  \n  ' Set Solidworks document variable to currently opened document\n  Set swDoc = swApp.ActiveDoc\n  \n  ' Check if Solidworks document is opened or not\n  If swDoc Is Nothing Then\n    MsgBox \"Solidworks document is not opened.\"\n    Exit Sub\n  End If\n  \n  ' Set Solidworks Assembly document\n  Set swAssembly = swDoc\n  \n  ' Get the selected face and set it to the Solidworks Face variable\n  Set swFace = swDoc.SelectionManager.GetSelectedObject6(1, -1)\n  \n  ' Insert Virtual part\n  swAssembly.InsertNewVirtualPart swFace, swComponent\n  \n  ' If there are error\n  If swComponent Is Nothing Then\n    ' Inform user and exit function.\n    MsgBox \"Failed to add Virtual part.\"\n    Exit Sub\n  End If\n  \nEnd Sub\n")),(0,l.kt)("h2",{id:"prerequisite"},"Prerequisite"),(0,l.kt)("p",null,"There are some ",(0,l.kt)("em",{parentName:"p"},"prerequisites")," for this article."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Knowledge of ",(0,l.kt)("strong",{parentName:"li"},"VBA programming language")," is \u2757",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("em",{parentName:"strong"},"required")),"."),(0,l.kt)("li",{parentName:"ul"},"We use existing parts in Assembly document."),(0,l.kt)("li",{parentName:"ul"},"Both components are fully constraint as shown in below image."),(0,l.kt)("li",{parentName:"ul"},"One face is selected, in which we want to insert virtual component.")),(0,l.kt)("p",null,(0,l.kt)("a",{target:"_blank",href:a(17026).Z},(0,l.kt)("img",{alt:"prerequisite",src:a(49830).Z,width:"1366",height:"727"}))),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"We will apply checks in this article, so the code we write, should be ",(0,l.kt)("strong",{parentName:"p"},"error free")," mostly."))),(0,l.kt)("h2",{id:"steps-to-follow"},"Steps To Follow"),(0,l.kt)("p",null,"This ",(0,l.kt)("strong",{parentName:"p"},"VBA macro")," can be divided into following sections:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("em",{parentName:"li"},"Create Global Variables")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("em",{parentName:"li"},"Initialize Global Variables")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("em",{parentName:"li"},"Insert Virtual Part"))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"Every section with each line is explained below."))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"I also give some ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"links (see icon \ud83d\ude80)"))," so that you can go through them if there are anything I explained in previous articles."))),(0,l.kt)("h3",{id:"create-global-variables"},"Create Global Variables"),(0,l.kt)("p",null,"In this section, we create global variables."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),": Above line forces us to define every variable we are going to use. "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/solidworks-macros/open-new-document"},"SOLIDWORKS Macros - Open new Part document"))," article.")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for ",(0,l.kt)("em",{parentName:"li"},"Solidworks application"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"swApp")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Type"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"SldWorks.SldWorks")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html"},"online SOLIDWORKS API Help")),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for ",(0,l.kt)("em",{parentName:"li"},"Solidworks document"),". "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"swDoc")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Type"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"SldWorks.ModelDoc2")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html"},"online SOLIDWORKS API Help")),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks Assembly\nDim swAssembly As SldWorks.AssemblyDoc\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for ",(0,l.kt)("em",{parentName:"li"},"Solidworks Assembly"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"swAssembly")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Type"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"SldWorks.AssemblyDoc")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IAssemblyDoc_members.html"},"online SOLIDWORKS API Help")),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks Component\nDim swComponent As SldWorks.Component2\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),":  In above line, we create a variable for ",(0,l.kt)("em",{parentName:"li"},"Solidworks Component"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"swComponent")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Type"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"SldWorks.Component2"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IComponent2_members.html"},"online SOLIDWORKS API Help")),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks Face\nDim swFace As SldWorks.Face2\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for ",(0,l.kt)("em",{parentName:"li"},"Solidworks Face"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"swFace")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Type"),": ",(0,l.kt)("inlineCode",{parentName:"li"},"SldWorks.Face2"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFace2_members.html"},"online SOLIDWORKS API Help")),".")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("em",{parentName:"strong"},"These all are our global variables."))),(0,l.kt)("p",null,"They are ",(0,l.kt)("strong",{parentName:"p"},"SOLIDWORKS API Objects"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Program to Insert virtual part\nSub main()\n\nEnd Sub\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above line, we create ",(0,l.kt)("em",{parentName:"li"},"main Program to Insert virtual part"),"."),(0,l.kt)("li",{parentName:"ul"},"This is a ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"Sub"))," procedure which has name of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"main")),". "),(0,l.kt)("li",{parentName:"ul"},"This procedure hold all the ",(0,l.kt)("em",{parentName:"li"},"statements (instructions)")," we give to computer."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Reference"),": Detailed information \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/vba/vba-sub-and-function-procedure/"},"VBA Sub and Function Procedures"))," article of this website.")),(0,l.kt)("h3",{id:"initialize-global-variables"},"Initialize Global Variables"),(0,l.kt)("p",null,"In this section, we initialize global variables."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks Application variable to current application\nSet swApp = Application.SldWorks\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above line, we set ",(0,l.kt)("em",{parentName:"li"},"value")," of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swApp"))," variable."),(0,l.kt)("li",{parentName:"ul"},"This ",(0,l.kt)("em",{parentName:"li"},"value")," is currently opened Solidworks application.")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks document variable to currently opened document\nSet swDoc = swApp.ActiveDoc\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above line, we set ",(0,l.kt)("em",{parentName:"li"},"value")," of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swDoc"))," variable."),(0,l.kt)("li",{parentName:"ul"},"This ",(0,l.kt)("em",{parentName:"li"},"value")," is currently ",(0,l.kt)("em",{parentName:"li"},"opened part document"),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Solidworks document is opened or not\nIf swDoc Is Nothing Then\n  MsgBox ("Solidworks document is not opened.")\n  Exit Sub\nEnd If\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully set the value of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swDoc"))," variable."),(0,l.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Condition"),": ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swDoc Is Nothing"))),(0,l.kt)("li",{parentName:"ul"},"When this condition is ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Message"),": ",(0,l.kt)("em",{parentName:"li"},"SOLIDWORKS document is not opened.")),(0,l.kt)("li",{parentName:"ul"},"Then we ",(0,l.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks Assembly document\nSet swAssembly = swDoc\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above line, we set ",(0,l.kt)("em",{parentName:"li"},"value")," of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swAssembly"))," variable."),(0,l.kt)("li",{parentName:"ul"},"This ",(0,l.kt)("em",{parentName:"li"},"value")," is ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swDoc"))," variable.")),(0,l.kt)("h3",{id:"insert-virtual-part"},"Insert Virtual Part"),(0,l.kt)("p",null,"In this section, we ",(0,l.kt)("em",{parentName:"p"},"Insert Virtual Part"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Get the selected face and set it to the Solidworks Face variable\nSet swFace = swDoc.SelectionManager.GetSelectedObject6(1, -1)\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above code block, we get set the value of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swFace"))," variable."),(0,l.kt)("li",{parentName:"ul"},"We use ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"GetSelectedObject6"))," method of ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swDoc.SelectionManager"))," object.")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Insert Virtual part\nswAssembly.InsertNewVirtualPart swFace, swComponent\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"In above code, we ",(0,l.kt)("strong",{parentName:"p"},"Insert Virtual part")," into assemly.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"For this, we use ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"InsertNewVirtualPart"))," method.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"InsertNewVirtualPart"))," method is part of ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"swAssembly"))," variable.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This method takes 2 parameter."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"FaceOrPlaneToSelect"),": ",(0,l.kt)("em",{parentName:"li"},"Plane or planar face.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"InsertedComponent"),": ",(0,l.kt)("em",{parentName:"li"},"New part inserted as virtual component.")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Return Value")," : This ",(0,l.kt)("inlineCode",{parentName:"p"},"InsertNewVirtualPart")," method return \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/swconst/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swInsertNewPartErrorCode_e.html"},"Error as defined by swInsertNewPartErrorCode_e")),".")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"In our code, I have used following values:"),(0,l.kt)("table",{parentName:"li"},(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Parameter Name"),(0,l.kt)("th",{parentName:"tr",align:null},"Value Used"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"FaceOrPlaneToSelect")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"swFace"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"InsertedComponent")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"swComponent")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Reference"),": For more details please visit \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iassemblydoc~insertnewvirtualpart.html"},"online SOLIDWORKS API Help")),"."))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' If there are error\nIf swComponent Is Nothing Then\n  ' Inform user and exit function.\n  MsgBox \"Failed to add Virtual part.\"\n  Exit Sub\nEnd If\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully added ",(0,l.kt)("strong",{parentName:"li"},"Virtual Part")," or not."),(0,l.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Condition"),": ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"swComponent Is Nothing"))),(0,l.kt)("li",{parentName:"ul"},"When this condition is ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Message"),": *Failed to add Virtual part."),(0,l.kt)("li",{parentName:"ul"},"Then we ",(0,l.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,l.kt)("p",null,"Now we run the macro and after running macro we get ",(0,l.kt)("strong",{parentName:"p"},"a New Virtual Part")," as shown in below image."),(0,l.kt)("p",null,(0,l.kt)("a",{target:"_blank",href:a(6973).Z},(0,l.kt)("img",{alt:"assembly-insert-virtual-part",src:a(31888).Z,width:"1366",height:"728"}))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"This is it !!!")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"I hope my efforts will helpful to someone!")," \ud83d\ude0a"),(0,l.kt)("p",null,"If you found anything to ",(0,l.kt)("strong",{parentName:"p"},"add or update"),", please let me know on my ",(0,l.kt)("em",{parentName:"p"},"e-mail")," \ud83d\udce7."),(0,l.kt)("p",null,"Hope this post helps you to ",(0,l.kt)("strong",{parentName:"p"},"Insert Virtual Part")," with SOLIDWORKS VBA Macros."),(0,l.kt)("p",null,"For more such tutorials on ",(0,l.kt)("strong",{parentName:"p"},"SOLIDWORKS VBA Macro"),", do come to this website after sometime."),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"If you like the post then please share it with your friends also.")," \ud83d\ude4f\ud83c\udffb"),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Do let me know by you like this post or not!")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Till then, Happy learning!!!")))}c.isMDXComponent=!0},6973:function(e,t,a){t.Z=a.p+"assets/files/final-result-gif-e879241027a1b75dabfb17dace3692fb.gif"},17026:function(e,t,a){t.Z=a.p+"assets/files/prerequisite-1dc01db07da6ad248c95bd52c1eff436.png"},31888:function(e,t,a){t.Z=a.p+"assets/images/final-result-gif-e879241027a1b75dabfb17dace3692fb.gif"},49830:function(e,t,a){t.Z=a.p+"assets/images/prerequisite-1dc01db07da6ad248c95bd52c1eff436.png"}}]);
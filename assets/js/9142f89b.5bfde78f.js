"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[3909],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return k}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=p(n),k=r,d=c["".concat(s,".").concat(k)]||c[k]||u[k]||o;return n?a.createElement(d,l(l({ref:t},m),{},{components:n})):a.createElement(d,l({ref:t},m))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=c;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},29297:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return d},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return c}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),l=n(74753),i=["components"],s={categories:"Solidworks-macro",title:"Solidworks VBA Macro - Create Reference Axis",permalink:"/solidworks-vba-macros/create-reference-axis/",tags:["Solidworks Macro"],id:"feature-reference-axis"},p=void 0,m={unversionedId:"feature-reference-axis",id:"feature-reference-axis",title:"Solidworks VBA Macro - Create Reference Axis",description:"",source:"@site/docs/solidworks-macros/021.2-feature-reference-axis.md",sourceDirName:".",slug:"/feature-reference-axis",permalink:"/solidworks-macros/feature-reference-axis",draft:!1,tags:[{label:"Solidworks Macro",permalink:"/solidworks-macros/tags/solidworks-macro"}],version:"current",frontMatter:{categories:"Solidworks-macro",title:"Solidworks VBA Macro - Create Reference Axis",permalink:"/solidworks-vba-macros/create-reference-axis/",tags:["Solidworks Macro"],id:"feature-reference-axis"},sidebar:"tutorialSidebar",previous:{title:"Solidworks VBA Macro - Create Reference Plane",permalink:"/solidworks-macros/feature-reference-plane"},next:{title:"Solidworks VBA Macro - Create Reference Co-Ordinate",permalink:"/solidworks-macros/feature-reference-coordinate"}},u={},c=[{value:"Objective",id:"objective",level:2},{value:"Results We Can Get",id:"results-we-can-get",level:2},{value:"Macro Video",id:"macro-video",level:2},{value:"VBA Macro",id:"vba-macro",level:2},{value:"Prerequisite",id:"prerequisite",level:2},{value:"Steps To Follow",id:"steps-to-follow",level:2},{value:"Create and Initialize required variables",id:"create-and-initialize-required-variables",level:3},{value:"Create Reference Axis",id:"create-reference-axis",level:3},{value:"Final work",id:"final-work",level:3},{value:"Error-Solutions",id:"error-solutions",level:2},{value:"Error Message 1",id:"error-message-1",level:3},{value:"Error Message 2",id:"error-message-2",level:3},{value:"Error 3",id:"error-3",level:3}],k={toc:c};function d(e){var t=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},k,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"objective"},"Objective"),(0,o.kt)(l.Z,{mdxType:"AdComponent"}),(0,o.kt)("p",null,"In this article we ",(0,o.kt)("strong",{parentName:"p"},"create and understand")," VBA macro of ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," in ",(0,o.kt)("em",{parentName:"p"},"SOLIDWORKS CAD Software"),"."),(0,o.kt)("p",null,"This method is ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"most updated"))," method, so ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"use this method"))," if you want to create a new ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," quickly. "),(0,o.kt)("h2",{id:"results-we-can-get"},"Results We Can Get"),(0,o.kt)("p",null,"After running our macro we successfully create ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," as a result."),(0,o.kt)("p",null,"Below image shows the result we get."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(65193).Z},(0,o.kt)("img",{alt:"scale-feature-final-result",src:n(86288).Z,width:"1366",height:"728"}))),(0,o.kt)("p",null,"We create ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," in following steps in general."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create and Initialize required variables")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create Reference Axis")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Final Work"))),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"To get the correct result please follow the steps correctly."))),(0,o.kt)("h2",{id:"macro-video"},"Macro Video"),(0,o.kt)("p",null,"Below \ud83c\udfac video shows ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," from ",(0,o.kt)("em",{parentName:"p"},"SOLIDWORKS VBA Macros"),"."),(0,o.kt)("iframe",{src:"https://www.youtube.com/embed/vty_8f-T32A",frameborder:"0",allowfullscreen:!0,width:"100%",height:"500"}),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Above video is just for visualization and there are no explanation."))," "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"I have explained each and every line in this article."))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"It is advisable to watch video, since it help you to better understand the process."))),(0,o.kt)("h2",{id:"vba-macro"},"VBA Macro"),(0,o.kt)("p",null,"Below is the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"VBA macro"))," for creating ",(0,o.kt)("em",{parentName:"p"},"Reference Axis"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'Option Explicit\n\n\' Main program for Reference Axis\nSub main()\n  \n  \' Variable for Solidworks application\n  Dim swApp As SldWorks.SldWorks\n  \n  \' Set Solidworks Application variable to current application\n  Set swApp = Application.SldWorks\n  \n  \' Check if Solidworks is opened or not\n  If swApp Is Nothing Then\n    MsgBox ("Solidworks is not opened")\n    Exit Sub\n  End If\n  \n  \' Variable for storing default part location\n  Dim defaultTemplate As String\n  \n  \' Setting value of variable to "Default part template"\n  defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\n  \n  \' Variable for Solidworks document\n  Dim swDoc As SldWorks.ModelDoc2\n  \n  \' Setting Solidworks document to new part document\n  Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n  \n  \' Check if Solidworks document is opened or not\n  If swDoc Is Nothing Then\n    MsgBox ("Solidworks document is not opened.")\n    Exit Sub\n  End If\n  \n  \' Boolean Variable\n  Dim BoolStatus As Boolean\n  \n  \' Selecting Front Plane\n  BoolStatus = swDoc.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n  \n  \' Check if Front Plane is selected or not\n  If BoolStatus = False Then\n    MsgBox ("Failed to select [Front Plane].")\n    Exit Sub\n  End If\n  \n  \' Selecting Top Plane\n  BoolStatus = swDoc.Extension.SelectByID2("Top Plane", "PLANE", 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n  \n  \' Check if Top Plane is selected or not\n  If BoolStatus = False Then\n    MsgBox ("Failed to select [Top Plane].")\n    Exit Sub\n  End If\n  \n  \' Create Reference Axis\n  BoolStatus = swDoc.InsertAxis2(True)\n  \n  \' Check if Reference Axis creates or not\n  If BoolStatus = False Then\n    MsgBox ("Failed to create Reference Axis.")\n    swDoc.ClearSelection2 True\n    Exit Sub\n  End If\n  \n  \' View zoom to fit\n  swDoc.ViewZoomtofit2\n  \n  \' Clear all selection\n  swDoc.ClearSelection2 True\n  \nEnd Sub\n')),(0,o.kt)(l.Z,{mdxType:"AdComponent"}),(0,o.kt)("h2",{id:"prerequisite"},"Prerequisite"),(0,o.kt)("p",null,"There are some ",(0,o.kt)("em",{parentName:"p"},"prerequisite")," for this article."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Knowledge of ",(0,o.kt)("strong",{parentName:"li"},"VBA programming language")," is \u2757",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"required")),".")),(0,o.kt)("p",null,"Since we are creating new part, there are no feature to create."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"We will apply checks in this article, so the code we write should be error free most of the time."))),(0,o.kt)("h2",{id:"steps-to-follow"},"Steps To Follow"),(0,o.kt)("p",null,"This ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis VBA macro")," can be divided into following sections:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create and Initialize required variables")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Create Reference Axis")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Final work"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Every section with each line is explained below."))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"I also give some ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"links (see icon \ud83d\ude80)"))," so that you can go through them if there are anything I explained in previous articles."))),(0,o.kt)("h3",{id:"create-and-initialize-required-variables"},"Create and Initialize required variables"),(0,o.kt)("p",null,"In this section we create and initialize required variables."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"Option Explicit\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Purpose"),": Above line forces us to define every variable we are going to use. "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Reference"),": \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/solidworks-macros/open-new-document"},"SOLIDWORKS Macros - Open new Part document"))," article.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Main program for Scale Feature\nSub main()\n\nEnd Sub\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we create ",(0,o.kt)("em",{parentName:"li"},"main program for Scale Feature"),"."),(0,o.kt)("li",{parentName:"ul"},"This is a ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Sub"))," procedure which has name of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"main")),". "),(0,o.kt)("li",{parentName:"ul"},"This procedure hold all the ",(0,o.kt)("em",{parentName:"li"},"statements (instructions)")," we give to computer."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Reference"),": Detailed information \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-sub-and-function-procedure/"},"VBA Sub and Function Procedures"))," article of this website.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks application\nDim swApp As SldWorks.SldWorks\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for ",(0,o.kt)("em",{parentName:"li"},"Solidworks application"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"swApp")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Type"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"SldWorks.SldWorks")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members.html"},"online SOLIDWORKS API Help")),".")),(0,o.kt)("p",null,"Inside this section we initialize required variables."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks Application variable to current application\nSet swApp = Application.SldWorks\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we set ",(0,o.kt)("em",{parentName:"li"},"value")," of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swApp"))," variable."),(0,o.kt)("li",{parentName:"ul"},"This ",(0,o.kt)("em",{parentName:"li"},"value")," is currently opened Solidworks application.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Solidworks is opened or not\nIf swApp Is Nothing Then  \n  MsgBox ("SOLIDWORKS is not opened")  \n  Exit Sub\nEnd If\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully set the value of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swApp"))," variable."),(0,o.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Condition"),": ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swApp Is Nothing"))),(0,o.kt)("li",{parentName:"ul"},"When this condition is ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Message"),": ",(0,o.kt)("em",{parentName:"li"},"SOLIDWORKS is not opened")),(0,o.kt)("li",{parentName:"ul"},"Then we ",(0,o.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for storing default part location\nDim defaultTemplate As String\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for storing default part location. "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"defaultTemplate")," "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Type"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"String"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Setting value of variable to "Default part template"\ndefaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we set ",(0,o.kt)("em",{parentName:"li"},"value")," of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"defaultTemplate"))," variable."),(0,o.kt)("li",{parentName:"ul"},"This ",(0,o.kt)("em",{parentName:"li"},"value"),' is set to "',(0,o.kt)("strong",{parentName:"li"},"Default part template"),'".')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable for Solidworks document. "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"swDoc")," "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Type"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"SldWorks.ModelDoc2")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Reference"),": Please visit \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2_members.html"},"online SOLIDWORKS API Help")),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Set Solidworks document variable to new part document\nSet swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we set ",(0,o.kt)("em",{parentName:"li"},"value")," of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swDoc"))," variable."),(0,o.kt)("li",{parentName:"ul"},"This ",(0,o.kt)("em",{parentName:"li"},"value")," is ",(0,o.kt)("em",{parentName:"li"},"new part document"),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Solidworks document is opened or not\nIf swDoc Is Nothing Then\n  MsgBox ("Solidworks document is not opened.")\n  Exit Sub\nEnd If\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully set the value of ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swDoc"))," variable."),(0,o.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Condition"),": ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"swDoc Is Nothing"))),(0,o.kt)("li",{parentName:"ul"},"When this condition is ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Message"),": ",(0,o.kt)("em",{parentName:"li"},"SOLIDWORKS document is not opened.")),(0,o.kt)("li",{parentName:"ul"},"Then we ",(0,o.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,o.kt)(l.Z,{mdxType:"AdComponent"}),(0,o.kt)("h3",{id:"create-reference-axis"},"Create Reference Axis"),(0,o.kt)("p",null,"In this section, we create Reference Axis."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Boolean Variable\nDim BoolStatus As Boolean\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Purpose"),": In above line, we create a variable Boolean values or function."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Variable Name"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"BoolStatus")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Type"),": ",(0,o.kt)("inlineCode",{parentName:"li"},"Boolean"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Selecting Front Plane\nBoolStatus = swDoc.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we select ",(0,o.kt)("strong",{parentName:"li"},"Front plane")," by ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"SelectByID2"))," method."),(0,o.kt)("li",{parentName:"ul"},"If we succeed in selecting ",(0,o.kt)("strong",{parentName:"li"},"Front plane"),", we get ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True"))," otherwise we get ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"False")),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Front Plane is selected or not\nIf BoolStatus = False Then\n  MsgBox ("Failed to select [Front Plane].")\n  Exit Sub\nEnd If\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully selected ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Front Plane"))," or not."),(0,o.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Condition"),": ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"BoolStatus = False"))),(0,o.kt)("li",{parentName:"ul"},"When this condition is ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Message"),": ",(0,o.kt)("em",{parentName:"li"},"Failed to select ","[Front Plane]",".")),(0,o.kt)("li",{parentName:"ul"},"Then we ",(0,o.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Selecting Top Plane\nBoolStatus = swDoc.Extension.SelectByID2("Top Plane", "PLANE", 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we select ",(0,o.kt)("strong",{parentName:"li"},"Top plane")," by ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"SelectByID2"))," method."),(0,o.kt)("li",{parentName:"ul"},"If we succeed in selecting ",(0,o.kt)("strong",{parentName:"li"},"Top plane"),", we get ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True"))," otherwise we get ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"False")),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Top Plane is selected or not\nIf BoolStatus = False Then\n  MsgBox ("Failed to select [Top Plane].")\n  Exit Sub\nEnd If\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully selected ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Top Plane"))," or not."),(0,o.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Condition"),": ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"BoolStatus = False"))),(0,o.kt)("li",{parentName:"ul"},"When this condition is ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Message"),": ",(0,o.kt)("em",{parentName:"li"},"Failed to select ","[Top Plane]",".")),(0,o.kt)("li",{parentName:"ul"},"Then we ",(0,o.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Create Reference Axis\nBoolStatus = swDoc.InsertAxis2(True)\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"In above line, we insert ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," by ",(0,o.kt)("inlineCode",{parentName:"p"},"InsertAxis2")," method from ",(0,o.kt)("strong",{parentName:"p"},"Solidworks Document Object"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"This ",(0,o.kt)("inlineCode",{parentName:"p"},"InsertAxis2")," method takes following parameters as explained:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"AutoSize")," - ",(0,o.kt)("em",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"em"},"True")," if axis is to be automatically sized, ",(0,o.kt)("inlineCode",{parentName:"em"},"False")," if not.")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Return Value")," : This ",(0,o.kt)("inlineCode",{parentName:"p"},"InsertAxis2")," method return ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"True"))," if the ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," is created successfully, ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"False"))," if not.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"In our code, I have used following values:"),(0,o.kt)("table",{parentName:"li"},(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Parameter Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Value Used"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"AutoSize")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"True"))))))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Reference"),": For more details about "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Solidworks Feature Manager details"),": \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager_members.html"},"online Solidworks API Help"))," for Solidworks Feature Manager."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"InsertAxis2 Method"),": \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://help.solidworks.com/2020/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeldoc2~insertaxis2.html"},"online Solidworks API Help"))," for ",(0,o.kt)("inlineCode",{parentName:"li"},"InsertAxis2")," Method.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Check if Reference Axis creates or not\nIf BoolStatus = False Then\n  MsgBox ("Failed to create Reference Axis.")\n  swDoc.ClearSelection2 True\n  Exit Sub\nEnd If\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above code block, we check if we successfully create ",(0,o.kt)("strong",{parentName:"li"},"Reference Axis")," or not."),(0,o.kt)("li",{parentName:"ul"},"We use \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-if-then-structure-select-case/"},"IF statement"))," for checking."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Condition"),": ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"BoolStatus = False"))),(0,o.kt)("li",{parentName:"ul"},"When this condition is ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"True")),", ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"We show and \ud83d\ude80 ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/vba/vba-msgBox-function/"},"message window"))," to user."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Message"),": ",(0,o.kt)("em",{parentName:"li"},"Failed to create Reference Axis.")),(0,o.kt)("li",{parentName:"ul"},"Then we ",(0,o.kt)("strong",{parentName:"li"},"clear all selection")," and ",(0,o.kt)("strong",{parentName:"li"},"stop")," our macro here.")))),(0,o.kt)("p",null,"Now we run the macro and after running macro we get ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis")," as shown in below image."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(65193).Z},(0,o.kt)("img",{alt:"scale-feature-final-result",src:n(86288).Z,width:"1366",height:"728"}))),(0,o.kt)("h3",{id:"final-work"},"Final work"),(0,o.kt)("p",null,"In this section, after creating ",(0,o.kt)("strong",{parentName:"p"},"Reference Axis"),", we have to do some cleaning work so that we can use this macro frequently."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' View zoom to fit\nswDoc.ViewZoomtofit2\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we make our view zoom to fit the model."),(0,o.kt)("li",{parentName:"ul"},"For this we use ",(0,o.kt)("inlineCode",{parentName:"li"},"ViewZoomtofit2")," method which is part of ",(0,o.kt)("em",{parentName:"li"},"SOLIDWORKS Document")," variable i.e ",(0,o.kt)("inlineCode",{parentName:"li"},"swDoc")," variable.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Clear all selection\nswDoc.ClearSelection2 True\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In above line, we clear all previous selection."),(0,o.kt)("li",{parentName:"ul"},"For this we use ",(0,o.kt)("inlineCode",{parentName:"li"},"ClearSelection2")," method which is part of ",(0,o.kt)("em",{parentName:"li"},"SOLIDWORKS Document")," variable i.e ",(0,o.kt)("inlineCode",{parentName:"li"},"swDoc")," variable.")),(0,o.kt)(l.Z,{mdxType:"AdComponent"}),(0,o.kt)("h2",{id:"error-solutions"},"Error-Solutions"),(0,o.kt)("p",null,"After posting this article, I got to know that code sample is not working for already opened document."),(0,o.kt)("p",null,"I thought writing a section for these error will be a better idea or future."),(0,o.kt)("p",null,"Below I list out the error message we got and their probable solution(s)."),(0,o.kt)("h3",{id:"error-message-1"},"Error Message 1"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Solidworks document is opened")," error message. Image of this error is shown below."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(11700).Z},(0,o.kt)("img",{alt:"error-solidworks-document-not-open",src:n(41119).Z,width:"367",height:"133"}))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Cause"),": Cause of this error is ",(0,o.kt)("strong",{parentName:"p"},"not")," setting ",(0,o.kt)("strong",{parentName:"p"},"File Location setting")," for ",(0,o.kt)("strong",{parentName:"p"},"Document Templates"),"."),(0,o.kt)("p",null,"Please see below image for detail."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(38465).Z},(0,o.kt)("img",{alt:"document-template-setting",src:n(97889).Z,width:"969",height:"602"}))),(0,o.kt)("p",null,"After setting ",(0,o.kt)("strong",{parentName:"p"},"Document Templates")," path, this message will not come."),(0,o.kt)("h3",{id:"error-message-2"},"Error Message 2"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Failed to create Reference Axis")," error message. Image of this error is shown below."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(3790).Z},(0,o.kt)("img",{alt:"failed-to-create-plane",src:n(84370).Z,width:"203",height:"133"}))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Cause"),": There might be following case for this error."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Name of selected plane is different.")),(0,o.kt)("p",null,"You need to confirm plane name first, as I shown in below image."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(83523).Z},(0,o.kt)("img",{alt:"plane-names",src:n(54862).Z,width:"338",height:"356"}))),(0,o.kt)("p",null,'As shown in above image, plane name is "',(0,o.kt)("strong",{parentName:"p"},"Front"),'".'),(0,o.kt)("p",null,"Hence for selecting this plane, I use below code."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Selecting Front Plane\nBoolStatus = swDoc.Extension.SelectByID2("Front", "PLANE", 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n')),(0,o.kt)("p",null,"If your default part have plane name as shown in below image."),(0,o.kt)("p",null,(0,o.kt)("a",{target:"_blank",href:n(18417).Z},(0,o.kt)("img",{alt:"plane-names-with-suffix-plane",src:n(91140).Z,width:"295",height:"363"}))),(0,o.kt)("p",null,"Then you need to use below code for selecting ",(0,o.kt)("strong",{parentName:"p"},"Front Plane"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},'\' Selecting Front Plane\nBoolStatus = swDoc.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\n')),(0,o.kt)("h3",{id:"error-3"},"Error 3"),(0,o.kt)("p",null,"If you are using code sample provided in this article into an already open document."),(0,o.kt)("p",null,"And hoping that you will get the result of new Reference Plane in opened document."),(0,o.kt)("p",null,"Then I suggest you to know few things:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"This code sample, ",(0,o.kt)("strong",{parentName:"em"},"create new part and in that new part it create Reference Axis"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"If you are in this error section, ",(0,o.kt)("strong",{parentName:"em"},"I seriously want you to read all articles I had written"),". Then you will understand the code and change it to fit your need."))),(0,o.kt)("p",null,"If you still want to create ",(0,o.kt)("strong",{parentName:"p"},"new Reference Axis")," in already opened document, do following."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for storing default part location\nDim defaultTemplate As String\n\n' Setting value of variable to \"Default part template\"\ndefaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\n\n' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n\n' Setting Solidworks document to new part document\nSet swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\n")),(0,o.kt)("p",null,"Replace above code, with below code in your macro."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"showlinenumbers showLineNumbers",showlinenumbers:!0,showLineNumbers:!0},"' Variable for Solidworks document\nDim swDoc As SldWorks.ModelDoc2\n\n' Set Solidworks document variable to currently opened document\nSet swDoc = swApp.ActiveDoc\n")),(0,o.kt)("p",null,"I hope this will work."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"This is it !!!")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"I hope my efforts will helpful to someone!")),(0,o.kt)("p",null,"If you found anything to ",(0,o.kt)("strong",{parentName:"p"},"add or update"),", please let me know on my ",(0,o.kt)("em",{parentName:"p"},"e-mail"),"."),(0,o.kt)("p",null,"Hope this post helps you to ",(0,o.kt)("strong",{parentName:"p"},"create Reference Axis")," with SOLIDWORKS VBA Macros."),(0,o.kt)("p",null,"For more such tutorials on ",(0,o.kt)("strong",{parentName:"p"},"SOLIDWORKS VBA Macro"),", do come to this website after sometime."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"If you like the post then please share it with your friends also.")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Do let me know by you like this post or not!")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Till then, Happy learning!!!")))}d.isMDXComponent=!0},74753:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(94578),r=n(67294),o=function(e){function t(){return e.apply(this,arguments)||this}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e;(e=document.createElement("script")).src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",e.async=!0,e.defer=!0,document.body.insertBefore(e,document.body.firstChild),(window.adsbygoogle=window.adsbygoogle||[]).push({})},n.render=function(){return r.createElement("ins",{className:"adsbygoogle",style:{display:"block"},"data-ad-client":"ca-pub-8158659264340002","data-ad-slot":"6644001766","data-ad-format":"auto","data-full-width-responsive":"true"})},t}(r.Component)},38465:function(e,t,n){t.Z=n.p+"assets/files/document-template-setting-2033088753ee92cd12e526e049df34e6.png"},11700:function(e,t,n){t.Z=n.p+"assets/files/error-solidworks-document-not-open-001edb4bec3a811d0926b02235bb039a.png"},18417:function(e,t,n){t.Z=n.p+"assets/files/plane-names-with-suffix-plane-06a8fe56362ffce49460b2f801903cad.png"},83523:function(e,t,n){t.Z=n.p+"assets/files/plane-names-d64b6ca42afd054e90717c91ee8e8e2e.png"},3790:function(e,t,n){t.Z=n.p+"assets/files/failed-to-create-axis-14e8ec38c622888f0716a29cc6bed7eb.png"},65193:function(e,t,n){t.Z=n.p+"assets/files/final-result-gif-4eb7713710e33612b604b6b11493db99.gif"},97889:function(e,t,n){t.Z=n.p+"assets/images/document-template-setting-2033088753ee92cd12e526e049df34e6.png"},41119:function(e,t){t.Z="data:image/png;base64,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"},91140:function(e,t,n){t.Z=n.p+"assets/images/plane-names-with-suffix-plane-06a8fe56362ffce49460b2f801903cad.png"},54862:function(e,t,n){t.Z=n.p+"assets/images/plane-names-d64b6ca42afd054e90717c91ee8e8e2e.png"},84370:function(e,t){t.Z="data:image/png;base64,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"},86288:function(e,t,n){t.Z=n.p+"assets/images/final-result-gif-4eb7713710e33612b604b6b11493db99.gif"}}]);
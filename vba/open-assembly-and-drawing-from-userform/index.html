<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-vba docs-doc-id-open-assembly-and-drawing-from-userform">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">VBA Userforms - Open new Assembly and Drawing document | The CAD Coder</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://thecadcoder.com//vba/open-assembly-and-drawing-from-userform"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-vba-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-vba-current"><meta data-rh="true" property="og:title" content="VBA Userforms - Open new Assembly and Drawing document | The CAD Coder"><meta data-rh="true" name="description" content="In this post, we learn how can we Open new Assembly and Drawing document from a Visual Basic for Application&#x27;s Userform."><meta data-rh="true" property="og:description" content="In this post, we learn how can we Open new Assembly and Drawing document from a Visual Basic for Application&#x27;s Userform."><link data-rh="true" rel="icon" href="/assets/logo.png"><link data-rh="true" rel="canonical" href="https://thecadcoder.com//vba/open-assembly-and-drawing-from-userform"><link data-rh="true" rel="alternate" href="https://thecadcoder.com//vba/open-assembly-and-drawing-from-userform" hreflang="en"><link data-rh="true" rel="alternate" href="https://thecadcoder.com//vba/open-assembly-and-drawing-from-userform" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.34ce6af1.css">
<link rel="preload" href="/assets/js/runtime~main.77398ef9.js" as="script">
<link rel="preload" href="/assets/js/main.e880ee40.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/assets/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/assets/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">The CAD Coder</b></a><a class="navbar__item navbar__link" href="/vba/vba-introduction">VBA</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Solidworks API Tutorials</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/solidworks-macros/vba-in-solidworks">Solidworks API + VBA</a></li><li><a class="dropdown__link" href="/solidworks-csharp/solidworks-CSharp-Api">Solidworks API + C#</a></li><li><a class="dropdown__link" href="/solidworks-cpp/solidworks-Cpp-Api">Solidworks API + C++</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/resources">Resources</a><a class="navbar__item navbar__link" href="/aboutme">About Me</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_W2AM"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage_qMb8"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/vba/vba-introduction">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/vba/vba-programming-concepts">Programming Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/vba/vba-dialog-boxes">Dialog Boxes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/vba/vba-userform">UserForms</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vba/vba-userform">UserForms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vba/open-part-from-userform">Open new Part document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vba/open-assembly-and-drawing-from-userform">Open new Assembly and Drawing document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vba/testing-open-assembly-and-drawing-document-macro">Testing Open new Assembly and Drawing document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vba/browse-solidworks-file">Browse SOLIDWORKS file(s)</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_RiV8"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">UserForms</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Open new Assembly and Drawing document</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>VBA Userforms - Open new Assembly and Drawing document</h1></header><p>In this post, we learn how can we <strong>Open new Assembly and Drawing document</strong> from a Visual Basic for Application&#x27;s <strong>Userform</strong>.</p><p>For this please we need to do following steps as described below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="video-of-code-on-youtube">Video of Code on YouTube<a class="hash-link" href="#video-of-code-on-youtube" title="Direct link to heading">​</a></h2><p>Please see below video how visually we <em>Open new Assembly and Drawing document</em> in <strong>Solidworks VBA macro Userform</strong>.</p><iframe src="https://www.youtube.com/embed/AQ3Fyw78ExI" frameborder="0" width="100%" height="500"></iframe><p>Please note that there are <strong>no explanation</strong> in the video. </p><p><strong>Explanation</strong> of each line and why we write code this way is given in this post.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-macro">Create a new macro<a class="hash-link" href="#create-a-new-macro" title="Direct link to heading">​</a></h2><p>1st we need to create a <strong>new macro</strong> in <em>Solidworks 3D CAD Software</em>.</p><p>If you don&#x27;t know how to create a new macro in Solidworks, please go to <a href="/solidworks-macros/vba-in-solidworks/">VBA in Solidworks</a> post for this.</p><p>This will open a new macro in Visual Basic Editor with some code as shown in below image.</p><p><img loading="lazy" alt="open-new-macro" src="/assets/images/open-new-macro-b822f2e9b8c402eebf9f3386f8de3d09.png" width="1366" height="738" class="img_ev3q"> </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="insert-userform-in-the-macro">Insert userform in the macro<a class="hash-link" href="#insert-userform-in-the-macro" title="Direct link to heading">​</a></h2><p>After this we need to insert <em>a userform</em> in our macro.</p><p>For this, select the button shown in below image.</p><p><img loading="lazy" alt="insert-userform-into-macro" src="/assets/images/insert-userform-into-macro-4b981270c4f9349b4be7efaa800e712f.png" width="1366" height="738" class="img_ev3q"></p><p>This button is called <strong><em>insert userform</em></strong>. </p><p>As the name suggest, function of this button is <em>inserting a userform</em>.</p><blockquote><p>Please note that in a macro we can insert any number of userform as we like. But for this example we insert only 1 userform.</p></blockquote><p>After clicking the <strong><em>insert userform</em></strong> button we get the userform window.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-controls-into-userform">Adding Controls into Userform<a class="hash-link" href="#adding-controls-into-userform" title="Direct link to heading">​</a></h2><p>Now in our userform window, we add following controls:</p><ol><li><p><strong>A ComboBox</strong></p></li><li><p><strong>A CommandButton</strong></p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-combobox">Adding ComboBox<a class="hash-link" href="#adding-combobox" title="Direct link to heading">​</a></h3><p>You can find <code>ComboBox</code> option, as highlighted in <em>Red Square</em> in below image.</p><p><img loading="lazy" alt="insert-combox-into-userform" src="/assets/images/insert-combox-into-userform-cbfcbcc646555660439e14dc8c3b353a.png" width="1368" height="740" class="img_ev3q"></p><p>After adding ComboBox, we get window as shown in below image.</p><p><img loading="lazy" alt="combobox-into-userform" src="/assets/images/combobox-into-userform-63ac1d4d4e8021a6b43868f651e6c7cb.png" width="1368" height="738" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-commandbutton">Adding CommandButton<a class="hash-link" href="#adding-commandbutton" title="Direct link to heading">​</a></h3><p>You can find <code>CommandButton</code> option, as highlighted in <em>Red Square</em> in below image.</p><p><img loading="lazy" alt="insert-command-button-into-userform" src="/assets/images/insert-command-button-into-userform-1eec72bde036662833f493102f51a14b.png" width="1370" height="738" class="img_ev3q"></p><p>After adding CommandButton, we get window as shown in below image.</p><p><img loading="lazy" alt="command-button-into-userform" src="/assets/images/command-button-into-userform-b11cf60652222f0a250f9e952be4c2b0.png" width="1370" height="768" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updating-properties">Updating Properties<a class="hash-link" href="#updating-properties" title="Direct link to heading">​</a></h2><p>Now we update some properties of following:</p><ol><li><p><strong>UserForm</strong></p></li><li><p><strong>ComboBox</strong></p></li><li><p><strong>CommandButton</strong></p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-properties-of-the-userform">Updating Properties of the UserForm<a class="hash-link" href="#updating-properties-of-the-userform" title="Direct link to heading">​</a></h3><p>We update following properties of the Userform:</p><ol><li><p>Name of Userform</p></li><li><p>Caption of Userform</p></li></ol><p>In below image, I have shown the properties of <code>Userform1</code> and update the properties:</p><p><img loading="lazy" alt="update-userform-properties" src="/assets/images/update-userform-properties-59368ef851ec6debed291ae1f9f392d6.png" width="1372" height="738" class="img_ev3q"></p><p>Update the value of <em>Name</em> property from <code>UserForm1</code> to <code>OpenDocumentWindow</code>.</p><ul><li>From <em>Name</em> property, we access the Userform.</li></ul><p>Update the value of <em>Caption</em> property from <code>UserForm1</code> to <code>Open Document</code>.</p><ul><li>From <em>Caption</em> property, we update the text appears in the window of our Userform.</li></ul><blockquote><p>Please note that it is <strong>not necessary</strong> to update properties but it is a good habit to update them for our purpose. </p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-properties-of-the-combobox">Updating Properties of the ComboBox<a class="hash-link" href="#updating-properties-of-the-combobox" title="Direct link to heading">​</a></h3><p>Now, we update following property of the ComboBox:</p><ol><li>Name of ComboBox</li></ol><p>In below image, I have shown the properties of <code>ComboBox1</code> and update the properties:</p><p><img loading="lazy" alt="update-combobox-properties" src="/assets/images/update-combobox-properties-ef7ff04fbc4228169fe06ad4932f5755.png" width="1374" height="740" class="img_ev3q"></p><p>Update the value of <em>Name</em> property from <code>ComboBox1</code> to <code>DocumentTypeComboBox</code>.</p><ul><li>From <em>Name</em> property, we access the ComboBox.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-properties-of-the-command-button">Updating Properties of the Command Button<a class="hash-link" href="#updating-properties-of-the-command-button" title="Direct link to heading">​</a></h3><p>Now, we update following property of the Command Button:</p><ol><li><p>Name of Command Button</p></li><li><p>Caption of Command Button</p></li></ol><p>In below image, I have shown the properties of <code>CommandButton1</code> and update the properties:</p><p><img loading="lazy" alt="update-command-button-properties" src="/assets/images/update-command-button-properties-3632a93bb86f0e261f12da770d6737a1.png" width="1378" height="736" class="img_ev3q"></p><p>Update the value of <em>Name</em> property from <code>CommandButton1</code> to <code>OpenDocumentButton</code>.</p><blockquote><p>From <em>Name</em> property, we access the Command Button.</p></blockquote><p>Update the value of <em>Caption</em> property from <code>CommandButton1</code> to <code>Open Selected Document</code>.</p><blockquote><p>From <em>Caption</em> property, we update the text appears in the Command Button of our Userform.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="calling-userform-in-main-module">Calling UserForm in Main Module<a class="hash-link" href="#calling-userform-in-main-module" title="Direct link to heading">​</a></h2><p>Now, we need to call the our <em>Userform</em> inside main <strong><em>module</em></strong>.</p><p>For this goto main <code>Sub procedure</code> inside the <strong>main Module</strong>.</p><p>Code inside the main Module is as given below.</p><p>{% highlight vb showLineNumbers %}
Dim swApp As Object
Sub main()</p><p>Set swApp = Application.SldWorks
End Sub
{% endhighlight %}</p><p>To call our <code>Userform</code>, replace above code with below code:</p><p>{% highlight vb showLineNumbers %}
&#x27; Main function of our VBA program
Sub main()
&#x27; Calling our window to show
OpenDocumentWindow.Show
End Sub
{% endhighlight %}</p><p>Above function call our window to appears on screen.</p><p>When the window appears on screen, we <em>1st</em> select the document we want to <em>open</em> and <em>then</em> hit the button to open selected document.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-document-list">Adding Document list<a class="hash-link" href="#adding-document-list" title="Direct link to heading">​</a></h2><p>Before anything we need to <em>add</em> a <em>list</em> of documents inside our combobox.</p><p>From this list, we select the document which we want to open.</p><p>In this post, we are listing only &quot;<strong>Assembly</strong>&quot; and &quot;<strong>Drawing</strong>&quot; documents.</p><p>For &quot;<strong>Part</strong>&quot; document, I will give you a simple exercise.</p><p>To add documents list inside our combobox, we 1st need to go in <strong>Code Window</strong> of userform.</p><p>For this, we need to <strong>right click</strong> on userform and select &quot;<strong>View Code</strong>&quot; option.</p><p>Please see below image for &quot;<em>how to open code window of userform</em>&quot;.</p><p><img loading="lazy" alt="select-view-code-option" src="/assets/images/select-view-code-option-8c6dcbfce1db91dd5a445b011d8be298.png" width="1380" height="738" class="img_ev3q"></p><p>After selecting &quot;<strong>View Code</strong>&quot; a <em>Code window</em> appears, which is shown in below image.</p><p><img loading="lazy" alt="behind-userform-code-window" src="/assets/images/behind-userform-code-window-53f7c7ccf79efeedfacece8d9f01c554.png" width="1378" height="738" class="img_ev3q"></p><p>Now <em>before</em> adding document list we need to understand <strong>one important thing</strong>!!!</p><p>We want to add document list, when we <strong>load</strong> our <code>Userform</code>.</p><p>For this we need to create an <code>Initialize Function</code>.</p><p>Below <code>Code</code> is that <code>Initialize Function</code> which load document lists in our combobox.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Call when user load</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span><span class="token plain"> UserForm_Initialize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Adding items in Combo Box and also set index to &#x27;0&#x27;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; &#x27;0&#x27; index means by default we can see &quot;Assembly Document&quot; as already filled</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">With</span><span class="token plain"> DocumentTypeComboBox</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AddItem </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Assembly Document&quot;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Adding Assembly Document in Combo Box</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AddItem </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Drawing Document&quot;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Adding Drawing Document in Combo Box</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ListIndex </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Select list index for default value to show in combobox</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">End</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">With</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">End</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, above code is <strong><em>fully commented</em></strong> and <strong><em>self explanatory</em></strong> hence I will not explain it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="first-test-of-macro">First Test of Macro<a class="hash-link" href="#first-test-of-macro" title="Direct link to heading">​</a></h2><p>After writing code sample in previous section, we will test if every thing is working correct?</p><p>By working correct means:</p><ol><li><p>When we <code>Run</code> macro, is <strong>Open Document</strong> window appears or not?</p></li><li><p>If window appears, then combobox has documents listed in it?</p></li><li><p>If both item listed, then &quot;<strong>Assembly document</strong>&quot; is showing as pre-filled value or not?</p></li><li><p>Since we have not given any functionality to &quot;<strong>Open Document</strong>&quot; button, hence it should not any done anything when clicking!!!</p></li></ol><p>For testing all the above points we need to <code>Run</code> the macro as shown in below image.</p><p><img loading="lazy" alt="first-test-of-macro" src="/assets/images/first-test-of-macro-1993ba56e3541062dc3e75f4315bc669.png" width="1382" height="736" class="img_ev3q"></p><p>After running the window we got a window as shown in below image.</p><p><img loading="lazy" alt="sample-userform-window" src="data:image/png;base64,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" width="311" height="236" class="img_ev3q"></p><p>Please <strong><em>do check</em></strong> if your macro is running perfectly till now or not!</p><p>If not, then I suggest you to read this article again.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-functionality-to-open-newpart-button">Add Functionality to Open NewPart Button<a class="hash-link" href="#add-functionality-to-open-newpart-button" title="Direct link to heading">​</a></h2><p>To add functionality in our <code>Open Selected Button</code>, just double click the <code>Open NewPart Button</code>.</p><p>This will add give some code behind the designer and opens the <strong>code window</strong> of Userform designer.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(0, 0, 255)">Private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span><span class="token plain"> OpenDocumentButton_Click</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">End</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We need to update this code for opening new part after clicking the button.</p><p>For this replace all above code with below code.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(0, 0, 255)">Option</span><span class="token plain"> Explicit</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Creating variable for Solidworks application</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Dim</span><span class="token plain"> swApp </span><span class="token keyword" style="color:rgb(0, 0, 255)">As</span><span class="token plain"> SldWorks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">SldWorks</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Creating variable for Solidworks document</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Dim</span><span class="token plain"> swDoc </span><span class="token keyword" style="color:rgb(0, 0, 255)">As</span><span class="token plain"> SldWorks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ModelDoc2</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Private function of Open New Part Button </span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span><span class="token plain"> OpenDocumentButton_Click</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Setting Solidworks variable to Solidworks application</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">Set</span><span class="token plain"> swApp </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Application</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">SldWorks</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Creating string type variable for storing default Assembly location</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">Dim</span><span class="token plain"> defaultTemplate </span><span class="token keyword" style="color:rgb(0, 0, 255)">As</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">String</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">If</span><span class="token plain"> DocumentTypeComboBox</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Assembly Document&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Then</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Setting value of this string type variable to &quot;Default Assembly template&quot;</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    defaultTemplate </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> swApp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">GetUserPreferenceStringValue</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">swUserPreferenceStringValue_e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">swDefaultTemplateAssembly</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">Else</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Setting value of this string type variable to &quot;Default drawing template&quot; without define paper size</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    defaultTemplate </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> swApp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">GetUserPreferenceStringValue</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">swUserPreferenceStringValue_e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">swDefaultTemplateDrawing</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">End</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">If</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Setting Solidworks document to new Assembly document</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">Set</span><span class="token plain"> swDoc </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> swApp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">NewDocument</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">defaultTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Hiding the Window after opening the selected document</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  OpenDocumentWindow</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Hide</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Reset the Index of Combo Box to &quot;0&quot; again</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  DocumentTypeComboBox</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ListIndex </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">End</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Sub</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now I have added codes in <strong>2 parts</strong>.</p><p>In <strong>1st part</strong> I added below code lines <em>at top</em> of the code window.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:rgb(0, 0, 255)">Option</span><span class="token plain"> Explicit</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Creating variable for Solidworks application</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Dim</span><span class="token plain"> swApp </span><span class="token keyword" style="color:rgb(0, 0, 255)">As</span><span class="token plain"> SldWorks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">SldWorks</span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">&#x27; Creating variable for Solidworks document</span><span class="token plain"></span></span></span><span class="token-line codeLine_lJS_" style="color:#000000"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">Dim</span><span class="token plain"> swDoc </span><span class="token keyword" style="color:rgb(0, 0, 255)">As</span><span class="token plain"> SldWorks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ModelDoc2</span></span></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please see below image for more reference.</p><p><img loading="lazy" alt="add-code-at-top-of-userform-codewindow" src="/assets/images/add-code-at-top-of-userform-codewindow-bf23525039b13b3541a17582d33b3249.png" width="1384" height="738" class="img_ev3q"></p><p>In <strong>2nd part</strong> I added <code>OpenDocumentButton_Click</code> function in the code window as shown in below image.</p><p><img loading="lazy" alt="code-when-button-clicked" src="/assets/images/code-when-button-clicked-9603ffb1fba2b3c7e42e697dec7db67b.png" width="1370" height="740" class="img_ev3q"></p><p>I have already explained code inside <code>OpenDocumentButton_Click</code> function in <a href="/solidworks-macros/open-assembly-and-drawing">Open Assembly and Drawing document</a>.</p><p>But here, I have added a condition which is shown in Red colored box in below image.</p><p><img loading="lazy" alt="condition-that-control-opening-document" src="/assets/images/condition-that-control-opening-document-2ac32ef463a4d7ddfc1c0ef4236e74e2.png" width="1366" height="738" class="img_ev3q"></p><p>Basically, this condition stated that, if we select &quot;<em>Assembly Document</em>&quot; in combobox, then by clicking &quot;<em>Open Select Document</em>&quot; button our macro open &quot;<strong>Assembly</strong>&quot; document in <em>Solidworks</em>.</p><p>Otherwise, it will always open &quot;<strong>Drawing</strong>&quot; document in <em>Solidworks</em>.</p><p>The above code will <em>open New part document</em> when we click the button.</p><p><code>Run</code> the macro, and check wheather our macro is working correct document or not!!</p><p>If not, send your macro and I will guide you in doing it correctly! </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-to-do">Exercise to do<a class="hash-link" href="#exercise-to-do" title="Direct link to heading">​</a></h2><p>For those who wants to do more I have an exercise!!</p><ol><li><p>Add &quot;<strong>Part Document</strong>&quot; in ComboBox list.</p></li><li><p>Make &quot;<strong>Part Document</strong>&quot; as <em>pre-filled</em> value in ComboBox.</p></li><li><p>Change the <strong>conditional statement</strong>, so that it can handle <strong>all 3 conditions</strong>!!</p></li></ol><p>Send me the Code of macro in my below <strong>e-mail</strong> and I will <strong><em>verify</em></strong> it. </p><p>That&#x27;s it for now.</p><p>Hope you learn some use of Userforms and by this post you can get the idea how they works.</p><p>I will provide more tutorials on using of Userform time to time.</p><p><strong><em>Till then do come to visit this blog and Happy learning!!!</em></strong></p></div><br><script>window.location.reload(!0)</script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8158659264340002" data-ad-slot="6644001766" data-ad-format="auto" data-full-width-responsive="true"></ins><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/vba/tags/vba">VBA</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/vba/open-part-from-userform"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">VBA Userforms - Open new Part document</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/vba/testing-open-assembly-and-drawing-document-macro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">VBA Userforms - Testing Open new Assembly and Drawing document</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop"><div><ul class="table-of-contents table-of-contents__left-border"><li><a href="#video-of-code-on-youtube" class="table-of-contents__link toc-highlight">Video of Code on YouTube</a></li><li><a href="#create-a-new-macro" class="table-of-contents__link toc-highlight">Create a new macro</a></li><li><a href="#insert-userform-in-the-macro" class="table-of-contents__link toc-highlight">Insert userform in the macro</a></li><li><a href="#adding-controls-into-userform" class="table-of-contents__link toc-highlight">Adding Controls into Userform</a><ul><li><a href="#adding-combobox" class="table-of-contents__link toc-highlight">Adding ComboBox</a></li><li><a href="#adding-commandbutton" class="table-of-contents__link toc-highlight">Adding CommandButton</a></li></ul></li><li><a href="#updating-properties" class="table-of-contents__link toc-highlight">Updating Properties</a><ul><li><a href="#updating-properties-of-the-userform" class="table-of-contents__link toc-highlight">Updating Properties of the UserForm</a></li><li><a href="#updating-properties-of-the-combobox" class="table-of-contents__link toc-highlight">Updating Properties of the ComboBox</a></li><li><a href="#updating-properties-of-the-command-button" class="table-of-contents__link toc-highlight">Updating Properties of the Command Button</a></li></ul></li><li><a href="#calling-userform-in-main-module" class="table-of-contents__link toc-highlight">Calling UserForm in Main Module</a></li><li><a href="#adding-document-list" class="table-of-contents__link toc-highlight">Adding Document list</a></li><li><a href="#first-test-of-macro" class="table-of-contents__link toc-highlight">First Test of Macro</a></li><li><a href="#add-functionality-to-open-newpart-button" class="table-of-contents__link toc-highlight">Add Functionality to Open NewPart Button</a></li><li><a href="#exercise-to-do" class="table-of-contents__link toc-highlight">Exercise to do</a></li></ul><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8158659264340002" data-ad-slot="4311368222" data-ad-format="auto" data-full-width-responsive="true"></ins></div></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/vba/vba-introduction">VBA Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/solidworks-macros/vba-in-solidworks">Solidworks VBA Tutorials</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/aboutme">About</a></li><li class="footer__item"><a class="footer__link-item" href="/resources">Resources</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 The CAD Coder.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.77398ef9.js"></script>
<script src="/assets/js/main.e880ee40.js"></script>
</body>
</html>